/*
 *  ======== ti_net_config.c ========
 *  Configured module definitions for NS
 *
 *  DO NOT EDIT - This file is generated by the SysConfig tool.
 */


/*
 *  ======== ti.net/SlNet ========
 */
#include <stdint.h>
#include <stdlib.h>
#include "string.h"
#include <pthread.h>

#include <ti/net/slnetconn.h>
#include <ti/net/slnetif.h>
#include <ti/net/slnetutils.h>
#include <ti/net/slnetsock.h>
#include <ti/net/slnet.h>
#include <ti/drivers/net/wifi/slnetifwifi.h>

static int32_t createSlNetEventThread(void);

/* This generated function must be called after the network stack(s) are
 * initialized.
 */
int32_t ti_net_SlNet_initConfig() {
    int32_t     status = 0;
    static bool slNetInitialized = false;

    if (slNetInitialized == false) {
        slNetInitialized = true;

        status = SlNetIf_init(0);

        if (status == 0) {
            status = SlNetSock_init(0);
        }

        if (status == 0) {
            SlNetUtil_init(0);
        }

        if (status == 0) {
            status = SlNetConn_init(0);
        }

        if (status == 0) {
            status = createSlNetEventThread();
        }

        /* add CONFIG_SLNET_0 interface */
        if (status == 0) {
            status = SlNetIf_add(SLNETIF_ID_1, "wlan0",
                    (const SlNetIf_Config_t *)&SlNetIfConfigWifi,
                    5);
        }

    }
    return (status);
}

void *SlNetConn_processor(void *arg0) {


    SlNetConn_process(NULL);


    return (NULL);
}

static int32_t createSlNetEventThread(void) {
    int32_t             status;
    pthread_t           thread;
    pthread_attr_t      attrs;
    struct sched_param  priParam;

    pthread_attr_init(&attrs);
    priParam.sched_priority = 1;

    status = pthread_attr_setschedparam(&attrs, &priParam);
    if (status == 0) {
        status = pthread_attr_setstacksize(&attrs, 2048);
    }

    if (status == 0) {
        status = pthread_create(&thread, &attrs, SlNetConn_processor, 0);
    }

    return (status);
}

