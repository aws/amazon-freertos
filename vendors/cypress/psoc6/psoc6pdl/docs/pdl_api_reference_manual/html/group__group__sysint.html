<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSoC 6 Peripheral Driver Library: SysInt       (System Interrupt)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="cypress_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PSoC 6 Peripheral Driver Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__group__sysint.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">API Reference</a>  </div>
  <div class="headertitle">
<div class="title">SysInt (System Interrupt)</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">General Description</h2>
<p>The SysInt driver provides an API to configure the device peripheral interrupts. </p>
<p>It provides a lightweight interface to complement the <a href="https://www.keil.com/pack/doc/CMSIS/Core/html/group__NVIC__gr.html">CMSIS core NVIC API</a>. The provided functions are applicable for all cores in a device and they can be used to configure and connect device peripheral interrupts to one or more cores.</p>
<p>The functions and other declarations used in this driver are in cy_sysint.h. You can include cy_pdl.h (ModusToolbox only) to get access to all functions and declarations in the PDL.</p>
<h1><a class="anchor" id="group_sysint_vector_table"></a>
Vector Table</h1>
<p>The vector table defines the entry addresses of the processor exceptions and the device specific interrupts. It is located at the start address of the flash and is copied by the startup code to RAM. The symbol code __Vectors is the address of the vector table in the startup code and the register SCB-&gt;VTOR holds the start address of the vector table. See <a class="el" href="group__group__system__config.html#group_system_config_device_vector_table">Vectors Table Copy from Flash to RAM</a> section for the implementation details.</p>
<p>The default interrupt handler functions are defined as weak functions to a dummy handler in the startup file. The naming convention is &lt;interrupt_name&gt;_IRQHandler. Defining these in the user application allows the linker to place them in the vector table in flash. For example: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> ioss_interrupts_gpio_0_IRQHandler(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    ...</div><div class="line">}</div></div><!-- fragment --><p> And can be used like this: </p><div class="fragment"><div class="line"></div><div class="line">    <span class="comment">/* Scenario: Vector table is not relocated anywhere from _Vectors[] in flash */</span></div><div class="line"></div><div class="line"><span class="preprocessor">#if (CY_CPU_CORTEX_M0P)</span></div><div class="line">    <span class="comment">/* Prototype of ISR function for NvicMux7, defined as a weak function in startup_psoc0x_cm0plus.s */</span></div><div class="line">    <span class="keywordtype">void</span> NvicMux7_IRQHandler(<span class="keywordtype">void</span>);</div><div class="line"></div><div class="line">    <a class="code" href="structcy__stc__sysint__t.html">cy_stc_sysint_t</a> intrCfg =</div><div class="line">    {</div><div class="line">        <span class="comment">/*.intrSrc =*/</span> NvicMux7_IRQn,               <span class="comment">/* CM0+ interrupt is NVIC #7 */</span></div><div class="line">        <span class="comment">/*.cm0pSrc =*/</span> ioss_interrupts_gpio_0_IRQn, <span class="comment">/* Source of NVIC #7 is GPIO port 0 interrupt */</span></div><div class="line">        <span class="comment">/*.intrPriority =*/</span> 2UL                     <span class="comment">/* Interrupt priority is 2 */</span></div><div class="line">    };</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">    <span class="comment">/* Prototype of ISR function for gpio interrupt 0, defined as a weak function in startup_psoc0x_cm4.s */</span></div><div class="line">    <span class="keywordtype">void</span> ioss_interrupts_gpio_0_IRQHandler(<span class="keywordtype">void</span>);</div><div class="line"></div><div class="line">    <a class="code" href="structcy__stc__sysint__t.html">cy_stc_sysint_t</a> intrCfg =</div><div class="line">    {</div><div class="line">        <span class="comment">/*.intrSrc =*/</span> ioss_interrupts_gpio_0_IRQn, <span class="comment">/* Interrupt source is GPIO port 0 interrupt */</span></div><div class="line">        <span class="comment">/*.intrPriority =*/</span> 4UL                     <span class="comment">/* Interrupt priority is 4 */</span></div><div class="line">    };</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the interrupt with vector at Interrupt_Handler_Port0() */</span></div><div class="line">    <a class="code" href="group__group__sysint__functions.html#gab2ff6820a898e9af3f780000054eea5d">Cy_SysInt_Init</a>(&amp;intrCfg, (<a class="code" href="group__group__syslib__macros.html#ga71c09beda7671d1f69c8f06a546e2ae6">cy_israddress</a>)NULL);</div><div class="line"></div><div class="line">    <span class="comment">/* Enable the interrupt */</span></div><div class="line">    NVIC_EnableIRQ(intrCfg.<a class="code" href="structcy__stc__sysint__t.html#a6da08d81da65a7f93d3e4c46a4b8d950">intrSrc</a>);</div><div class="line"></div></div><!-- fragment --><p>Using this method avoids the need for a RAM vector table. However in this scenario, interrupt handler re-location at run-time is not possible, unless the vector table is relocated to RAM.</p>
<h1><a class="anchor" id="group_sysint_driver_usage"></a>
Driver Usage</h1>
<h2><a class="anchor" id="group_sysint_initialization"></a>
Initialization</h2>
<p>Interrupt numbers are defined in a device-specific header file, such as cy8c68237bz_ble.h, and are consistent with interrupt handlers defined in the vector table.</p>
<p>To configure an interrupt, call <a class="el" href="group__group__sysint__functions.html#gab2ff6820a898e9af3f780000054eea5d" title="Initializes the referenced interrupt by setting the priority and the interrupt vector. ">Cy_SysInt_Init()</a>. Populate the configuration structure (<a class="el" href="structcy__stc__sysint__t.html" title="Initialization configuration structure for a single interrupt channel. ">cy_stc_sysint_t</a>) and pass it as a parameter along with the ISR address. This initializes the interrupt and instructs the CPU to jump to the specified ISR vector upon a valid trigger. For CM0+ core, the configuration structure (<a class="el" href="structcy__stc__sysint__t.html" title="Initialization configuration structure for a single interrupt channel. ">cy_stc_sysint_t</a>) must specify the device interrupt source (cm0pSrc) that feeds into the CM0+ NVIC mux (intrSrc).</p>
<p>For CM4 core, system interrupt source 'n' is connected to the corresponding IRQn. Deep-sleep capable interrupts are allocated to Deep Sleep capable IRQn channels.</p>
<p>For CM0+ core, deep Sleep wakeup-capability is determined by the CPUSS_CM0_DPSLP_IRQ_NR parameter, where the first N number of muxes (NvicMux0 ... NvicMuxN-1) have the capability to trigger Deep Sleep interrupts. A Deep Sleep capable interrupt source must be connected to one of these muxes to be able to trigger in Deep Sleep. Refer to the IRQn_Type definition in the device header.</p>
<ol type="1">
<li>For CPUSS_ver1 the CM0+ core supports up to 32 interrupt channels (IRQn 0-31). To allow all device interrupts to be routable to the NVIC of this core, there is a 240:1 multiplexer at each of the 32 NVIC channels.</li>
<li>For CPUSS_ver2 the CM0+ core supports up to 8 hardware interrupt channels (IRQn 0-7) and software-only interrupt channels (IRQn 8-15). The device has up to 1023 interrupts that can be connected to any of the hardware interrupt channels. In this structure, multiple interrupt sources can be connected simultaneously to one NVIC channel. The application must then query the interrupt source on the channel and service the active interrupt(s). The priority of these interrupts is determined by the interrupt number as defined in the cy_en_intr_t enum, where the lower number denotes higher priority over the higher number.</li>
</ol>
<h2><a class="anchor" id="group_sysint_enable"></a>
Enable</h2>
<p>After initializing an interrupt, use the CMSIS Core <a href="https://www.keil.com/pack/doc/CMSIS/Core/html/group__NVIC__gr.html#ga530ad9fda2ed1c8b70e439ecfe80591f">NVIC_EnableIRQ()</a> function to enable it. Given an initialization structure named config, the function should be called as follows: </p><div class="fragment"><div class="line">NVIC_EnableIRQ(config.intrSrc)</div></div><!-- fragment --><h2><a class="anchor" id="group_sysint_service"></a>
Writing an interrupt service routine</h2>
<p>Servicing interrupts in the Peripheral Drivers should follow a prescribed recipe to ensure all interrupts are serviced and duplicate interrupts are not received. Any peripheral-specific register that must be written to clear the source of the interrupt should be written as soon as possible in the interrupt service routine. However, note that due to buffering on the output bus to the peripherals, the write clearing of the interrupt may be delayed. After performing the normal interrupt service that should respond to the interrupting condition, the interrupt register that was initially written to clear the register should be read before returning from the interrupt service routine. This read ensures that the initial write has been flushed out to the hardware. Note, no additional processing should be performed based on the result of this read, as this read is intended only to ensure the write operation is flushed.</p>
<p>This final read may indicate a pending interrupt. What this means is that in the interval between when the write actually happened at the peripheral and when the read actually happened at the peripheral, an interrupting condition occurred. This is ok and a return from the interrupt is still the correct action. As soon as conditions warrant, meaning interrupts are enabled and there are no higher priority interrupts pending, the interrupt will be triggered again to service the additional condition.</p>
<h1><a class="anchor" id="group_sysint_section_configuration_considerations"></a>
Configuration Considerations</h1>
<p>Certain CM0+ <a href="https://www.keil.com/pack/doc/CMSIS/Core/html/group__NVIC__gr.html#ga7e1129cd8a196f4284d41db3e82ad5c8">NVIC IRQn</a> channels are reserved for system use: </p><table class="doxtable">
<tr>
<th>NVIC channel (<a class="el" href="group__group__sysint__enums.html#ga7e1129cd8a196f4284d41db3e82ad5c8">IRQn_Type</a>)</th><th>Interrupt source (<a class="el" href="group__group__sysint__enums.html#ga8010dee187715cab833c8564fccedc20">cy_en_intr_t</a>)</th><th>Purpose </th></tr>
<tr>
<td>#0 (NvicMux0_IRQn)</td><td>IPC Interrupt #0 (cpuss_interrupts_ipc_0_IRQn)</td><td>System Calls to ROM </td></tr>
<tr>
<td>#1 (NvicMux1_IRQn)</td><td>IPC Interrupt #3 (cpuss_interrupts_ipc_3_IRQn)</td><td>System IPC pipe in the default startup </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>For CPUSS_ver2, each NVIC channel can be shared between multiple interrupt sources. However it is not recommended to share the application NVIC channel with the reserved channels.</dd></dl>
<h1><a class="anchor" id="group_sysint_more_information"></a>
More Information</h1>
<p>Refer to the technical reference manual (TRM) and the device datasheet.</p>
<h1><a class="anchor" id="group_sysint_MISRA"></a>
MISRA-C Compliance</h1>
<table class="doxtable">
<tr>
<th>MISRA Rule </th><th>Rule Class (Required/Advisory) </th><th>Rule Description </th><th>Description of Deviation(s)  </th></tr>
<tr>
<td>8.12 </td><td>R </td><td>Array declared with unknown size. </td><td>__Vectors and __ramVectors arrays can have the different size depend on the selected device.  </td></tr>
</table>
<h1><a class="anchor" id="group_sysint_changelog"></a>
Changelog</h1>
<table class="doxtable">
<tr>
<th>Version</th><th>Changes</th><th>Reason for Change </th></tr>
<tr>
<td>1.30 </td><td>The Cy_SysInt_SetNmiSource is updated with Protection Context check for CM0+. </td><td>User experience enhancement.  </td></tr>
<tr>
<td>1.20.1 </td><td>The Vector Table section is extended with a code snippet. </td><td>Documentation enhancement.  </td></tr>
<tr>
<td rowspan="3">1.20 </td><td>Flattened the organization of the driver source code into the single source directory and the single include directory. </td><td>Driver library directory-structure simplification.  </td></tr>
<tr>
<td><p class="starttd">Added CPUSS_ver2 support to the following API functions:</p><ul>
<li><a class="el" href="group__group__sysint__functions.html#ga59e3d1e09d83aa163865bcf5f363d7c3">Cy_SysInt_SetInterruptSource</a></li>
<li><a class="el" href="group__group__sysint__functions.html#ga82208c7a076f5f0f750986e84c3d5df0">Cy_SysInt_SetNmiSource</a></li>
<li><a class="el" href="group__group__sysint__functions.html#gabb19f0ef37e4b807fc33bd446a185b83">Cy_SysInt_GetNmiSource</a></li>
</ul>
<p>Added new API functions:</p><ul>
<li><a class="el" href="group__group__sysint__functions.html#ga7be24fe4952cebbba78e612463981287">Cy_SysInt_DisconnectInterruptSource</a></li>
<li><a class="el" href="group__group__sysint__functions.html#ga7caa3ebc40ed414983d1330e01dbb932">Cy_SysInt_GetNvicConnection</a></li>
<li><a class="el" href="group__group__sysint__functions.html#ga9e42b44b1946290e12f25ff5042f1fc0">Cy_SysInt_GetInterruptActive</a></li>
</ul>
<p class="endtd">Deprecated following functions:</p><ul>
<li>Cy_SysInt_SetIntSource</li>
<li>Cy_SysInt_GetIntSource</li>
<li>Cy_SysInt_SetIntSourceNMI</li>
<li>Cy_SysInt_GetIntSourceNMI  </li>
</ul>
</td><td>New devices support.  </td></tr>
<tr>
<td>Added register access layer. Use register access macros instead of direct register access using dereferenced pointers. </td><td>Makes register access device-independent, so that the PDL does not need to be recompiled for each supported part number.  </td></tr>
<tr>
<td>1.10 </td><td>Cy_SysInt_GetState() function is redefined to call NVIC_GetEnableIRQ() </td><td></td></tr>
<tr>
<td>1.0 </td><td>Initial version </td><td></td></tr>
</table>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
API Reference</h2></td></tr>
<tr class="memitem:group__group__sysint__macros"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sysint__macros.html">Macros</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__sysint__globals"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sysint__globals.html">Global variables</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__sysint__functions"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sysint__functions.html">Functions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__sysint__data__structures"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sysint__data__structures.html">Data Structures</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__sysint__enums"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sysint__enums.html">Enumerated Types</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>PSoC 6 Peripheral Driver Library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
