<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSoC 6 Peripheral Driver Library: DMA          (Direct Memory Access)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="cypress_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PSoC 6 Peripheral Driver Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__group__dma.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">API Reference</a>  </div>
  <div class="headertitle">
<div class="title">DMA (Direct Memory Access)</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">General Description</h2>
<p>Configures a DMA channel and its descriptor(s). </p>
<p>The functions and other declarations used in this driver are in cy_dma.h. You can include cy_pdl.h (ModusToolbox only) to get access to all functions and declarations in the PDL.</p>
<p>The DMA channel can be used in any project to transfer data without CPU intervention basing on a hardware trigger signal from another component.</p>
<p>A device may support more than one DMA hardware block. Each block has a set of registers, a base hardware address, and supports multiple channels. Many API functions for the DMA driver require a base hardware address and channel number. Ensure that you use the correct hardware address for the DMA block in use.</p>
<p>Features:</p><ul>
<li>Multiple DW blocks (device specific)</li>
<li>Multiple channels per each DW block (device specific)</li>
<li>Four priority levels for each channel</li>
<li>Byte, half-word (2-byte), and word (4-byte) transfers</li>
<li>Configurable source and destination addresses</li>
<li>CRC calculation support (only for CPUSS_ver2)</li>
</ul>
<h1><a class="anchor" id="group_dma_configuration"></a>
Configuration Considerations</h1>
<p>To set up a DMA driver, initialize a descriptor, initialize and enable a channel, and enable the DMA block.</p>
<p>To set up a descriptor, provide the configuration parameters for the descriptor in the <a class="el" href="structcy__stc__dma__descriptor__config__t.html">cy_stc_dma_descriptor_config_t</a> structure. Then call the <a class="el" href="group__group__dma__descriptor__functions.html#gab1610fab6f2dd5fd25c031ac0aa9d8cb">Cy_DMA_Descriptor_Init</a> function to initialize the descriptor in SRAM. You can modify the source and destination addresses dynamically by calling <a class="el" href="group__group__dma__descriptor__functions.html#ga2df838cf16522aa18ad713fd05107b4c">Cy_DMA_Descriptor_SetSrcAddress</a> and <a class="el" href="group__group__dma__descriptor__functions.html#ga2c7111653150314961db83f7941a03c2">Cy_DMA_Descriptor_SetDstAddress</a>.</p>
<p>To set up a DMA channel, provide a filled <a class="el" href="structcy__stc__dma__channel__config__t.html">cy_stc_dma_channel_config_t</a> structure. Call the <a class="el" href="group__group__dma__channel__functions.html#gab0beed3c05362206ac66fc4327d8964b">Cy_DMA_Channel_Init</a> function, specifying the channel number. Use <a class="el" href="group__group__dma__channel__functions.html#ga13e6923cafe660ba825ba6d5b1841bf7">Cy_DMA_Channel_Enable</a> to enable the configured DMA channel.</p>
<p>Call <a class="el" href="group__group__dma__channel__functions.html#ga13e6923cafe660ba825ba6d5b1841bf7">Cy_DMA_Channel_Enable</a> for each DMA channel in use.</p>
<p>When configured, another peripheral typically triggers the DMA. The trigger is connected to the DMA using the trigger multiplexer. The trigger multiplexer driver has a software trigger you can use in firmware to trigger the DMA. See the <a href="group__group__trigmux.html">Trigger Multiplexer</a> documentation.</p>
<p>The following is a simplified structure of the DMA driver API interdependencies in a typical user application: </p><div class="image">
<img src="dma.png" alt="dma.png"/>
</div>
<p><b>NOTE:</b> Even if a DMA channel is enabled, it is not operational until the DMA block is enabled using function <a class="el" href="group__group__dma__block__functions.html#gad14b53935dc8321f395e49a7dfec2c5a">Cy_DMA_Enable</a>.<br />
<b>NOTE:</b> If the DMA descriptor is configured to generate an interrupt, the interrupt must be enabled using the <a class="el" href="group__group__dma__channel__functions.html#gab3e0528d8e57ee04dbbee89ffca38545">Cy_DMA_Channel_SetInterruptMask</a> function for each DMA channel.</p>
<p>For example: </p><div class="fragment"><div class="line">    </div><div class="line">    <span class="comment">/* Scenario: Initialize a 1D descriptor */</span></div><div class="line"><span class="preprocessor">    #define DATACNT (8UL)</span></div><div class="line">    <a class="code" href="structcy__stc__dma__descriptor__t.html">cy_stc_dma_descriptor_t</a> descriptor;</div><div class="line">    <a class="code" href="structcy__stc__dma__descriptor__t.html">cy_stc_dma_descriptor_t</a> nextDescriptor;</div><div class="line">    uint32_t src[DATACNT];</div><div class="line">    uint32_t dst[DATACNT];</div><div class="line">    </div><div class="line">    <a class="code" href="structcy__stc__dma__descriptor__config__t.html">cy_stc_dma_descriptor_config_t</a> descriptor_cfg = </div><div class="line">    {</div><div class="line">        .<a class="code" href="structcy__stc__dma__descriptor__config__t.html#afcc039279bc1e7d50b0813778772f3c0">retrigger</a> = <a class="code" href="group__group__dma__enums.html#gga8ea649c82d5e7d4d4bd72403468aadeea0bf275b3b0a14445f5adb266865664ee">CY_DMA_RETRIG_IM</a>,</div><div class="line">        .interruptType = <a class="code" href="group__group__dma__enums.html#gga46664f020f211baf0651e6c85c3c3e76ae49e9abd58d729c9875ce44e73b1b26b">CY_DMA_DESCR</a>,</div><div class="line">        .triggerOutType = <a class="code" href="group__group__dma__enums.html#gga46664f020f211baf0651e6c85c3c3e76ae49e9abd58d729c9875ce44e73b1b26b">CY_DMA_DESCR</a>,</div><div class="line">        .channelState = <a class="code" href="group__group__dma__enums.html#gga75740ce8bf02f62bc9e6c86307369f67a7f4266bff1786e17ba9b892ba03334db">CY_DMA_CHANNEL_ENABLED</a>,</div><div class="line">        .triggerInType = <a class="code" href="group__group__dma__enums.html#gga46664f020f211baf0651e6c85c3c3e76ae49e9abd58d729c9875ce44e73b1b26b">CY_DMA_DESCR</a>,</div><div class="line">        .dataSize = <a class="code" href="group__group__dma__enums.html#gga167a5222a0d666c6ce9e8382e56ac192a06aa9f141fdba0572953b0ffe8972ccc">CY_DMA_WORD</a>,</div><div class="line">        .srcTransferSize = <a class="code" href="group__group__dma__enums.html#gga2e6a1fad6945ca581ebd0fdbb8748314a559ffa18c8d6862e31c444eed54de51e">CY_DMA_TRANSFER_SIZE_WORD</a>,</div><div class="line">        .dstTransferSize = <a class="code" href="group__group__dma__enums.html#gga2e6a1fad6945ca581ebd0fdbb8748314a559ffa18c8d6862e31c444eed54de51e">CY_DMA_TRANSFER_SIZE_WORD</a>,</div><div class="line">        .descriptorType = <a class="code" href="group__group__dma__enums.html#gga69516534f5a562e8a2f55bb4203851d0a7d12c181e7b926a71c7c30eb77ac8955">CY_DMA_1D_TRANSFER</a>,</div><div class="line">        .srcAddress = &amp;src,</div><div class="line">        .dstAddress = &amp;dst,</div><div class="line">        .srcXincrement = 1U,</div><div class="line">        .dstXincrement = 1U,</div><div class="line">        .xCount = DATACNT,</div><div class="line">        .srcYincrement = 0U,</div><div class="line">        .dstYincrement = 0U,</div><div class="line">        .yCount = 1UL,</div><div class="line">        .nextDescriptor = &amp;nextDescriptor,</div><div class="line">    };</div><div class="line">    </div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__group__dma__enums.html#ggafbef983fffc7c7bb724322e8f64d32e5a5223359d0e1e316300e678afaa8cee96">CY_DMA_SUCCESS</a> != <a class="code" href="group__group__dma__descriptor__functions.html#gab1610fab6f2dd5fd25c031ac0aa9d8cb">Cy_DMA_Descriptor_Init</a>(&amp;descriptor, &amp;descriptor_cfg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Insert error handling */</span></div><div class="line">    }</div><div class="line">    </div><div class="line">    <span class="comment">/* Scenario: Setup and enable the DMA channel 0 of block DW0 */</span></div><div class="line">    <a class="code" href="structcy__stc__dma__channel__config__t.html">cy_stc_dma_channel_config_t</a> channelConfig;</div><div class="line">    channelConfig.<a class="code" href="structcy__stc__dma__channel__config__t.html#aab3204617ecee2a57b1f76832966227d">preemptable</a> = <span class="keyword">false</span>;</div><div class="line">    channelConfig.<a class="code" href="structcy__stc__dma__channel__config__t.html#a018bbd8e3039b78ad16f9c0536dde3c0">enable</a> = <span class="keyword">false</span>;</div><div class="line">    channelConfig.<a class="code" href="structcy__stc__dma__channel__config__t.html#aa40017613f97a28e2802e072fdf38817">bufferable</a> = <span class="keyword">false</span>;</div><div class="line">    </div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__group__dma__enums.html#ggafbef983fffc7c7bb724322e8f64d32e5a5223359d0e1e316300e678afaa8cee96">CY_DMA_SUCCESS</a> != <a class="code" href="group__group__dma__channel__functions.html#gab0beed3c05362206ac66fc4327d8964b">Cy_DMA_Channel_Init</a>(DW0, 0UL, &amp;channelConfig))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Insert error handling */</span></div><div class="line">    }</div><div class="line">    </div><div class="line">    <a class="code" href="group__group__dma__channel__functions.html#ga4c5cca40de761c4b7827ce65538bf12d">Cy_DMA_Channel_SetDescriptor</a>(DW0, 0UL, &amp;descriptor);</div><div class="line">    <a class="code" href="group__group__dma__channel__functions.html#gae088032ef5679610fdcbea8d1b4a3cd3">Cy_DMA_Channel_SetPriority</a>(DW0, 0UL, 3UL);</div><div class="line">    <a class="code" href="group__group__dma__channel__functions.html#ga13e6923cafe660ba825ba6d5b1841bf7">Cy_DMA_Channel_Enable</a>(DW0, 0UL);</div><div class="line">    </div><div class="line">    <a class="code" href="group__group__dma__block__functions.html#gad14b53935dc8321f395e49a7dfec2c5a">Cy_DMA_Enable</a>(DW0);</div><div class="line">    </div></div><!-- fragment --> <h1><a class="anchor" id="group_dma_more_information"></a>
More Information.</h1>
<p>See: the DMA chapter of the device technical reference manual (TRM); the DMA Component datasheet; CE219940 - PSoC 6 MCU Multiple DMA Concatenation.</p>
<h1><a class="anchor" id="group_dma_MISRA"></a>
MISRA-C Compliance</h1>
<p>The DMA driver has the following specific deviations:</p>
<table class="doxtable">
<tr>
<th>MISRA Rule </th><th>Rule Class (Required/Advisory) </th><th>Rule Description </th><th>Description of Deviation(s)  </th></tr>
<tr>
<td>10.3 </td><td>R </td><td>A composite expression of the "essentially unsigned" type is being cast to a different type category. </td><td>The value got from the bitfield physically cannot exceed the enumeration that describes this bitfield. So, the code is safe by design.  </td></tr>
<tr>
<td>11.4 </td><td>A </td><td>A cast should not be performed between a pointer to object type and a different pointer to object type. </td><td>This piece of code is written for DW_V2_Type only and it will be never executed for DW_V1_Type (which is a default build option for <a class="el" href="struct_d_w___type.html" title="The struct type definition for the hardware register set contained in the block.  The address of a va...">DW_Type</a>).  </td></tr>
</table>
<h1><a class="anchor" id="group_dma_changelog"></a>
Changelog</h1>
<table class="doxtable">
<tr>
<th>Version</th><th>Changes</th><th>Reason for Change </th></tr>
<tr>
<td>2.20 </td><td>The channel number validation method is updated. </td><td>New devices support.  </td></tr>
<tr>
<td rowspan="3">2.10 </td><td>Flattened the organization of the driver source code into the single source directory and the single include directory. </td><td>Driver library directory-structure simplification.  </td></tr>
<tr>
<td>Added CRC mode and the CRC descriptor support. <br />
 Added the <a class="el" href="group__group__dma__block__functions.html#ga3ef821c63ecd6b0d33ded10db6ed618e">Cy_DMA_Crc_Init</a> function. </td><td>New devices support.  </td></tr>
<tr>
<td>Added register access layer. Use register access macros instead of direct register access using dereferenced pointers. </td><td>Makes register access device-independent, so that the PDL does not need to be recompiled for each supported part number.  </td></tr>
<tr>
<td>2.0.1 </td><td>Changed CY_DMA_BWC macro values from Boolean to numeric </td><td>Improvements made based on usability feedback  </td></tr>
<tr>
<td>2.0 </td><td>* All the API is refactored to be consistent within itself and with the rest of the PDL content.<ul>
<li>The descriptor API is updated as follows: The <a class="el" href="group__group__dma__descriptor__functions.html#gab1610fab6f2dd5fd25c031ac0aa9d8cb">Cy_DMA_Descriptor_Init</a> function sets a full bunch of descriptor settings, and the rest of the descriptor API is a get/set interface to each of the descriptor settings.</li>
<li>There is a group of macros to support the backward compatibility with most of the driver version 1.0 API. But, you should use the new v2.0 interface in new designs (do not just copy-paste from old projects). To enable the backward compatibility support, the CY_DMA_BWC definition should be changed to "1". </li>
</ul>
</td><td></td></tr>
<tr>
<td>1.0 </td><td>Initial version </td><td></td></tr>
</table>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
API Reference</h2></td></tr>
<tr class="memitem:group__group__dma__macros"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__dma__macros.html">Macros</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__dma__functions"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__dma__functions.html">Functions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__dma__data__structures"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__dma__data__structures.html">Data Structures</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__dma__enums"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__dma__enums.html">Enumerated Types</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>PSoC 6 Peripheral Driver Library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
