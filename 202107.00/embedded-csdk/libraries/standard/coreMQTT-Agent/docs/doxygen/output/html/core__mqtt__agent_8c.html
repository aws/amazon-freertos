<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>coreMQTT Agent: core_mqtt_agent.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="foobar.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">coreMQTT Agent<span id="projectnumber">&#160;v1.0.0</span>
   </div>
   <div id="projectbrief">Thread safe MQTT 3.1.1 Client</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('core__mqtt__agent_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">core_mqtt_agent.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implements an MQTT agent (or daemon task) to enable multithreaded access to coreMQTT.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="core__mqtt__agent_8h_source.html">core_mqtt_agent.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="core__mqtt__agent__command__functions_8h_source.html">core_mqtt_agent_command_functions.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae70f7438de05ac589b4e48d4a2a7dd7b"><td class="memItemLeft" align="right" valign="top">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#ae70f7438de05ac589b4e48d4a2a7dd7b">addAwaitingOperation</a> (<a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pAgentContext, uint16_t packetId, MQTTAgentCommand_t *pCommand)</td></tr>
<tr class="memdesc:ae70f7438de05ac589b4e48d4a2a7dd7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Track an operation by adding it to a list, indicating it is anticipating an acknowledgment.  <a href="core__mqtt__agent_8c.html#ae70f7438de05ac589b4e48d4a2a7dd7b">More...</a><br /></td></tr>
<tr class="separator:ae70f7438de05ac589b4e48d4a2a7dd7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ab608204e853ab34bda491a47f6b84"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="struct_m_q_t_t_agent_ack_info__t.html">MQTTAgentAckInfo_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#af4ab608204e853ab34bda491a47f6b84">getAwaitingOperation</a> (<a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pAgentContext, uint16_t incomingPacketId)</td></tr>
<tr class="memdesc:af4ab608204e853ab34bda491a47f6b84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve an operation from the list of pending acks, and optionally remove it from the list.  <a href="core__mqtt__agent_8c.html#af4ab608204e853ab34bda491a47f6b84">More...</a><br /></td></tr>
<tr class="separator:af4ab608204e853ab34bda491a47f6b84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2d34a65263b609595aa8f1705ff89f"><td class="memItemLeft" align="right" valign="top">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a4f2d34a65263b609595aa8f1705ff89f">createCommand</a> (<a class="el" href="group__mqtt__agent__enum__types.html#ga76604fa58b7ee6c32ba084fda9379f33">MQTTAgentCommandType_t</a> commandType, const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, void *pMqttInfoParam, <a class="el" href="group__mqtt__agent__callback__types.html#gaa2497c28b3fb55b8dc38b0873f749eef">MQTTAgentCommandCallback_t</a> commandCompleteCallback, <a class="el" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> *pCommandCompleteCallbackContext, MQTTAgentCommand_t *pCommand)</td></tr>
<tr class="memdesc:a4f2d34a65263b609595aa8f1705ff89f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populate the parameters of a <a class="el" href="struct_m_q_t_t_agent_command.html" title="The commands sent from the APIs to the MQTT agent task.">MQTTAgentCommand</a> struct.  <a href="core__mqtt__agent_8c.html#a4f2d34a65263b609595aa8f1705ff89f">More...</a><br /></td></tr>
<tr class="separator:a4f2d34a65263b609595aa8f1705ff89f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38a109884abe76bd9e0b90d23b9d67b4"><td class="memItemLeft" align="right" valign="top">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a38a109884abe76bd9e0b90d23b9d67b4">addCommandToQueue</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pAgentContext, MQTTAgentCommand_t *pCommand, uint32_t blockTimeMs)</td></tr>
<tr class="memdesc:a38a109884abe76bd9e0b90d23b9d67b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a command to the global command queue.  <a href="core__mqtt__agent_8c.html#a38a109884abe76bd9e0b90d23b9d67b4">More...</a><br /></td></tr>
<tr class="separator:a38a109884abe76bd9e0b90d23b9d67b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18da6f0f75cb79d2b56db65b40ba9437"><td class="memItemLeft" align="right" valign="top">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a18da6f0f75cb79d2b56db65b40ba9437">processCommand</a> (<a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, MQTTAgentCommand_t *pCommand, bool *pEndLoop)</td></tr>
<tr class="memdesc:a18da6f0f75cb79d2b56db65b40ba9437"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a <a class="el" href="struct_m_q_t_t_agent_command.html" title="The commands sent from the APIs to the MQTT agent task.">MQTTAgentCommand</a> struct.  <a href="core__mqtt__agent_8c.html#a18da6f0f75cb79d2b56db65b40ba9437">More...</a><br /></td></tr>
<tr class="separator:a18da6f0f75cb79d2b56db65b40ba9437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aeca55423966c3eff1734316f6a7466"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a4aeca55423966c3eff1734316f6a7466">mqttEventCallback</a> (<a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html">MQTTContext_t</a> *pMqttContext, <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_packet_info__t.html">MQTTPacketInfo_t</a> *pPacketInfo, <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_deserialized_info__t.html">MQTTDeserializedInfo_t</a> *pDeserializedInfo)</td></tr>
<tr class="memdesc:a4aeca55423966c3eff1734316f6a7466"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatch incoming publishes and acks to their various handler functions.  <a href="core__mqtt__agent_8c.html#a4aeca55423966c3eff1734316f6a7466">More...</a><br /></td></tr>
<tr class="separator:a4aeca55423966c3eff1734316f6a7466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace2cab4efce97019ae5e12ccae2780cd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#ace2cab4efce97019ae5e12ccae2780cd">handleAcks</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pAgentContext, const <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_packet_info__t.html">MQTTPacketInfo_t</a> *pPacketInfo, const <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_deserialized_info__t.html">MQTTDeserializedInfo_t</a> *pDeserializedInfo, <a class="el" href="struct_m_q_t_t_agent_ack_info__t.html">MQTTAgentAckInfo_t</a> *pAckInfo, uint8_t packetType)</td></tr>
<tr class="memdesc:ace2cab4efce97019ae5e12ccae2780cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark a command as complete after receiving an acknowledgment packet.  <a href="core__mqtt__agent_8c.html#ace2cab4efce97019ae5e12ccae2780cd">More...</a><br /></td></tr>
<tr class="separator:ace2cab4efce97019ae5e12ccae2780cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6cd05d1e6b270a021cb50980654707"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#adb6cd05d1e6b270a021cb50980654707">getAgentFromMQTTContext</a> (<a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html">MQTTContext_t</a> *pMQTTContext)</td></tr>
<tr class="memdesc:adb6cd05d1e6b270a021cb50980654707"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a pointer to an agent context given an MQTT context.  <a href="core__mqtt__agent_8c.html#adb6cd05d1e6b270a021cb50980654707">More...</a><br /></td></tr>
<tr class="separator:adb6cd05d1e6b270a021cb50980654707"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a594dbfd47f77c6988960110da3c25a2c"><td class="memItemLeft" align="right" valign="top">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a594dbfd47f77c6988960110da3c25a2c">createAndAddCommand</a> (<a class="el" href="group__mqtt__agent__enum__types.html#ga76604fa58b7ee6c32ba084fda9379f33">MQTTAgentCommandType_t</a> commandType, const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, void *pMqttInfoParam, <a class="el" href="group__mqtt__agent__callback__types.html#gaa2497c28b3fb55b8dc38b0873f749eef">MQTTAgentCommandCallback_t</a> commandCompleteCallback, <a class="el" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> *pCommandCompleteCallbackContext, uint32_t blockTimeMs)</td></tr>
<tr class="memdesc:a594dbfd47f77c6988960110da3c25a2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function for creating a command and adding it to the command queue.  <a href="core__mqtt__agent_8c.html#a594dbfd47f77c6988960110da3c25a2c">More...</a><br /></td></tr>
<tr class="separator:a594dbfd47f77c6988960110da3c25a2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a848611250b309e0d84cb18a42fbf6391"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a848611250b309e0d84cb18a42fbf6391">concludeCommand</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pAgentContext, MQTTAgentCommand_t *pCommand, <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> returnCode, uint8_t *pSubackCodes)</td></tr>
<tr class="memdesc:a848611250b309e0d84cb18a42fbf6391"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to mark a command as complete and invoke its callback. This function calls the releaseCommand callback.  <a href="core__mqtt__agent_8c.html#a848611250b309e0d84cb18a42fbf6391">More...</a><br /></td></tr>
<tr class="separator:a848611250b309e0d84cb18a42fbf6391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c7ea532d3da52d5c8ceb7493ce5fe36"><td class="memItemLeft" align="right" valign="top">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a0c7ea532d3da52d5c8ceb7493ce5fe36">resendPublishes</a> (<a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext)</td></tr>
<tr class="memdesc:a0c7ea532d3da52d5c8ceb7493ce5fe36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resend QoS 1 and 2 publishes after resuming a session.  <a href="core__mqtt__agent_8c.html#a0c7ea532d3da52d5c8ceb7493ce5fe36">More...</a><br /></td></tr>
<tr class="separator:a0c7ea532d3da52d5c8ceb7493ce5fe36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb076dcf75919d5b638c33054b95461d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#afb076dcf75919d5b638c33054b95461d">clearPendingAcknowledgments</a> (<a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, bool clearOnlySubUnsubEntries)</td></tr>
<tr class="memdesc:afb076dcf75919d5b638c33054b95461d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the list of pending acknowledgments by invoking each callback with <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735caa14bc8aa4ad218702d782366945d43ac">MQTTRecvFailed</a> either for ALL operations in the list OR only for Subscribe/Unsubscribe operations.  <a href="core__mqtt__agent_8c.html#afb076dcf75919d5b638c33054b95461d">More...</a><br /></td></tr>
<tr class="separator:afb076dcf75919d5b638c33054b95461d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77d4ec3f1e90897d6f173a2fcd7b9b61"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a77d4ec3f1e90897d6f173a2fcd7b9b61">validateStruct</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *pCommandInfo)</td></tr>
<tr class="memdesc:a77d4ec3f1e90897d6f173a2fcd7b9b61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate an <a class="el" href="struct_m_q_t_t_agent_context__t.html" title="Information used by each MQTT agent. A context will be initialized by MQTTAgent_Init(),...">MQTTAgentContext_t</a> and a <a class="el" href="struct_m_q_t_t_agent_command_info__t.html" title="Struct holding arguments that are common to every command.">MQTTAgentCommandInfo_t</a> from API functions.  <a href="core__mqtt__agent_8c.html#a77d4ec3f1e90897d6f173a2fcd7b9b61">More...</a><br /></td></tr>
<tr class="separator:a77d4ec3f1e90897d6f173a2fcd7b9b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b1b83accad3124122fed5c7ec14870"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#ac6b1b83accad3124122fed5c7ec14870">validateParams</a> (<a class="el" href="group__mqtt__agent__enum__types.html#ga76604fa58b7ee6c32ba084fda9379f33">MQTTAgentCommandType_t</a> commandType, const void *pParams)</td></tr>
<tr class="memdesc:ac6b1b83accad3124122fed5c7ec14870"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate the parameters for a CONNECT, SUBSCRIBE, UNSUBSCRIBE or PUBLISH.  <a href="core__mqtt__agent_8c.html#ac6b1b83accad3124122fed5c7ec14870">More...</a><br /></td></tr>
<tr class="separator:ac6b1b83accad3124122fed5c7ec14870"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6082ea8cf8fe3f34e0a8de08d6980a29"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a6082ea8cf8fe3f34e0a8de08d6980a29">isSpaceInPendingAckList</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pAgentContext)</td></tr>
<tr class="memdesc:a6082ea8cf8fe3f34e0a8de08d6980a29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called before accepting any PUBLISH or SUBSCRIBE messages to check there is space in the pending ACK list for the outgoing PUBLISH or SUBSCRIBE.  <a href="core__mqtt__agent_8c.html#a6082ea8cf8fe3f34e0a8de08d6980a29">More...</a><br /></td></tr>
<tr class="separator:a6082ea8cf8fe3f34e0a8de08d6980a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a584863528e72229f35003485f7ee0edd"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a584863528e72229f35003485f7ee0edd">MQTTAgent_Init</a> (<a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, const <a class="el" href="struct_m_q_t_t_agent_message_interface__t.html">MQTTAgentMessageInterface_t</a> *pMsgInterface, const <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_fixed_buffer__t.html">MQTTFixedBuffer_t</a> *pNetworkBuffer, const <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html">TransportInterface_t</a> *pTransportInterface, <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__callback__types.html#gae3bea55b0e49e5208b8c5709a5ea23aa">MQTTGetCurrentTimeFunc_t</a> getCurrentTimeMs, <a class="el" href="group__mqtt__agent__callback__types.html#gacdfb8687b1217d321e7cc58e365ec6a1">MQTTAgentIncomingPublishCallback_t</a> incomingCallback, void *pIncomingPacketContext)</td></tr>
<tr class="memdesc:a584863528e72229f35003485f7ee0edd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform any initialization the MQTT agent requires before it can be used. Must be called before any other function.  <a href="core__mqtt__agent_8c.html#a584863528e72229f35003485f7ee0edd">More...</a><br /></td></tr>
<tr class="separator:a584863528e72229f35003485f7ee0edd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dafeb1701b1a0ee897b626a09cfcff7"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a9dafeb1701b1a0ee897b626a09cfcff7">MQTTAgent_CommandLoop</a> (<a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext)</td></tr>
<tr class="memdesc:a9dafeb1701b1a0ee897b626a09cfcff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process commands from the command queue in a loop.  <a href="core__mqtt__agent_8c.html#a9dafeb1701b1a0ee897b626a09cfcff7">More...</a><br /></td></tr>
<tr class="separator:a9dafeb1701b1a0ee897b626a09cfcff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75065d6bff5f2d32831f2c74922296fb"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a75065d6bff5f2d32831f2c74922296fb">MQTTAgent_ResumeSession</a> (<a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, bool sessionPresent)</td></tr>
<tr class="memdesc:a75065d6bff5f2d32831f2c74922296fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume a session by resending publishes if a session is present in the broker, or clear state information if not.  <a href="core__mqtt__agent_8c.html#a75065d6bff5f2d32831f2c74922296fb">More...</a><br /></td></tr>
<tr class="separator:a75065d6bff5f2d32831f2c74922296fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0362d7d3d68628413f01b32ec2ff4ab6"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a0362d7d3d68628413f01b32ec2ff4ab6">MQTTAgent_CancelAll</a> (<a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext)</td></tr>
<tr class="memdesc:a0362d7d3d68628413f01b32ec2ff4ab6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel all enqueued commands and those awaiting acknowledgment while the command loop is not running.  <a href="core__mqtt__agent_8c.html#a0362d7d3d68628413f01b32ec2ff4ab6">More...</a><br /></td></tr>
<tr class="separator:a0362d7d3d68628413f01b32ec2ff4ab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a651cf10182392ecea5e8609af8855d49"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a651cf10182392ecea5e8609af8855d49">MQTTAgent_Subscribe</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, <a class="el" href="struct_m_q_t_t_agent_subscribe_args__t.html">MQTTAgentSubscribeArgs_t</a> *pSubscriptionArgs, const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *pCommandInfo)</td></tr>
<tr class="memdesc:a651cf10182392ecea5e8609af8855d49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a567aa9c38726a7879f9cbf943e813e8f">MQTT_Subscribe()</a> for an MQTT connection.  <a href="core__mqtt__agent_8c.html#a651cf10182392ecea5e8609af8855d49">More...</a><br /></td></tr>
<tr class="separator:a651cf10182392ecea5e8609af8855d49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3f70c81c8f8947dfb7346045c8edb63"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#ac3f70c81c8f8947dfb7346045c8edb63">MQTTAgent_Unsubscribe</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, <a class="el" href="struct_m_q_t_t_agent_subscribe_args__t.html">MQTTAgentSubscribeArgs_t</a> *pSubscriptionArgs, const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *pCommandInfo)</td></tr>
<tr class="memdesc:ac3f70c81c8f8947dfb7346045c8edb63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a77c911dbe24c5a51aaea88250895dba4">MQTT_Unsubscribe()</a> for an MQTT connection.  <a href="core__mqtt__agent_8c.html#ac3f70c81c8f8947dfb7346045c8edb63">More...</a><br /></td></tr>
<tr class="separator:ac3f70c81c8f8947dfb7346045c8edb63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea2405ab859324cb241ea47e6a5ab81"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#afea2405ab859324cb241ea47e6a5ab81">MQTTAgent_Publish</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html">MQTTPublishInfo_t</a> *pPublishInfo, const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *pCommandInfo)</td></tr>
<tr class="memdesc:afea2405ab859324cb241ea47e6a5ab81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a1d8217e9d30fb2aed002060a8c97c63e">MQTT_Publish()</a> for an MQTT connection.  <a href="core__mqtt__agent_8c.html#afea2405ab859324cb241ea47e6a5ab81">More...</a><br /></td></tr>
<tr class="separator:afea2405ab859324cb241ea47e6a5ab81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa14c9c86e036d0b1f5c04a538597cc46"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#aa14c9c86e036d0b1f5c04a538597cc46">MQTTAgent_ProcessLoop</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *pCommandInfo)</td></tr>
<tr class="memdesc:aa14c9c86e036d0b1f5c04a538597cc46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a message to the MQTT agent purely to trigger an iteration of its loop, which will result in a call to <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#adce9111350db412c1256689ef9a7b9f4">MQTT_ProcessLoop()</a>. This function can be used to wake the MQTT agent task when it is known data may be available on the connected socket.  <a href="core__mqtt__agent_8c.html#aa14c9c86e036d0b1f5c04a538597cc46">More...</a><br /></td></tr>
<tr class="separator:aa14c9c86e036d0b1f5c04a538597cc46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a782425e50d258837d23e379471254412"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a782425e50d258837d23e379471254412">MQTTAgent_Connect</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, <a class="el" href="struct_m_q_t_t_agent_connect_args__t.html">MQTTAgentConnectArgs_t</a> *pConnectArgs, const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *pCommandInfo)</td></tr>
<tr class="memdesc:a782425e50d258837d23e379471254412"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#aed1e4dc123a8ba79ac569cb17c69bfa0">MQTT_Connect()</a> for an MQTT connection. If a session is resumed with the broker, it will also resend the necessary QoS1/2 publishes.  <a href="core__mqtt__agent_8c.html#a782425e50d258837d23e379471254412">More...</a><br /></td></tr>
<tr class="separator:a782425e50d258837d23e379471254412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26687b9b762b5f52b14387bacdf17224"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#a26687b9b762b5f52b14387bacdf17224">MQTTAgent_Disconnect</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *pCommandInfo)</td></tr>
<tr class="memdesc:a26687b9b762b5f52b14387bacdf17224"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a command to disconnect an MQTT connection.  <a href="core__mqtt__agent_8c.html#a26687b9b762b5f52b14387bacdf17224">More...</a><br /></td></tr>
<tr class="separator:a26687b9b762b5f52b14387bacdf17224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae260e29f31d51953cbab2e1437f645ed"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#ae260e29f31d51953cbab2e1437f645ed">MQTTAgent_Ping</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *pCommandInfo)</td></tr>
<tr class="memdesc:ae260e29f31d51953cbab2e1437f645ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a66eced0c62ace790354ae3de40fc0959">MQTT_Ping()</a> for an MQTT connection.  <a href="core__mqtt__agent_8c.html#ae260e29f31d51953cbab2e1437f645ed">More...</a><br /></td></tr>
<tr class="separator:ae260e29f31d51953cbab2e1437f645ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b19c10831f72251603b045f2608313"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__mqtt__agent_8c.html#ae1b19c10831f72251603b045f2608313">MQTTAgent_Terminate</a> (const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *pMqttAgentContext, const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *pCommandInfo)</td></tr>
<tr class="memdesc:ae1b19c10831f72251603b045f2608313"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a termination command to the command queue.  <a href="core__mqtt__agent_8c.html#ae1b19c10831f72251603b045f2608313">More...</a><br /></td></tr>
<tr class="separator:ae1b19c10831f72251603b045f2608313"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Implements an MQTT agent (or daemon task) to enable multithreaded access to coreMQTT. </p>
<dl class="section note"><dt>Note</dt><dd>Implements an MQTT agent (or daemon task) on top of the coreMQTT MQTT client library. The agent makes coreMQTT usage thread safe by being the only task (or thread) in the system that is allowed to access the native coreMQTT API - and in so doing, serializes all access to coreMQTT even when multiple tasks are using the same MQTT connection.</dd></dl>
<p>The agent provides an equivalent API for each coreMQTT API. Whereas coreMQTT APIs are prefixed "MQTT_", the agent APIs are prefixed "MQTTAgent_". For example, that agent's <a class="el" href="core__mqtt__agent_8c.html#afea2405ab859324cb241ea47e6a5ab81" title="Add a command to call MQTT_Publish() for an MQTT connection.">MQTTAgent_Publish()</a> API is the thread safe equivalent to coreMQTT's <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a1d8217e9d30fb2aed002060a8c97c63e">MQTT_Publish()</a> API. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae70f7438de05ac589b4e48d4a2a7dd7b" name="ae70f7438de05ac589b4e48d4a2a7dd7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae70f7438de05ac589b4e48d4a2a7dd7b">&#9670;&nbsp;</a></span>addAwaitingOperation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> addAwaitingOperation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>packetId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MQTTAgentCommand_t *&#160;</td>
          <td class="paramname"><em>pCommand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Track an operation by adding it to a list, indicating it is anticipating an acknowledgment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pAgentContext</td><td>Agent context for the MQTT connection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">packetId</td><td>Packet ID of pending ack. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommand</td><td>Pointer to command that is expecting an ack.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns one of the following:<ul>
<li><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if an entry was added for the to the list.</li>
<li><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca8d05b92240dea6df08eab5a9e3799c11">MQTTStateCollision</a> if there already exists an entry for the same packet ID in the list.</li>
<li><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735cab1be4db832a0468f024243bca151a8df">MQTTNoMemory</a> if there is no space available in the list for adding a new entry. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="af4ab608204e853ab34bda491a47f6b84" name="af4ab608204e853ab34bda491a47f6b84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4ab608204e853ab34bda491a47f6b84">&#9670;&nbsp;</a></span>getAwaitingOperation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="struct_m_q_t_t_agent_ack_info__t.html">MQTTAgentAckInfo_t</a> * getAwaitingOperation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>incomingPacketId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve an operation from the list of pending acks, and optionally remove it from the list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pAgentContext</td><td>Agent context for the MQTT connection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">incomingPacketId</td><td>Packet ID of incoming ack.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to stored information about the operation awaiting the ack. Returns NULL if the packet ID is zero or original command does not exist. </dd></dl>

</div>
</div>
<a id="a4f2d34a65263b609595aa8f1705ff89f" name="a4f2d34a65263b609595aa8f1705ff89f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f2d34a65263b609595aa8f1705ff89f">&#9670;&nbsp;</a></span>createCommand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> createCommand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__agent__enum__types.html#ga76604fa58b7ee6c32ba084fda9379f33">MQTTAgentCommandType_t</a>&#160;</td>
          <td class="paramname"><em>commandType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pMqttInfoParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__agent__callback__types.html#gaa2497c28b3fb55b8dc38b0873f749eef">MQTTAgentCommandCallback_t</a>&#160;</td>
          <td class="paramname"><em>commandCompleteCallback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandCompleteCallbackContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MQTTAgentCommand_t *&#160;</td>
          <td class="paramname"><em>pCommand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Populate the parameters of a <a class="el" href="struct_m_q_t_t_agent_command.html" title="The commands sent from the APIs to the MQTT agent task.">MQTTAgentCommand</a> struct. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">commandType</td><td>Type of command. For example, publish or subscribe. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>Pointer to MQTT context to use for command. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttInfoParam</td><td>Pointer to <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html">MQTTPublishInfo_t</a> or <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html">MQTTSubscribeInfo_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">commandCompleteCallback</td><td>Callback for when command completes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandCompleteCallbackContext</td><td>Context and necessary structs for command. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pCommand</td><td>Pointer to initialized command.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if all necessary fields for the command are passed, else an enumerated error code. </dd></dl>

</div>
</div>
<a id="a38a109884abe76bd9e0b90d23b9d67b4" name="a38a109884abe76bd9e0b90d23b9d67b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38a109884abe76bd9e0b90d23b9d67b4">&#9670;&nbsp;</a></span>addCommandToQueue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> addCommandToQueue </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MQTTAgentCommand_t *&#160;</td>
          <td class="paramname"><em>pCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>blockTimeMs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a command to the global command queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pAgentContext</td><td>Agent context for the MQTT connection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommand</td><td>Pointer to command to copy to queue. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockTimeMs</td><td>The maximum amount of time to milliseconds to wait in the Blocked state (so not consuming any CPU time) for the command to be posted to the queue should the queue already be full.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was added to the queue, else an enumerated error code. </dd></dl>

</div>
</div>
<a id="a18da6f0f75cb79d2b56db65b40ba9437" name="a18da6f0f75cb79d2b56db65b40ba9437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18da6f0f75cb79d2b56db65b40ba9437">&#9670;&nbsp;</a></span>processCommand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> processCommand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MQTTAgentCommand_t *&#160;</td>
          <td class="paramname"><em>pCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>pEndLoop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process a <a class="el" href="struct_m_q_t_t_agent_command.html" title="The commands sent from the APIs to the MQTT agent task.">MQTTAgentCommand</a> struct. </p>
<dl class="section note"><dt>Note</dt><dd>This agent does not check existing subscriptions before sending a SUBSCRIBE or UNSUBSCRIBE packet. If a subscription already exists, then a SUBSCRIBE packet will be sent anyway, and if multiple tasks are subscribed to a topic filter, then they will all be unsubscribed after an UNSUBSCRIBE.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>Agent context for MQTT connection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommand</td><td>Pointer to command to process. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pEndLoop</td><td>Whether the command loop should terminate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status of MQTT library API call. </dd></dl>

</div>
</div>
<a id="a4aeca55423966c3eff1734316f6a7466" name="a4aeca55423966c3eff1734316f6a7466"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aeca55423966c3eff1734316f6a7466">&#9670;&nbsp;</a></span>mqttEventCallback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void mqttEventCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html">MQTTContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_packet_info__t.html">MQTTPacketInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pPacketInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_deserialized_info__t.html">MQTTDeserializedInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pDeserializedInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dispatch incoming publishes and acks to their various handler functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttContext</td><td>MQTT Context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pPacketInfo</td><td>Pointer to incoming packet. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pDeserializedInfo</td><td>Pointer to deserialized information from the incoming packet. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ace2cab4efce97019ae5e12ccae2780cd" name="ace2cab4efce97019ae5e12ccae2780cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace2cab4efce97019ae5e12ccae2780cd">&#9670;&nbsp;</a></span>handleAcks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handleAcks </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_packet_info__t.html">MQTTPacketInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pPacketInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_deserialized_info__t.html">MQTTDeserializedInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pDeserializedInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_ack_info__t.html">MQTTAgentAckInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pAckInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>packetType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mark a command as complete after receiving an acknowledgment packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pAgentContext</td><td>Agent context for the MQTT connection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pPacketInfo</td><td>Pointer to incoming packet. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pDeserializedInfo</td><td>Pointer to deserialized information from the incoming packet. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pAckInfo</td><td>Pointer to stored information for the original operation resulting in the received packet. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">packetType</td><td>The type of the incoming packet, either SUBACK, UNSUBACK, PUBACK, or PUBCOMP. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adb6cd05d1e6b270a021cb50980654707" name="adb6cd05d1e6b270a021cb50980654707"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6cd05d1e6b270a021cb50980654707">&#9670;&nbsp;</a></span>getAgentFromMQTTContext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> * getAgentFromMQTTContext </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html">MQTTContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMQTTContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve a pointer to an agent context given an MQTT context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMQTTContext</td><td>MQTT Context to search for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to agent context, or NULL. </dd></dl>

</div>
</div>
<a id="a594dbfd47f77c6988960110da3c25a2c" name="a594dbfd47f77c6988960110da3c25a2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a594dbfd47f77c6988960110da3c25a2c">&#9670;&nbsp;</a></span>createAndAddCommand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> createAndAddCommand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__agent__enum__types.html#ga76604fa58b7ee6c32ba084fda9379f33">MQTTAgentCommandType_t</a>&#160;</td>
          <td class="paramname"><em>commandType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pMqttInfoParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__agent__callback__types.html#gaa2497c28b3fb55b8dc38b0873f749eef">MQTTAgentCommandCallback_t</a>&#160;</td>
          <td class="paramname"><em>commandCompleteCallback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandCompleteCallbackContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>blockTimeMs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function for creating a command and adding it to the command queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">commandType</td><td>Type of command. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>Handle of the MQTT connection to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandCompleteCallbackContext</td><td>Context and necessary structs for command. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">commandCompleteCallback</td><td>Callback for when command completes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttInfoParam</td><td>Pointer to command argument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockTimeMs</td><td>Maximum amount of time in milliseconds to wait (in the Blocked state, so not consuming any CPU time) for the command to be posted to the MQTT agent should the MQTT agent's event queue be full.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was posted to the MQTT agent's event queue. Otherwise an enumerated error code. </dd></dl>

</div>
</div>
<a id="a848611250b309e0d84cb18a42fbf6391" name="a848611250b309e0d84cb18a42fbf6391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a848611250b309e0d84cb18a42fbf6391">&#9670;&nbsp;</a></span>concludeCommand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void concludeCommand </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MQTTAgentCommand_t *&#160;</td>
          <td class="paramname"><em>pCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a>&#160;</td>
          <td class="paramname"><em>returnCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pSubackCodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to mark a command as complete and invoke its callback. This function calls the releaseCommand callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pAgentContext</td><td>Agent context for the MQTT connection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommand</td><td>Command to complete. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">returnCode</td><td>Return status of command. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSubackCodes</td><td>Pointer to suback array, if command is a SUBSCRIBE. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0c7ea532d3da52d5c8ceb7493ce5fe36" name="a0c7ea532d3da52d5c8ceb7493ce5fe36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c7ea532d3da52d5c8ceb7493ce5fe36">&#9670;&nbsp;</a></span>resendPublishes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> resendPublishes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resend QoS 1 and 2 publishes after resuming a session. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>Agent context for the MQTT connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if all publishes resent successfully, else error code from <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a1d8217e9d30fb2aed002060a8c97c63e">MQTT_Publish</a>. </dd></dl>

</div>
</div>
<a id="afb076dcf75919d5b638c33054b95461d" name="afb076dcf75919d5b638c33054b95461d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb076dcf75919d5b638c33054b95461d">&#9670;&nbsp;</a></span>clearPendingAcknowledgments()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void clearPendingAcknowledgments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clearOnlySubUnsubEntries</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clears the list of pending acknowledgments by invoking each callback with <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735caa14bc8aa4ad218702d782366945d43ac">MQTTRecvFailed</a> either for ALL operations in the list OR only for Subscribe/Unsubscribe operations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>Agent context of the MQTT connection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clearOnlySubUnsubEntries</td><td>Flag indicating whether all entries OR entries pertaining to only Subscribe/Unsubscribe operations should be cleaned from the list. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a77d4ec3f1e90897d6f173a2fcd7b9b61" name="a77d4ec3f1e90897d6f173a2fcd7b9b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77d4ec3f1e90897d6f173a2fcd7b9b61">&#9670;&nbsp;</a></span>validateStruct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool validateStruct </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validate an <a class="el" href="struct_m_q_t_t_agent_context__t.html" title="Information used by each MQTT agent. A context will be initialized by MQTTAgent_Init(),...">MQTTAgentContext_t</a> and a <a class="el" href="struct_m_q_t_t_agent_command_info__t.html" title="Struct holding arguments that are common to every command.">MQTTAgentCommandInfo_t</a> from API functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td><a class="el" href="struct_m_q_t_t_agent_context__t.html" title="Information used by each MQTT agent. A context will be initialized by MQTTAgent_Init(),...">MQTTAgentContext_t</a> to validate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandInfo</td><td><a class="el" href="struct_m_q_t_t_agent_command_info__t.html" title="Struct holding arguments that are common to every command.">MQTTAgentCommandInfo_t</a> to validate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if parameters are valid, else <code>false</code>. </dd></dl>

</div>
</div>
<a id="ac6b1b83accad3124122fed5c7ec14870" name="ac6b1b83accad3124122fed5c7ec14870"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6b1b83accad3124122fed5c7ec14870">&#9670;&nbsp;</a></span>validateParams()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool validateParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__agent__enum__types.html#ga76604fa58b7ee6c32ba084fda9379f33">MQTTAgentCommandType_t</a>&#160;</td>
          <td class="paramname"><em>commandType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>pParams</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validate the parameters for a CONNECT, SUBSCRIBE, UNSUBSCRIBE or PUBLISH. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">commandType</td><td>CONNECT, SUBSCRIBE, UNSUBSCRIBE, or PUBLISH. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pParams</td><td>Parameter structure to validate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if parameter structure is valid, else <code>false</code>. </dd></dl>

</div>
</div>
<a id="a6082ea8cf8fe3f34e0a8de08d6980a29" name="a6082ea8cf8fe3f34e0a8de08d6980a29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6082ea8cf8fe3f34e0a8de08d6980a29">&#9670;&nbsp;</a></span>isSpaceInPendingAckList()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool isSpaceInPendingAckList </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pAgentContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called before accepting any PUBLISH or SUBSCRIBE messages to check there is space in the pending ACK list for the outgoing PUBLISH or SUBSCRIBE. </p>
<dl class="section note"><dt>Note</dt><dd>Because the MQTT agent is inherently multi threaded, and this function is called from the context of the application task and not the MQTT agent task, this function can only return a best effort result. It can definitely say if there is space for a new pending ACK when the function is called, but the case of space being exhausted when the agent executes a command that results in an ACK must still be handled.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pAgentContext</td><td>Pointer to the context for the MQTT connection to which the PUBLISH or SUBSCRIBE message is to be sent.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if there is space in that MQTT connection's ACK list, otherwise false; </dd></dl>

</div>
</div>
<a id="a584863528e72229f35003485f7ee0edd" name="a584863528e72229f35003485f7ee0edd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584863528e72229f35003485f7ee0edd">&#9670;&nbsp;</a></span>MQTTAgent_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_message_interface__t.html">MQTTAgentMessageInterface_t</a> *&#160;</td>
          <td class="paramname"><em>pMsgInterface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_fixed_buffer__t.html">MQTTFixedBuffer_t</a> *&#160;</td>
          <td class="paramname"><em>pNetworkBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html">TransportInterface_t</a> *&#160;</td>
          <td class="paramname"><em>pTransportInterface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__callback__types.html#gae3bea55b0e49e5208b8c5709a5ea23aa">MQTTGetCurrentTimeFunc_t</a>&#160;</td>
          <td class="paramname"><em>getCurrentTimeMs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__agent__callback__types.html#gacdfb8687b1217d321e7cc58e365ec6a1">MQTTAgentIncomingPublishCallback_t</a>&#160;</td>
          <td class="paramname"><em>incomingCallback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pIncomingPacketContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform any initialization the MQTT agent requires before it can be used. Must be called before any other function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>Pointer to struct to initialize. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pMsgInterface</td><td>Command interface to use for allocating and sending commands. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pNetworkBuffer</td><td>Pointer to network buffer to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pTransportInterface</td><td>Transport interface to use with the MQTT library. See <a href="https://www.freertos.org/network-interface.html">https://www.freertos.org/network-interface.html</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">getCurrentTimeMs</td><td>Pointer to a function that returns a count value that increments every millisecond. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">incomingCallback</td><td>The callback to execute when receiving publishes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pIncomingPacketContext</td><td>A pointer to a context structure defined by the application writer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The <code>pIncomingPacketContext</code> context provided for the incoming publish callback MUST remain in scope throughout the period that the agent task is running.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Appropriate status code from <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#ae8444f3a85535e62cdb1ae9c192677d6">MQTT_Init()</a>.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Function for obtaining a timestamp.</span></div>
<div class="line">uint32_t getTimeStampMs();</div>
<div class="line"><span class="comment">// Callback function for receiving packets.</span></div>
<div class="line"><span class="keywordtype">void</span> incomingPublishCallback( <a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> * pMqttAgentContext,</div>
<div class="line">                              uint16_t packetId,</div>
<div class="line">                              <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html">MQTTPublishInfo_t</a> * pPublishInfo );</div>
<div class="line"><span class="comment">// Platform function for network send interface.</span></div>
<div class="line">int32_t networkSend( <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__struct__types.html#ga7769e434e7811caed8cd6fd7f9ec26ec">NetworkContext_t</a> * pContext, <span class="keyword">const</span> <span class="keywordtype">void</span> * pBuffer, <span class="keywordtype">size_t</span> bytes );</div>
<div class="line"><span class="comment">// Platform for network receive interface.</span></div>
<div class="line">int32_t networkRecv( <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__struct__types.html#ga7769e434e7811caed8cd6fd7f9ec26ec">NetworkContext_t</a> * pContext, <span class="keywordtype">void</span> * pBuffer, <span class="keywordtype">size_t</span> bytes );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Platform function for Agent Message Send.</span></div>
<div class="line"><span class="keywordtype">bool</span> agentSendMessage( <a class="code" href="group__mqtt__agent__struct__types.html#ga3c47f2ebcec2e1150e40d039639e5a3b">MQTTAgentMessageContext_t</a> * pMsgCtx,</div>
<div class="line">                       MQTTAgentCommand_t * <span class="keyword">const</span> * pCommandToSend,</div>
<div class="line">                       uint32_t blockTimeMs );</div>
<div class="line"><span class="comment">// Platform function for Agent Message Receive.</span></div>
<div class="line"><span class="keywordtype">bool</span> agentReceiveMessage( <a class="code" href="group__mqtt__agent__struct__types.html#ga3c47f2ebcec2e1150e40d039639e5a3b">MQTTAgentMessageContext_t</a> * pMsgCtx,</div>
<div class="line">                          MQTTAgentCommand_t ** pCommandToSend,</div>
<div class="line">                          uint32_t blockTimeMs );</div>
<div class="line"><span class="comment">// Platform function to Get Agent Command.</span></div>
<div class="line">MQTTAgentCommand_t * getCommand( uint32_t blockTimeMs );</div>
<div class="line"><span class="comment">// Platform function to Release Agent Command.</span></div>
<div class="line"><span class="keywordtype">bool</span> releaseCommand( MQTTAgentCommand_t * pCommandToRelease );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_message_interface__t.html">MQTTAgentMessageInterface_t</a> messageInterface;</div>
<div class="line"><a class="code" href="group__mqtt__agent__struct__types.html#ga3c47f2ebcec2e1150e40d039639e5a3b">MQTTAgentMessageContext_t</a> messageContext;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> agentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html">TransportInterface_t</a> transport;</div>
<div class="line"><span class="comment">// Buffer for storing outgoing and incoming MQTT packets.</span></div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_fixed_buffer__t.html">MQTTFixedBuffer_t</a> fixedBuffer;</div>
<div class="line">uint8_t buffer[ 1024 ];</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set transport interface members.</span></div>
<div class="line">transport.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html#aaf4702050bef8d62714a4d3900e95087">pNetworkContext</a> = &amp;someTransportContext;</div>
<div class="line">transport.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html#a01cd9935e9a5266ca196243a0054d489">send</a> = networkSend;</div>
<div class="line">transport.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html#a7c34e9b865e2a509306f09c7dfa3699e">recv</a> = networkRecv;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set agent message interface members.</span></div>
<div class="line">messageInterface.<a class="code" href="struct_m_q_t_t_agent_message_interface__t.html#a00cad3c3514a03d5deed20609ffdc94b">pMsgCtx</a> = &amp;messageContext;</div>
<div class="line">messageInterface.<a class="code" href="struct_m_q_t_t_agent_message_interface__t.html#abdc8e1c30aa27bf633f4f6e7da9a6465">send</a> = agentSendMessage;</div>
<div class="line">messageInterface.<a class="code" href="struct_m_q_t_t_agent_message_interface__t.html#a19e00e6431f53e595837d8ac7e4f744b">recv</a> = agentReceiveMessage;</div>
<div class="line">messageInterface.<a class="code" href="struct_m_q_t_t_agent_message_interface__t.html#aaa4d0614e8289d7ea12422e66c1e8689">getCommand</a> = getCommand;</div>
<div class="line">messageInterface.<a class="code" href="struct_m_q_t_t_agent_message_interface__t.html#ac809ba46da91df0fc4750ce515bf8f41">releaseCommand</a> = releaseCommand;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set buffer members.</span></div>
<div class="line">fixedBuffer.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_fixed_buffer__t.html#acea147448e044870fb36b7fa2347dbd6">pBuffer</a> = buffer;</div>
<div class="line">fixedBuffer.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_fixed_buffer__t.html#a0b0b6a93cc62751ebeb03095d5431636">size</a> = 1024;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#a584863528e72229f35003485f7ee0edd">MQTTAgent_Init</a>( &amp;agentContext,</div>
<div class="line">                         &amp;messageInterface,</div>
<div class="line">                         &amp;networkBuffer,</div>
<div class="line">                         &amp;transportInterface,</div>
<div class="line">                         stubGetTime,</div>
<div class="line">                         stubPublishCallback,</div>
<div class="line">                         incomingPacketContext );</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">   <span class="comment">// Do something with agentContext. The transport and message interfaces, and</span></div>
<div class="line">   <span class="comment">// fixedBuffer structs were copied into the context, so the original structs</span></div>
<div class="line">   <span class="comment">// do not need to stay in scope.</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_a584863528e72229f35003485f7ee0edd"><div class="ttname"><a href="core__mqtt__agent_8c.html#a584863528e72229f35003485f7ee0edd">MQTTAgent_Init</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_Init(MQTTAgentContext_t *pMqttAgentContext, const MQTTAgentMessageInterface_t *pMsgInterface, const MQTTFixedBuffer_t *pNetworkBuffer, const TransportInterface_t *pTransportInterface, MQTTGetCurrentTimeFunc_t getCurrentTimeMs, MQTTAgentIncomingPublishCallback_t incomingCallback, void *pIncomingPacketContext)</div><div class="ttdoc">Perform any initialization the MQTT agent requires before it can be used. Must be called before any o...</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:946</div></div>
<div class="ttc" id="agroup__mqtt__agent__struct__types_html_ga3c47f2ebcec2e1150e40d039639e5a3b"><div class="ttname"><a href="group__mqtt__agent__struct__types.html#ga3c47f2ebcec2e1150e40d039639e5a3b">MQTTAgentMessageContext_t</a></div><div class="ttdeci">struct MQTTAgentMessageContext MQTTAgentMessageContext_t</div><div class="ttdoc">Context with which tasks may deliver messages to the agent.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent_message_interface.h:48</div></div>
<div class="ttc" id="agroup__mqtt__enum__types_html_gaba7ec045874a1c3432f99173367f735c"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a></div><div class="ttdeci">MQTTStatus_t</div></div>
<div class="ttc" id="agroup__mqtt__enum__types_html_ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a></div><div class="ttdeci">MQTTSuccess</div></div>
<div class="ttc" id="agroup__mqtt__struct__types_html_ga7769e434e7811caed8cd6fd7f9ec26ec"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__struct__types.html#ga7769e434e7811caed8cd6fd7f9ec26ec">NetworkContext_t</a></div><div class="ttdeci">struct NetworkContext NetworkContext_t</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_context__t_html"><div class="ttname"><a href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a></div><div class="ttdoc">Information used by each MQTT agent. A context will be initialized by MQTTAgent_Init(),...</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:179</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_message_interface__t_html"><div class="ttname"><a href="struct_m_q_t_t_agent_message_interface__t.html">MQTTAgentMessageInterface_t</a></div><div class="ttdoc">Function pointers and contexts used for sending and receiving commands, and allocating memory for the...</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent_message_interface.h:127</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_message_interface__t_html_a00cad3c3514a03d5deed20609ffdc94b"><div class="ttname"><a href="struct_m_q_t_t_agent_message_interface__t.html#a00cad3c3514a03d5deed20609ffdc94b">MQTTAgentMessageInterface_t::pMsgCtx</a></div><div class="ttdeci">MQTTAgentMessageContext_t * pMsgCtx</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent_message_interface.h:128</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_message_interface__t_html_a19e00e6431f53e595837d8ac7e4f744b"><div class="ttname"><a href="struct_m_q_t_t_agent_message_interface__t.html#a19e00e6431f53e595837d8ac7e4f744b">MQTTAgentMessageInterface_t::recv</a></div><div class="ttdeci">MQTTAgentMessageRecv_t recv</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent_message_interface.h:130</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_message_interface__t_html_aaa4d0614e8289d7ea12422e66c1e8689"><div class="ttname"><a href="struct_m_q_t_t_agent_message_interface__t.html#aaa4d0614e8289d7ea12422e66c1e8689">MQTTAgentMessageInterface_t::getCommand</a></div><div class="ttdeci">MQTTAgentCommandGet_t getCommand</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent_message_interface.h:131</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_message_interface__t_html_abdc8e1c30aa27bf633f4f6e7da9a6465"><div class="ttname"><a href="struct_m_q_t_t_agent_message_interface__t.html#abdc8e1c30aa27bf633f4f6e7da9a6465">MQTTAgentMessageInterface_t::send</a></div><div class="ttdeci">MQTTAgentMessageSend_t send</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent_message_interface.h:129</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_message_interface__t_html_ac809ba46da91df0fc4750ce515bf8f41"><div class="ttname"><a href="struct_m_q_t_t_agent_message_interface__t.html#ac809ba46da91df0fc4750ce515bf8f41">MQTTAgentMessageInterface_t::releaseCommand</a></div><div class="ttdeci">MQTTAgentCommandRelease_t releaseCommand</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent_message_interface.h:132</div></div>
<div class="ttc" id="astruct_m_q_t_t_fixed_buffer__t_html"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_fixed_buffer__t.html">MQTTFixedBuffer_t</a></div></div>
<div class="ttc" id="astruct_m_q_t_t_fixed_buffer__t_html_a0b0b6a93cc62751ebeb03095d5431636"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_fixed_buffer__t.html#a0b0b6a93cc62751ebeb03095d5431636">MQTTFixedBuffer_t::size</a></div><div class="ttdeci">size_t size</div></div>
<div class="ttc" id="astruct_m_q_t_t_fixed_buffer__t_html_acea147448e044870fb36b7fa2347dbd6"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_fixed_buffer__t.html#acea147448e044870fb36b7fa2347dbd6">MQTTFixedBuffer_t::pBuffer</a></div><div class="ttdeci">uint8_t * pBuffer</div></div>
<div class="ttc" id="astruct_m_q_t_t_publish_info__t_html"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html">MQTTPublishInfo_t</a></div></div>
<div class="ttc" id="astruct_transport_interface__t_html"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html">TransportInterface_t</a></div></div>
<div class="ttc" id="astruct_transport_interface__t_html_a01cd9935e9a5266ca196243a0054d489"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html#a01cd9935e9a5266ca196243a0054d489">TransportInterface_t::send</a></div><div class="ttdeci">TransportSend_t send</div></div>
<div class="ttc" id="astruct_transport_interface__t_html_a7c34e9b865e2a509306f09c7dfa3699e"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html#a7c34e9b865e2a509306f09c7dfa3699e">TransportInterface_t::recv</a></div><div class="ttdeci">TransportRecv_t recv</div></div>
<div class="ttc" id="astruct_transport_interface__t_html_aaf4702050bef8d62714a4d3900e95087"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html#aaf4702050bef8d62714a4d3900e95087">TransportInterface_t::pNetworkContext</a></div><div class="ttdeci">NetworkContext_t * pNetworkContext</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a9dafeb1701b1a0ee897b626a09cfcff7" name="a9dafeb1701b1a0ee897b626a09cfcff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dafeb1701b1a0ee897b626a09cfcff7">&#9670;&nbsp;</a></span>MQTTAgent_CommandLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_CommandLoop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process commands from the command queue in a loop. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>appropriate error code, or <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> from a successful disconnect or termination.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> mqttAgentContext;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#a9dafeb1701b1a0ee897b626a09cfcff7">MQTTAgent_CommandLoop</a>( &amp;mqttAgentContext );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The function returns on either receiving a terminate command,</span></div>
<div class="line"><span class="comment">// undergoing network disconnection OR encountering an error.</span></div>
<div class="line"><span class="keywordflow">if</span>( ( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> ) &amp;&amp; ( mqttAgentContext.<a class="code" href="struct_m_q_t_t_agent_context__t.html#aec01b2b61213956dc2219f620964a055">mqttContext</a>.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html#a4e38c4dc77e7751a0ad8730a41bee47f">connectStatus</a> == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gga9f84d003695205cf10a7bd0bafb3dbf6a0320177ebf1f1b2e24646b44702cec69">MQTTNotConnected</a> ) )</div>
<div class="line">{</div>
<div class="line">   <span class="comment">// A terminate command was processed and MQTT connection was closed.</span></div>
<div class="line">   <span class="comment">// Need to close socket connection.</span></div>
<div class="line">   Platform_DisconnectNetwork( mqttAgentContext.<a class="code" href="struct_m_q_t_t_agent_context__t.html#aec01b2b61213956dc2219f620964a055">mqttContext</a>.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html#a87ab9d61e7711325c2c85ce3ce63386a">transportInterface</a>.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html#aaf4702050bef8d62714a4d3900e95087">pNetworkContext</a> );</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">   <span class="comment">// Terminate command was processed but MQTT connection was not</span></div>
<div class="line">   <span class="comment">// closed. Thus, need to close both MQTT and socket connections.</span></div>
<div class="line">   status = <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8c.html#ac79c366acbc3dddd88072d99ccb9140c">MQTT_Disconnect</a>( &amp;( mqttAgentContext.<a class="code" href="struct_m_q_t_t_agent_context__t.html#aec01b2b61213956dc2219f620964a055">mqttContext</a> ) );</div>
<div class="line">   assert( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> );</div>
<div class="line">   Platform_DisconnectNetwork( mqttAgentContext.<a class="code" href="struct_m_q_t_t_agent_context__t.html#aec01b2b61213956dc2219f620964a055">mqttContext</a>.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html#a87ab9d61e7711325c2c85ce3ce63386a">transportInterface</a>.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html#aaf4702050bef8d62714a4d3900e95087">pNetworkContext</a> );</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error.</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt_8c_html_ac79c366acbc3dddd88072d99ccb9140c"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8c.html#ac79c366acbc3dddd88072d99ccb9140c">MQTT_Disconnect</a></div><div class="ttdeci">MQTTStatus_t MQTT_Disconnect(MQTTContext_t *pContext)</div></div>
<div class="ttc" id="acore__mqtt__agent_8c_html_a9dafeb1701b1a0ee897b626a09cfcff7"><div class="ttname"><a href="core__mqtt__agent_8c.html#a9dafeb1701b1a0ee897b626a09cfcff7">MQTTAgent_CommandLoop</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_CommandLoop(MQTTAgentContext_t *pMqttAgentContext)</div><div class="ttdoc">Process commands from the command queue in a loop.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:996</div></div>
<div class="ttc" id="agroup__mqtt__enum__types_html_gga9f84d003695205cf10a7bd0bafb3dbf6a0320177ebf1f1b2e24646b44702cec69"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gga9f84d003695205cf10a7bd0bafb3dbf6a0320177ebf1f1b2e24646b44702cec69">MQTTNotConnected</a></div><div class="ttdeci">MQTTNotConnected</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_context__t_html_aec01b2b61213956dc2219f620964a055"><div class="ttname"><a href="struct_m_q_t_t_agent_context__t.html#aec01b2b61213956dc2219f620964a055">MQTTAgentContext_t::mqttContext</a></div><div class="ttdeci">MQTTContext_t mqttContext</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:180</div></div>
<div class="ttc" id="astruct_m_q_t_t_context__t_html_a4e38c4dc77e7751a0ad8730a41bee47f"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html#a4e38c4dc77e7751a0ad8730a41bee47f">MQTTContext_t::connectStatus</a></div><div class="ttdeci">MQTTConnectionStatus_t connectStatus</div></div>
<div class="ttc" id="astruct_m_q_t_t_context__t_html_a87ab9d61e7711325c2c85ce3ce63386a"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html#a87ab9d61e7711325c2c85ce3ce63386a">MQTTContext_t::transportInterface</a></div><div class="ttdeci">TransportInterface_t transportInterface</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a75065d6bff5f2d32831f2c74922296fb" name="a75065d6bff5f2d32831f2c74922296fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75065d6bff5f2d32831f2c74922296fb">&#9670;&nbsp;</a></span>MQTTAgent_ResumeSession()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_ResumeSession </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sessionPresent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resume a session by resending publishes if a session is present in the broker, or clear state information if not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sessionPresent</td><td>The session present flag from the broker.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function is NOT thread-safe and should only be called from the context of the task responsible for <a class="el" href="core__mqtt__agent_8h.html#a9dafeb1701b1a0ee897b626a09cfcff7" title="Process commands from the command queue in a loop.">MQTTAgent_CommandLoop</a>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if it succeeds in resending publishes, else an appropriate error code from <code><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a1d8217e9d30fb2aed002060a8c97c63e">MQTT_Publish()</a></code></dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> mqttAgentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html">MQTTConnectInfo_t</a> connectInfo = { 0 };</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html">MQTTPublishInfo_t</a> willInfo = { 0 };</div>
<div class="line"><span class="keywordtype">bool</span> sessionPresent;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The example assumes that all variables have been filled with</span></div>
<div class="line"><span class="comment">// data for the MQTT_Connect call</span></div>
<div class="line"><span class="comment">// Refer to the MQTT_Connect API for a more detailed example.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Attempt to resume session with the broker.</span></div>
<div class="line">status = <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8c.html#aed1e4dc123a8ba79ac569cb17c69bfa0">MQTT_Connect</a>( &amp;( mqttAgentContext.<a class="code" href="struct_m_q_t_t_agent_context__t.html#aec01b2b61213956dc2219f620964a055">mqttContext</a> ), &amp;connectInfo, &amp;willInfo, 100, &amp;sessionPresent )</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Process the session present status sent by the broker.</span></div>
<div class="line">    status = <a class="code" href="core__mqtt__agent_8c.html#a75065d6bff5f2d32831f2c74922296fb">MQTTAgent_ResumeSession</a>( &amp;mqttAgentContext, sessionPresent );</div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt_8c_html_aed1e4dc123a8ba79ac569cb17c69bfa0"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8c.html#aed1e4dc123a8ba79ac569cb17c69bfa0">MQTT_Connect</a></div><div class="ttdeci">MQTTStatus_t MQTT_Connect(MQTTContext_t *pContext, const MQTTConnectInfo_t *pConnectInfo, const MQTTPublishInfo_t *pWillInfo, uint32_t timeoutMs, bool *pSessionPresent)</div></div>
<div class="ttc" id="acore__mqtt__agent_8c_html_a75065d6bff5f2d32831f2c74922296fb"><div class="ttname"><a href="core__mqtt__agent_8c.html#a75065d6bff5f2d32831f2c74922296fb">MQTTAgent_ResumeSession</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_ResumeSession(MQTTAgentContext_t *pMqttAgentContext, bool sessionPresent)</div><div class="ttdoc">Resume a session by resending publishes if a session is present in the broker, or clear state informa...</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1038</div></div>
<div class="ttc" id="astruct_m_q_t_t_connect_info__t_html"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html">MQTTConnectInfo_t</a></div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a0362d7d3d68628413f01b32ec2ff4ab6" name="a0362d7d3d68628413f01b32ec2ff4ab6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0362d7d3d68628413f01b32ec2ff4ab6">&#9670;&nbsp;</a></span>MQTTAgent_CancelAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_CancelAll </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel all enqueued commands and those awaiting acknowledgment while the command loop is not running. </p>
<p >Canceled commands will be terminated with return code <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735caa14bc8aa4ad218702d782366945d43ac">MQTTRecvFailed</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function is NOT thread-safe and should only be called from the context of the task responsible for <a class="el" href="core__mqtt__agent_8h.html#a9dafeb1701b1a0ee897b626a09cfcff7" title="Process commands from the command queue in a loop.">MQTTAgent_CommandLoop</a>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735caa39030c93b0263b2699502a074f003b5">MQTTBadParameter</a> if an invalid context is given, else <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a>.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> mqttAgentContext;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#a9dafeb1701b1a0ee897b626a09cfcff7">MQTTAgent_CommandLoop</a>( &amp;mqttAgentContext );</div>
<div class="line"> </div>
<div class="line"><span class="comment">//An error was returned, but reconnection is not desired. Cancel all commands</span></div>
<div class="line"><span class="comment">//that are in the queue or awaiting an acknowledgment.</span></div>
<div class="line"><span class="keywordflow">if</span>( status != <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">   <span class="comment">//Cancel commands so any completion callbacks will be invoked.</span></div>
<div class="line">   status = <a class="code" href="core__mqtt__agent_8c.html#a0362d7d3d68628413f01b32ec2ff4ab6">MQTTAgent_CancelAll</a>( &amp;mqttAgentContext );</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">Platform_DisconnectNetwork( mqttAgentContext.<a class="code" href="struct_m_q_t_t_agent_context__t.html#aec01b2b61213956dc2219f620964a055">mqttContext</a>.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_context__t.html#a87ab9d61e7711325c2c85ce3ce63386a">transportInterface</a>.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_transport_interface__t.html#aaf4702050bef8d62714a4d3900e95087">pNetworkContext</a> );</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_a0362d7d3d68628413f01b32ec2ff4ab6"><div class="ttname"><a href="core__mqtt__agent_8c.html#a0362d7d3d68628413f01b32ec2ff4ab6">MQTTAgent_CancelAll</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_CancelAll(MQTTAgentContext_t *pMqttAgentContext)</div><div class="ttdoc">Cancel all enqueued commands and those awaiting acknowledgment while the command loop is not running.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1081</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a651cf10182392ecea5e8609af8855d49" name="a651cf10182392ecea5e8609af8855d49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a651cf10182392ecea5e8609af8855d49">&#9670;&nbsp;</a></span>MQTTAgent_Subscribe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_Subscribe </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_subscribe_args__t.html">MQTTAgentSubscribeArgs_t</a> *&#160;</td>
          <td class="paramname"><em>pSubscriptionArgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a567aa9c38726a7879f9cbf943e813e8f">MQTT_Subscribe()</a> for an MQTT connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSubscriptionArgs</td><td>Struct describing topic to subscribe to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandInfo</td><td>The information pertaining to the command, including:<ul>
<li>cmdCompleteCallback Optional callback to invoke when the command completes.</li>
<li>pCmdCompleteCallbackContext Optional completion callback context.</li>
<li>blockTimeMs The maximum amount of time in milliseconds to wait for the command to be posted to the MQTT agent, should the agent's event queue be full. Tasks wait in the Blocked state so don't use any CPU time.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The context passed to the callback through pCmdContext member of <code>pCommandInfo</code> parameter MUST remain in scope at least until the callback has been executed by the agent task.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was posted to the MQTT agent's event queue. Otherwise an enumerated error code.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> agentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> commandInfo = { 0 };</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html">MQTTSubscribeInfo_t</a> subscribeInfo = { 0 };</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_subscribe_args__t.html">MQTTAgentSubscribeArgs_t</a> subscribeArgs = { 0 };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Function for command complete callback.</span></div>
<div class="line"><span class="keywordtype">void</span> subscribeCmdCompleteCb( <a class="code" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> * pCmdCallbackContext,</div>
<div class="line">                             <a class="code" href="struct_m_q_t_t_agent_return_info__t.html">MQTTAgentReturnInfo_t</a> * pReturnInfo );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the command information.</span></div>
<div class="line">commandInfo.CmdCompleteCallback = subscribeCmdCompleteCb;</div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#aa0f490187c1199c2d31d4c04a01d4637">blockTimeMs</a> = 500;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the information for topic filters to subscribe to.</span></div>
<div class="line">subscribeInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html#a64cf2e423f60cfec122eeaef80c0fd86">qos</a> = Qos1;</div>
<div class="line">subscribeInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html#adb0b28240fdcd82a85f11cf2f8b5bbf0">pTopicFilter</a> = <span class="stringliteral">&quot;/foo/bar&quot;</span>;</div>
<div class="line">subscribeInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html#a6972f8e036f8bde9b1f23a2aacb61382">topicFilterLength</a> = strlen(<span class="stringliteral">&quot;/foo/bar&quot;</span>);</div>
<div class="line">subscribeArgs.<a class="code" href="struct_m_q_t_t_agent_subscribe_args__t.html#a27e21bfcf0184a4a168a6170a60fc026">pSubscribeInfo</a> = &amp;subscribeInfo;</div>
<div class="line">subscribeArgs.<a class="code" href="struct_m_q_t_t_agent_subscribe_args__t.html#ae30aaa33e7a0e67a5989c2d15170de95">numSubscriptions</a> = 1U;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#a651cf10182392ecea5e8609af8855d49">MQTTAgent_Subscribe</a>( &amp;agentContext, &amp;subscribeArgs, &amp;commandInfo );</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Command to send subscribe request to the server has been queued. Notification</span></div>
<div class="line">  <span class="comment">// about completion of the subscribe operation will be notified to application</span></div>
<div class="line">  <span class="comment">// through invocation of subscribeCmdCompleteCb().</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_a651cf10182392ecea5e8609af8855d49"><div class="ttname"><a href="core__mqtt__agent_8c.html#a651cf10182392ecea5e8609af8855d49">MQTTAgent_Subscribe</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_Subscribe(const MQTTAgentContext_t *pMqttAgentContext, MQTTAgentSubscribeArgs_t *pSubscriptionArgs, const MQTTAgentCommandInfo_t *pCommandInfo)</div><div class="ttdoc">Add a command to call MQTT_Subscribe() for an MQTT connection.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1130</div></div>
<div class="ttc" id="agroup__mqtt__agent__struct__types_html_ga953da1618097a29381f3fc38f576055c"><div class="ttname"><a href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a></div><div class="ttdeci">struct MQTTAgentCommandContext MQTTAgentCommandContext_t</div><div class="ttdoc">Struct containing context for a specific command.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:109</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_command_info__t_html"><div class="ttname"><a href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a></div><div class="ttdoc">Struct holding arguments that are common to every command.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:215</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_command_info__t_html_aa0f490187c1199c2d31d4c04a01d4637"><div class="ttname"><a href="struct_m_q_t_t_agent_command_info__t.html#aa0f490187c1199c2d31d4c04a01d4637">MQTTAgentCommandInfo_t::blockTimeMs</a></div><div class="ttdeci">uint32_t blockTimeMs</div><div class="ttdoc">Maximum block time for enqueueing the command.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:218</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_return_info__t_html"><div class="ttname"><a href="struct_m_q_t_t_agent_return_info__t.html">MQTTAgentReturnInfo_t</a></div><div class="ttdoc">Struct holding return codes and outputs from a command.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:97</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_subscribe_args__t_html"><div class="ttname"><a href="struct_m_q_t_t_agent_subscribe_args__t.html">MQTTAgentSubscribeArgs_t</a></div><div class="ttdoc">Struct holding arguments for a SUBSCRIBE or UNSUBSCRIBE call.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:193</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_subscribe_args__t_html_a27e21bfcf0184a4a168a6170a60fc026"><div class="ttname"><a href="struct_m_q_t_t_agent_subscribe_args__t.html#a27e21bfcf0184a4a168a6170a60fc026">MQTTAgentSubscribeArgs_t::pSubscribeInfo</a></div><div class="ttdeci">MQTTSubscribeInfo_t * pSubscribeInfo</div><div class="ttdoc">List of MQTT subscriptions.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:194</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_subscribe_args__t_html_ae30aaa33e7a0e67a5989c2d15170de95"><div class="ttname"><a href="struct_m_q_t_t_agent_subscribe_args__t.html#ae30aaa33e7a0e67a5989c2d15170de95">MQTTAgentSubscribeArgs_t::numSubscriptions</a></div><div class="ttdeci">size_t numSubscriptions</div><div class="ttdoc">Number of elements in pSubscribeInfo.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:195</div></div>
<div class="ttc" id="astruct_m_q_t_t_subscribe_info__t_html"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html">MQTTSubscribeInfo_t</a></div></div>
<div class="ttc" id="astruct_m_q_t_t_subscribe_info__t_html_a64cf2e423f60cfec122eeaef80c0fd86"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html#a64cf2e423f60cfec122eeaef80c0fd86">MQTTSubscribeInfo_t::qos</a></div><div class="ttdeci">MQTTQoS_t qos</div></div>
<div class="ttc" id="astruct_m_q_t_t_subscribe_info__t_html_a6972f8e036f8bde9b1f23a2aacb61382"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html#a6972f8e036f8bde9b1f23a2aacb61382">MQTTSubscribeInfo_t::topicFilterLength</a></div><div class="ttdeci">uint16_t topicFilterLength</div></div>
<div class="ttc" id="astruct_m_q_t_t_subscribe_info__t_html_adb0b28240fdcd82a85f11cf2f8b5bbf0"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html#adb0b28240fdcd82a85f11cf2f8b5bbf0">MQTTSubscribeInfo_t::pTopicFilter</a></div><div class="ttdeci">const char * pTopicFilter</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="ac3f70c81c8f8947dfb7346045c8edb63" name="ac3f70c81c8f8947dfb7346045c8edb63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3f70c81c8f8947dfb7346045c8edb63">&#9670;&nbsp;</a></span>MQTTAgent_Unsubscribe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_Unsubscribe </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_subscribe_args__t.html">MQTTAgentSubscribeArgs_t</a> *&#160;</td>
          <td class="paramname"><em>pSubscriptionArgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a77c911dbe24c5a51aaea88250895dba4">MQTT_Unsubscribe()</a> for an MQTT connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSubscriptionArgs</td><td>List of topics to unsubscribe from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandInfo</td><td>The information pertaining to the command, including:<ul>
<li>cmdCompleteCallback Optional callback to invoke when the command completes.</li>
<li>pCmdCompleteCallbackContext Optional completion callback context.</li>
<li>blockTimeMs The maximum amount of time in milliseconds to wait for the command to be posted to the MQTT agent, should the agent's event queue be full. Tasks wait in the Blocked state so don't use any CPU time.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The context passed to the callback through pCmdContext member of <code>pCommandInfo</code> parameter MUST remain in scope at least until the callback has been executed by the agent task.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was posted to the MQTT agent's event queue. Otherwise an enumerated error code.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> agentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> commandInfo = { 0 };</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html">MQTTSubscribeInfo_t</a> unsubscribeInfo = { 0 };</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_subscribe_args__t.html">MQTTAgentSubscribeArgs_t</a> unsubscribeArgs = { 0 };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Function for command complete callback.</span></div>
<div class="line"><span class="keywordtype">void</span> unsubscribeCmdCompleteCb( <a class="code" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> * pCmdCallbackContext,</div>
<div class="line">                               <a class="code" href="struct_m_q_t_t_agent_return_info__t.html">MQTTAgentReturnInfo_t</a> * pReturnInfo );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the command information.</span></div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#a4c9e9b55c7b576a390f734238b60f3aa">cmdCompleteCallback</a> = unsubscribeCmdCompleteCb;</div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#aa0f490187c1199c2d31d4c04a01d4637">blockTimeMs</a> = 500;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the information for topics to unsubscribe from.</span></div>
<div class="line">unsubscribeInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html#adb0b28240fdcd82a85f11cf2f8b5bbf0">pTopicFilter</a> = <span class="stringliteral">&quot;/foo/bar&quot;</span>;</div>
<div class="line">unsubscribeInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_subscribe_info__t.html#a6972f8e036f8bde9b1f23a2aacb61382">topicFilterLength</a> = strlen(<span class="stringliteral">&quot;/foo/bar&quot;</span>);</div>
<div class="line">unsubscribeArgs.<a class="code" href="struct_m_q_t_t_agent_subscribe_args__t.html#a27e21bfcf0184a4a168a6170a60fc026">pSubscribeInfo</a> = &amp;unsubscribeInfo;</div>
<div class="line">unsubscribeArgs.<a class="code" href="struct_m_q_t_t_agent_subscribe_args__t.html#ae30aaa33e7a0e67a5989c2d15170de95">numSubscriptions</a> = 1U;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#ac3f70c81c8f8947dfb7346045c8edb63">MQTTAgent_Unsubscribe</a>( &amp;agentContext, &amp;unsubscribeArgs, &amp;commandInfo );</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Command to send Unsubscribe request to the server has been queued. Notification</span></div>
<div class="line">  <span class="comment">// about completion of the Unsubscribe operation will be notified to application</span></div>
<div class="line">  <span class="comment">// through invocation of unsubscribeCompleteCb().</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_ac3f70c81c8f8947dfb7346045c8edb63"><div class="ttname"><a href="core__mqtt__agent_8c.html#ac3f70c81c8f8947dfb7346045c8edb63">MQTTAgent_Unsubscribe</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_Unsubscribe(const MQTTAgentContext_t *pMqttAgentContext, MQTTAgentSubscribeArgs_t *pSubscriptionArgs, const MQTTAgentCommandInfo_t *pCommandInfo)</div><div class="ttdoc">Add a command to call MQTT_Unsubscribe() for an MQTT connection.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1155</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_command_info__t_html_a4c9e9b55c7b576a390f734238b60f3aa"><div class="ttname"><a href="struct_m_q_t_t_agent_command_info__t.html#a4c9e9b55c7b576a390f734238b60f3aa">MQTTAgentCommandInfo_t::cmdCompleteCallback</a></div><div class="ttdeci">MQTTAgentCommandCallback_t cmdCompleteCallback</div><div class="ttdoc">Callback to invoke upon completion.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:216</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="afea2405ab859324cb241ea47e6a5ab81" name="afea2405ab859324cb241ea47e6a5ab81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea2405ab859324cb241ea47e6a5ab81">&#9670;&nbsp;</a></span>MQTTAgent_Publish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_Publish </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html">MQTTPublishInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pPublishInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a1d8217e9d30fb2aed002060a8c97c63e">MQTT_Publish()</a> for an MQTT connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pPublishInfo</td><td>MQTT PUBLISH information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandInfo</td><td>The information pertaining to the command, including:<ul>
<li>cmdCompleteCallback Optional callback to invoke when the command completes.</li>
<li>pCmdCompleteCallbackContext Optional completion callback context.</li>
<li>blockTimeMs The maximum amount of time in milliseconds to wait for the command to be posted to the MQTT agent, should the agent's event queue be full. Tasks wait in the Blocked state so don't use any CPU time.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The context passed to the callback through pCmdContext member of <code>pCommandInfo</code> parameter MUST remain in scope at least until the callback has been executed by the agent task.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was posted to the MQTT agent's event queue. Otherwise an enumerated error code.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> agentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> commandInfo = { 0 };</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html">MQTTPublishInfo_t</a> publishInfo = { 0 };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Function for command complete callback.</span></div>
<div class="line"><span class="keywordtype">void</span> publishCmdCompleteCb( <a class="code" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> * pCmdCallbackContext,</div>
<div class="line">                           <a class="code" href="struct_m_q_t_t_agent_return_info__t.html">MQTTAgentReturnInfo_t</a> * pReturnInfo );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the command information.</span></div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#a4c9e9b55c7b576a390f734238b60f3aa">cmdCompleteCallback</a> = publishCmdCompleteCb;</div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#aa0f490187c1199c2d31d4c04a01d4637">blockTimeMs</a> = 500;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the information for publish operation.</span></div>
<div class="line">publishInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#a178224d02b4acdec7e08e88de0e4b399">qos</a> = <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggae308a5928d7f537379c29a894228093aa019d0b8a8cfadb6f98462b046bdacbb2">MQTTQoS1</a>;</div>
<div class="line">publishInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#aa80e8ca282d01630f878ad0afe81d7a4">pTopicName</a> = <span class="stringliteral">&quot;/some/topic/name&quot;</span>;</div>
<div class="line">publishInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#a6161c792d20cc7cf8284c1b71ea1145f">topicNameLength</a> = strlen( publishInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#aa80e8ca282d01630f878ad0afe81d7a4">pTopicName</a> );</div>
<div class="line">publishInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#afc28299f4f625f5e674bb61b42f03380">pPayload</a> = <span class="stringliteral">&quot;Hello World!&quot;</span>;</div>
<div class="line">publishInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#a7997964e11571f35f0c3b729db0f760f">payloadLength</a> = strlen( <span class="stringliteral">&quot;Hello World!&quot;</span> );</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#afea2405ab859324cb241ea47e6a5ab81">MQTTAgent_Publish</a>( &amp;agentContext, &amp;publishInfo, &amp;commandInfo );</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">   <span class="comment">// Command to publish message to broker has been queued.</span></div>
<div class="line">   <span class="comment">// The event of publish operation completion will be notified with</span></div>
<div class="line">   <span class="comment">// the invocation of the publishCmdCompleteCb().</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_afea2405ab859324cb241ea47e6a5ab81"><div class="ttname"><a href="core__mqtt__agent_8c.html#afea2405ab859324cb241ea47e6a5ab81">MQTTAgent_Publish</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_Publish(const MQTTAgentContext_t *pMqttAgentContext, MQTTPublishInfo_t *pPublishInfo, const MQTTAgentCommandInfo_t *pCommandInfo)</div><div class="ttdoc">Add a command to call MQTT_Publish() for an MQTT connection.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1180</div></div>
<div class="ttc" id="agroup__mqtt__enum__types_html_ggae308a5928d7f537379c29a894228093aa019d0b8a8cfadb6f98462b046bdacbb2"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggae308a5928d7f537379c29a894228093aa019d0b8a8cfadb6f98462b046bdacbb2">MQTTQoS1</a></div><div class="ttdeci">MQTTQoS1</div></div>
<div class="ttc" id="astruct_m_q_t_t_publish_info__t_html_a178224d02b4acdec7e08e88de0e4b399"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#a178224d02b4acdec7e08e88de0e4b399">MQTTPublishInfo_t::qos</a></div><div class="ttdeci">MQTTQoS_t qos</div></div>
<div class="ttc" id="astruct_m_q_t_t_publish_info__t_html_a6161c792d20cc7cf8284c1b71ea1145f"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#a6161c792d20cc7cf8284c1b71ea1145f">MQTTPublishInfo_t::topicNameLength</a></div><div class="ttdeci">uint16_t topicNameLength</div></div>
<div class="ttc" id="astruct_m_q_t_t_publish_info__t_html_a7997964e11571f35f0c3b729db0f760f"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#a7997964e11571f35f0c3b729db0f760f">MQTTPublishInfo_t::payloadLength</a></div><div class="ttdeci">size_t payloadLength</div></div>
<div class="ttc" id="astruct_m_q_t_t_publish_info__t_html_aa80e8ca282d01630f878ad0afe81d7a4"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#aa80e8ca282d01630f878ad0afe81d7a4">MQTTPublishInfo_t::pTopicName</a></div><div class="ttdeci">const char * pTopicName</div></div>
<div class="ttc" id="astruct_m_q_t_t_publish_info__t_html_afc28299f4f625f5e674bb61b42f03380"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#afc28299f4f625f5e674bb61b42f03380">MQTTPublishInfo_t::pPayload</a></div><div class="ttdeci">const void * pPayload</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="aa14c9c86e036d0b1f5c04a538597cc46" name="aa14c9c86e036d0b1f5c04a538597cc46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa14c9c86e036d0b1f5c04a538597cc46">&#9670;&nbsp;</a></span>MQTTAgent_ProcessLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_ProcessLoop </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a message to the MQTT agent purely to trigger an iteration of its loop, which will result in a call to <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#adce9111350db412c1256689ef9a7b9f4">MQTT_ProcessLoop()</a>. This function can be used to wake the MQTT agent task when it is known data may be available on the connected socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandInfo</td><td>The information pertaining to the command, including:<ul>
<li>cmdCompleteCallback Optional callback to invoke when the command completes.</li>
<li>pCmdCompleteCallbackContext Optional completion callback context.</li>
<li>blockTimeMs The maximum amount of time in milliseconds to wait for the command to be posted to the MQTT agent, should the agent's event queue be full. Tasks wait in the Blocked state so don't use any CPU time.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was posted to the MQTT agent's event queue. Otherwise an enumerated error code.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> agentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> commandInfo = { 0 };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Function for command complete callback.</span></div>
<div class="line"><span class="keywordtype">void</span> cmdCompleteCb( <a class="code" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> * pCmdCallbackContext,</div>
<div class="line">                    <a class="code" href="struct_m_q_t_t_agent_return_info__t.html">MQTTAgentReturnInfo_t</a> * pReturnInfo );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the command information.</span></div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#a4c9e9b55c7b576a390f734238b60f3aa">cmdCompleteCallback</a> = cmdCompleteCb;</div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#aa0f490187c1199c2d31d4c04a01d4637">blockTimeMs</a> = 500;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#aa14c9c86e036d0b1f5c04a538597cc46">MQTTAgent_ProcessLoop</a>( &amp;agentContext, &amp;commandInfo );</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">   <span class="comment">// Command to call MQTT_ProcessLoop() has been queued.</span></div>
<div class="line">   <span class="comment">// After processing the command, if an incoming publish is received,</span></div>
<div class="line">   <span class="comment">// the event will be notified with invocation of the incoming publish</span></div>
<div class="line">   <span class="comment">// callback configured in the agent context.</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_aa14c9c86e036d0b1f5c04a538597cc46"><div class="ttname"><a href="core__mqtt__agent_8c.html#aa14c9c86e036d0b1f5c04a538597cc46">MQTTAgent_ProcessLoop</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_ProcessLoop(const MQTTAgentContext_t *pMqttAgentContext, const MQTTAgentCommandInfo_t *pCommandInfo)</div><div class="ttdoc">Send a message to the MQTT agent purely to trigger an iteration of its loop, which will result in a c...</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1205</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a782425e50d258837d23e379471254412" name="a782425e50d258837d23e379471254412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a782425e50d258837d23e379471254412">&#9670;&nbsp;</a></span>MQTTAgent_Connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_Connect </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_m_q_t_t_agent_connect_args__t.html">MQTTAgentConnectArgs_t</a> *&#160;</td>
          <td class="paramname"><em>pConnectArgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#aed1e4dc123a8ba79ac569cb17c69bfa0">MQTT_Connect()</a> for an MQTT connection. If a session is resumed with the broker, it will also resend the necessary QoS1/2 publishes. </p>
<dl class="section note"><dt>Note</dt><dd>The MQTTAgent_Connect function is provided to give a thread safe equivalent to the MQTT_Connect API. However, it is RECOMMENDED that instead of the application tasks (i.e. tasks other than the agent task), the agent be responsible for creating the MQTT connection (by calling MQTT_Connect) before starting the command loop (with the <a class="el" href="core__mqtt__agent_8h.html#a9dafeb1701b1a0ee897b626a09cfcff7" title="Process commands from the command queue in a loop.">MQTTAgent_CommandLoop()</a> call). In that case, the agent SHOULD also be responsible for disconnecting the MQTT connection after the command loop has terminated (through an <a class="el" href="core__mqtt__agent_8h.html#ae1b19c10831f72251603b045f2608313" title="Add a termination command to the command queue.">MQTTAgent_Terminate()</a> call from an application task).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pConnectArgs</td><td>Struct holding args for <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#aed1e4dc123a8ba79ac569cb17c69bfa0">MQTT_Connect()</a>. On a successful connection after the command is processed, the sessionPresent member will be filled to indicate whether the broker resumed an existing session. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandInfo</td><td>The information pertaining to the command, including:<ul>
<li>cmdCompleteCallback Optional callback to invoke when the command completes.</li>
<li>pCmdCompleteCallbackContext Optional completion callback context.</li>
<li>blockTimeMs The maximum amount of time in milliseconds to wait for the command to be posted to the MQTT agent, should the agent's event queue be full. Tasks wait in the Blocked state so don't use any CPU time.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The context passed to the callback through pCmdContext member of <code>pCommandInfo</code> parameter MUST remain in scope at least until the callback has been executed by the agent task.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was posted to the MQTT agent's event queue. Otherwise an enumerated error code.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> agentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html">MQTTConnectInfo_t</a> connectInfo = { 0 };</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html">MQTTPublishInfo_t</a> willInfo = { 0 };</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_connect_args__t.html">MQTTAgentConnectArgs_t</a> connectionArgs;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> commandInfo = { 0 };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// True for creating a new session with broker, false if we want to resume an old one.</span></div>
<div class="line">connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a606e7765c4f2215fb2bf630f6eb9ff6b">cleanSession</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="comment">// Client ID must be unique to broker. This field is required.</span></div>
<div class="line">connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a010f8f6993cbf8899648d5c515ff7884">pClientIdentifier</a> = <span class="stringliteral">&quot;someClientID&quot;</span>;</div>
<div class="line">connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a8077ef36ab318f3d35bee6f098fa54d4">clientIdentifierLength</a> = strlen( connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a010f8f6993cbf8899648d5c515ff7884">pClientIdentifier</a> );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Value for keep alive.</span></div>
<div class="line">connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a7d05d53261732ebdfbb9ee665a347591">keepAliveSeconds</a> = 60;</div>
<div class="line"><span class="comment">// The following fields are optional.</span></div>
<div class="line"><span class="comment">// Optional username and password.</span></div>
<div class="line">connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a1118d7d3251a11445318557280db53b4">pUserName</a> = <span class="stringliteral">&quot;someUserName&quot;</span>;</div>
<div class="line">connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a7165be3bb06d4527ab4eb773b50e05e1">userNameLength</a> = strlen( connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a1118d7d3251a11445318557280db53b4">pUserName</a> );</div>
<div class="line">connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#acec6c79a11d2f0f130802393f34d2b5e">pPassword</a> = <span class="stringliteral">&quot;somePassword&quot;</span>;</div>
<div class="line">connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a818c4e212a12020a4109eb890ec96383">passwordLength</a> = strlen( connectInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#acec6c79a11d2f0f130802393f34d2b5e">pPassword</a> );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The last will and testament is optional, it will be published by the broker</span></div>
<div class="line"><span class="comment">// should this client disconnect without sending a DISCONNECT packet.</span></div>
<div class="line">willInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#a178224d02b4acdec7e08e88de0e4b399">qos</a> = <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggae308a5928d7f537379c29a894228093aaad51b23a1ae1417f96d8f343c788d1d2">MQTTQoS0</a>;</div>
<div class="line">willInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#aa80e8ca282d01630f878ad0afe81d7a4">pTopicName</a> = <span class="stringliteral">&quot;/lwt/topic/name&quot;</span>;</div>
<div class="line">willInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#a6161c792d20cc7cf8284c1b71ea1145f">topicNameLength</a> = strlen( willInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#aa80e8ca282d01630f878ad0afe81d7a4">pTopicName</a> );</div>
<div class="line">willInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#afc28299f4f625f5e674bb61b42f03380">pPayload</a> = <span class="stringliteral">&quot;LWT Message&quot;</span>;</div>
<div class="line">willInfo.<a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_publish_info__t.html#a7997964e11571f35f0c3b729db0f760f">payloadLength</a> = strlen( <span class="stringliteral">&quot;LWT Message&quot;</span> );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the MQTTAgentConnectArgs_t structure.</span></div>
<div class="line">connectArgs.pConnectInfo = &amp;connectInfo;</div>
<div class="line">connectArgs.pWillInfo = &amp;willInfo;</div>
<div class="line"><span class="comment">// Time to block for CONNACK response when command is processed.</span></div>
<div class="line">connectArgs.timeoutMs = 500;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Function for command complete callback.</span></div>
<div class="line"><span class="keywordtype">void</span> connectCmdCallback( <a class="code" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> * pCmdCallbackContext,</div>
<div class="line">                         <a class="code" href="struct_m_q_t_t_agent_return_info__t.html">MQTTAgentReturnInfo_t</a> * pReturnInfo );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the command information.</span></div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#a4c9e9b55c7b576a390f734238b60f3aa">cmdCompleteCallback</a> = connectCmdCallback;</div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#aa0f490187c1199c2d31d4c04a01d4637">blockTimeMs</a> = 500;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#a782425e50d258837d23e379471254412">MQTTAgent_Connect</a>( &amp;agentContext, &amp;connectArgs, &amp;commandInfo );</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Command for creating the MQTT connection has been queued.</span></div>
<div class="line">  <span class="comment">// The MQTT connection event will be notified through the</span></div>
<div class="line">  <span class="comment">// invocation of connectCmdCallback().</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_a782425e50d258837d23e379471254412"><div class="ttname"><a href="core__mqtt__agent_8c.html#a782425e50d258837d23e379471254412">MQTTAgent_Connect</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_Connect(const MQTTAgentContext_t *pMqttAgentContext, MQTTAgentConnectArgs_t *pConnectArgs, const MQTTAgentCommandInfo_t *pCommandInfo)</div><div class="ttdoc">Add a command to call MQTT_Connect() for an MQTT connection. If a session is resumed with the broker,...</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1228</div></div>
<div class="ttc" id="agroup__mqtt__enum__types_html_ggae308a5928d7f537379c29a894228093aaad51b23a1ae1417f96d8f343c788d1d2"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggae308a5928d7f537379c29a894228093aaad51b23a1ae1417f96d8f343c788d1d2">MQTTQoS0</a></div><div class="ttdeci">MQTTQoS0</div></div>
<div class="ttc" id="astruct_m_q_t_t_agent_connect_args__t_html"><div class="ttname"><a href="struct_m_q_t_t_agent_connect_args__t.html">MQTTAgentConnectArgs_t</a></div><div class="ttdoc">Struct holding arguments for a CONNECT call.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.h:203</div></div>
<div class="ttc" id="astruct_m_q_t_t_connect_info__t_html_a010f8f6993cbf8899648d5c515ff7884"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a010f8f6993cbf8899648d5c515ff7884">MQTTConnectInfo_t::pClientIdentifier</a></div><div class="ttdeci">const char * pClientIdentifier</div></div>
<div class="ttc" id="astruct_m_q_t_t_connect_info__t_html_a1118d7d3251a11445318557280db53b4"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a1118d7d3251a11445318557280db53b4">MQTTConnectInfo_t::pUserName</a></div><div class="ttdeci">const char * pUserName</div></div>
<div class="ttc" id="astruct_m_q_t_t_connect_info__t_html_a606e7765c4f2215fb2bf630f6eb9ff6b"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a606e7765c4f2215fb2bf630f6eb9ff6b">MQTTConnectInfo_t::cleanSession</a></div><div class="ttdeci">bool cleanSession</div></div>
<div class="ttc" id="astruct_m_q_t_t_connect_info__t_html_a7165be3bb06d4527ab4eb773b50e05e1"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a7165be3bb06d4527ab4eb773b50e05e1">MQTTConnectInfo_t::userNameLength</a></div><div class="ttdeci">uint16_t userNameLength</div></div>
<div class="ttc" id="astruct_m_q_t_t_connect_info__t_html_a7d05d53261732ebdfbb9ee665a347591"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a7d05d53261732ebdfbb9ee665a347591">MQTTConnectInfo_t::keepAliveSeconds</a></div><div class="ttdeci">uint16_t keepAliveSeconds</div></div>
<div class="ttc" id="astruct_m_q_t_t_connect_info__t_html_a8077ef36ab318f3d35bee6f098fa54d4"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a8077ef36ab318f3d35bee6f098fa54d4">MQTTConnectInfo_t::clientIdentifierLength</a></div><div class="ttdeci">uint16_t clientIdentifierLength</div></div>
<div class="ttc" id="astruct_m_q_t_t_connect_info__t_html_a818c4e212a12020a4109eb890ec96383"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#a818c4e212a12020a4109eb890ec96383">MQTTConnectInfo_t::passwordLength</a></div><div class="ttdeci">uint16_t passwordLength</div></div>
<div class="ttc" id="astruct_m_q_t_t_connect_info__t_html_acec6c79a11d2f0f130802393f34d2b5e"><div class="ttname"><a href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/struct_m_q_t_t_connect_info__t.html#acec6c79a11d2f0f130802393f34d2b5e">MQTTConnectInfo_t::pPassword</a></div><div class="ttdeci">const char * pPassword</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a26687b9b762b5f52b14387bacdf17224" name="a26687b9b762b5f52b14387bacdf17224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26687b9b762b5f52b14387bacdf17224">&#9670;&nbsp;</a></span>MQTTAgent_Disconnect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_Disconnect </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a command to disconnect an MQTT connection. </p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="core__mqtt__agent_8h.html#a9dafeb1701b1a0ee897b626a09cfcff7" title="Process commands from the command queue in a loop.">MQTTAgent_CommandLoop</a> will return after processing a <a class="el" href="group__mqtt__agent__enum__types.html#gga76604fa58b7ee6c32ba084fda9379f33a2f6318afb30e8e2817e6203ebedc8173" title="Call MQTT_Disconnect().">DISCONNECT</a> command to allow the network connection to be disconnected. However, any pending commands in the queue, as well as those waiting for an acknowledgment, will NOT be terminated.</dd>
<dd>
The MQTTAgent_Disconnect function is provided to give a thread safe equivalent to the MQTT_Disconnect API. However, if the agent task is responsible for creating the MQTT connection (before calling <a class="el" href="core__mqtt__agent_8h.html#a9dafeb1701b1a0ee897b626a09cfcff7" title="Process commands from the command queue in a loop.">MQTTAgent_CommandLoop()</a>), then it is RECOMMENDED that an application task (i.e. a task other than the agent task) use MQTTAgent_Terminate to terminate the command loop in the agent, and the agent task be responsible for disconnecting the MQTT connection.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandInfo</td><td>The information pertaining to the command, including:<ul>
<li>cmdCompleteCallback Optional callback to invoke when the command completes.</li>
<li>pCmdCompleteCallbackContext Optional completion callback context.</li>
<li>blockTimeMs The maximum amount of time in milliseconds to wait for the command to be posted to the MQTT agent, should the agent's event queue be full. Tasks wait in the Blocked state so don't use any CPU time.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The context passed to the callback through pCmdContext member of <code>pCommandInfo</code> parameter MUST remain in scope at least until the callback has been executed by the agent task.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was posted to the MQTT agent's event queue. Otherwise an enumerated error code.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> agentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> commandInfo = { 0 };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Function for command complete callback.</span></div>
<div class="line"><span class="keywordtype">void</span> disconnectCmdCallback( <a class="code" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> * pCmdCallbackContext,</div>
<div class="line">                            <a class="code" href="struct_m_q_t_t_agent_return_info__t.html">MQTTAgentReturnInfo_t</a> * pReturnInfo );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the command information.</span></div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#a4c9e9b55c7b576a390f734238b60f3aa">cmdCompleteCallback</a> = disconnectCmdCallback;</div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#aa0f490187c1199c2d31d4c04a01d4637">blockTimeMs</a> = 500;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#a26687b9b762b5f52b14387bacdf17224">MQTTAgent_Disconnect</a>( &amp;agentContext, &amp;commandInfo );</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Command for closing the MQTT connection has been queued.</span></div>
<div class="line">  <span class="comment">// The MQTT disconnection event will be notified through the</span></div>
<div class="line">  <span class="comment">// invocation of disconnectCmdCallback().</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_a26687b9b762b5f52b14387bacdf17224"><div class="ttname"><a href="core__mqtt__agent_8c.html#a26687b9b762b5f52b14387bacdf17224">MQTTAgent_Disconnect</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_Disconnect(const MQTTAgentContext_t *pMqttAgentContext, const MQTTAgentCommandInfo_t *pCommandInfo)</div><div class="ttdoc">Add a command to disconnect an MQTT connection.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1253</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="ae260e29f31d51953cbab2e1437f645ed" name="ae260e29f31d51953cbab2e1437f645ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae260e29f31d51953cbab2e1437f645ed">&#9670;&nbsp;</a></span>MQTTAgent_Ping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_Ping </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a command to call <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/core__mqtt_8h.html#a66eced0c62ace790354ae3de40fc0959">MQTT_Ping()</a> for an MQTT connection. </p>
<dl class="section note"><dt>Note</dt><dd>This API function ONLY enqueues a command to send a ping request to the server, and DOES NOT wait for a ping response to be received from the server. To detect whether a Ping Response, has not been received from the server, the <a class="el" href="core__mqtt__agent_8h.html#a9dafeb1701b1a0ee897b626a09cfcff7">MQTTAgent_CommandLoop</a> function SHOULD be used, which returns the <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca076ca8965e836a06e707a94adb26144f">MQTTKeepAliveTimeout</a> return code on a ping response (or keep-alive) timeout.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandInfo</td><td>The information pertaining to the command, including:<ul>
<li>cmdCompleteCallback Optional callback to invoke when the command completes.</li>
<li>pCmdCompleteCallbackContext Optional completion callback context.</li>
<li>blockTimeMs The maximum amount of time in milliseconds to wait for the command to be posted to the MQTT agent, should the agent's event queue be full. Tasks wait in the Blocked state so don't use any CPU time.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The context passed to the callback through pCmdContext member of <code>pCommandInfo</code> parameter MUST remain in scope at least until the callback has been executed by the agent task.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was posted to the MQTT agent's event queue. Otherwise an enumerated error code.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> agentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> commandInfo = { 0 };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Function for command complete callback.</span></div>
<div class="line"><span class="keywordtype">void</span> pingRequestCompleteCb( <a class="code" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> * pCmdCallbackContext,</div>
<div class="line">                            <a class="code" href="struct_m_q_t_t_agent_return_info__t.html">MQTTAgentReturnInfo_t</a> * pReturnInfo );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the command information.</span></div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#a4c9e9b55c7b576a390f734238b60f3aa">cmdCompleteCallback</a> = pingRequestCompleteCb;</div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#aa0f490187c1199c2d31d4c04a01d4637">blockTimeMs</a> = 500;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#ae260e29f31d51953cbab2e1437f645ed">MQTTAgent_Ping</a>( &amp;agentContext, &amp;commandInfo );</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Command for sending request has been queued. Application can</span></div>
<div class="line">  <span class="comment">// handle keep-alive timeout if detected through return value of</span></div>
<div class="line">  <span class="comment">// MQTTAgent_CommandLoop in the task running the agent.</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_ae260e29f31d51953cbab2e1437f645ed"><div class="ttname"><a href="core__mqtt__agent_8c.html#ae260e29f31d51953cbab2e1437f645ed">MQTTAgent_Ping</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_Ping(const MQTTAgentContext_t *pMqttAgentContext, const MQTTAgentCommandInfo_t *pCommandInfo)</div><div class="ttdoc">Add a command to call MQTT_Ping() for an MQTT connection.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1276</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="ae1b19c10831f72251603b045f2608313" name="ae1b19c10831f72251603b045f2608313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1b19c10831f72251603b045f2608313">&#9670;&nbsp;</a></span>MQTTAgent_Terminate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> MQTTAgent_Terminate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> *&#160;</td>
          <td class="paramname"><em>pMqttAgentContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCommandInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a termination command to the command queue. </p>
<p >On command loop termination, all pending commands in the queue, as well as those waiting for an acknowledgment, will be terminated with error code <a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735caa14bc8aa4ad218702d782366945d43ac">MQTTRecvFailed</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Commands may still be posted to the command queue after <a class="el" href="core__mqtt__agent_8h.html#a9dafeb1701b1a0ee897b626a09cfcff7" title="Process commands from the command queue in a loop.">MQTTAgent_CommandLoop</a> has returned. It is the responsibility of the application to cancel any commands that are posted while the command loop is not running, such as by invoking <a class="el" href="core__mqtt__agent_8h.html#a0362d7d3d68628413f01b32ec2ff4ab6" title="Cancel all enqueued commands and those awaiting acknowledgment while the command loop is not running.">MQTTAgent_CancelAll</a>.</dd>
<dd>
We RECOMMEND that this function is used from application task(s), that is a task not running the agent, to terminate the agent loop instead of calling MQTTAgent_Disconnect, so that the logic for creating and closing MQTT connection is owned by the agent task.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pMqttAgentContext</td><td>The MQTT agent to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCommandInfo</td><td>The information pertaining to the command, including:<ul>
<li>cmdCompleteCallback Optional callback to invoke when the command completes.</li>
<li>pCmdCompleteCallbackContext Optional completion callback context.</li>
<li>blockTimeMs The maximum amount of time in milliseconds to wait for the command to be posted to the MQTT agent, should the agent's event queue be full. Tasks wait in the Blocked state so don't use any CPU time.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The context passed to the callback through pCmdContext member of <code>pCommandInfo</code> parameter MUST remain in scope at least until the callback has been executed by the agent task.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="elRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> if the command was posted to the MQTT agent's event queue. Otherwise an enumerated error code.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Variables used in this example.</span></div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_context__t.html">MQTTAgentContext_t</a> agentContext;</div>
<div class="line"><a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#gaba7ec045874a1c3432f99173367f735c">MQTTStatus_t</a> status;</div>
<div class="line"><a class="code" href="struct_m_q_t_t_agent_command_info__t.html">MQTTAgentCommandInfo_t</a> commandInfo = { 0 };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Function for command complete callback.</span></div>
<div class="line"><span class="keywordtype">void</span> terminateCallback( <a class="code" href="group__mqtt__agent__struct__types.html#ga953da1618097a29381f3fc38f576055c">MQTTAgentCommandContext_t</a> * pCmdCallbackContext,</div>
<div class="line">                        <a class="code" href="struct_m_q_t_t_agent_return_info__t.html">MQTTAgentReturnInfo_t</a> * pReturnInfo );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fill the command information.</span></div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#a4c9e9b55c7b576a390f734238b60f3aa">cmdCompleteCallback</a> = terminateCallback;</div>
<div class="line">commandInfo.<a class="code" href="struct_m_q_t_t_agent_command_info__t.html#aa0f490187c1199c2d31d4c04a01d4637">blockTimeMs</a> = 500;</div>
<div class="line"> </div>
<div class="line">status = <a class="code" href="core__mqtt__agent_8c.html#ae1b19c10831f72251603b045f2608313">MQTTAgent_Terminate</a>( &amp;agentContext, &amp;commandInfo );</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( status == <a class="codeRef" href="https://freertos.org/Documentation/api-ref/coreMQTT/docs/doxygen/output/html/group__mqtt__enum__types.html#ggaba7ec045874a1c3432f99173367f735ca484e062cb4f3fccc1858dd25cfeee056">MQTTSuccess</a> )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Command to terminate the agent loop has been queued.</span></div>
<div class="line">}</div>
<div class="ttc" id="acore__mqtt__agent_8c_html_ae1b19c10831f72251603b045f2608313"><div class="ttname"><a href="core__mqtt__agent_8c.html#ae1b19c10831f72251603b045f2608313">MQTTAgent_Terminate</a></div><div class="ttdeci">MQTTStatus_t MQTTAgent_Terminate(const MQTTAgentContext_t *pMqttAgentContext, const MQTTAgentCommandInfo_t *pCommandInfo)</div><div class="ttdoc">Add a termination command to the command queue.</div><div class="ttdef"><b>Definition:</b> core_mqtt_agent.c:1299</div></div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="core__mqtt__agent_8c.html">core_mqtt_agent.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
