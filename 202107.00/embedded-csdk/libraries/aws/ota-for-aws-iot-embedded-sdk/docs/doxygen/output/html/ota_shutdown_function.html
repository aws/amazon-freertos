<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWS IoT Over-the-air Update: OTA_Shutdown</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="foobar.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Over-the-air Update<span id="projectnumber">&#160;v3.0.0</span>
   </div>
   <div id="projectbrief">Client library for AWS IoT OTA</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ota_shutdown_function.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">OTA_Shutdown </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >Signal to the OTA Agent to shut down.</p>
<div class="fragment"><div class="line"><a class="code" href="group__ota__enum__types.html#ga1cb476a5e0ee81fa486f605e64419dcc">OtaState_t</a> <a class="code" href="ota_8h.html#ac779291eb93f4e0e6459816e60e13b09">OTA_Shutdown</a>( uint32_t ticksToWait,</div>
<div class="line">                         uint8_t unsubscribeFlag );</div>
<div class="ttc" id="agroup__ota__enum__types_html_ga1cb476a5e0ee81fa486f605e64419dcc"><div class="ttname"><a href="group__ota__enum__types.html#ga1cb476a5e0ee81fa486f605e64419dcc">OtaState_t</a></div><div class="ttdeci">OtaState_t</div><div class="ttdoc">OTA Agent states.</div><div class="ttdef"><b>Definition:</b> ota.h:108</div></div>
<div class="ttc" id="aota_8h_html_ac779291eb93f4e0e6459816e60e13b09"><div class="ttname"><a href="ota_8h.html#ac779291eb93f4e0e6459816e60e13b09">OTA_Shutdown</a></div><div class="ttdeci">OtaState_t OTA_Shutdown(uint32_t ticksToWait, uint8_t unsubscribeFlag)</div><div class="ttdoc">Signal to the OTA Agent to shut down.</div><div class="ttdef"><b>Definition:</b> ota.c:3157</div></div>
</div><!-- fragment --><p> Signals the OTA agent task to shut down. The OTA agent will unsubscribe from all MQTT job notification topics, stop in progress OTA jobs, if any, and clear all resources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ticksToWait</td><td>The number of ticks to wait for the OTA Agent to complete the shutdown process. If this is set to zero, the function will return immediately without waiting. The actual state is returned to the caller. The agent does not sleep for this while but used for busy looping.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsubscribeFlag</td><td>Flag to indicate if unsubscribe operations should be performed from the job topics when shutdown is called. If the flag is 0 then unsubscribe operations are not called for job topics If application requires it to be unsubscribed from the job topics then flag must be set to 1 when calling OTA_Shutdown.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>One of the OTA agent states from the OtaState_t enum. A normal shutdown will return OtaAgentStateNotReady. Otherwise, refer to the OtaState_t enum for details.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// ticksToWait used for busy looping until shutdown. Actual delay may depend on the agent priority,</span></div>
<div class="line"><span class="comment">// and platform.</span></div>
<div class="line">uint32_t ticksToWait = 100;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// If it is required that the unsubscribe operations are not</span></div>
<div class="line"><span class="comment">//performed while shutting down set this to 0.</span></div>
<div class="line">uint8_t unsubscribe = 1;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="ota_8h.html#ac779291eb93f4e0e6459816e60e13b09">OTA_Shutdown</a>(ticksToWait, unsubscribe);</div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">if( <a class="code" href="ota_8h.html#a6db3f9cb417cb135cb0e68f5b5f2b11f">OTA_GetState</a>() != OtaAgentStateStopped )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Optional: Disconnect MQTT and HTTP connections</span></div>
<div class="line">    <span class="comment">// required by the OTA agent and other tasks.</span></div>
<div class="line">}</div>
<div class="ttc" id="aota_8h_html_a6db3f9cb417cb135cb0e68f5b5f2b11f"><div class="ttname"><a href="ota_8h.html#a6db3f9cb417cb135cb0e68f5b5f2b11f">OTA_GetState</a></div><div class="ttdeci">OtaState_t OTA_GetState(void)</div><div class="ttdoc">Get the current state of the OTA agent.</div><div class="ttdef"><b>Definition:</b> ota.c:3216</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
