<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="7181.25px" preserveAspectRatio="none" style="width:3293px;height:7181px;" version="1.1" viewBox="0 0 3293 7181" width="3293.75px" zoomAndPan="magnify"><defs><filter height="300%" id="f1x8a89tlv2yo" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="6.25"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="12.5" dy="12.5" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFE4E1" height="7135.3317" style="stroke: #A80036; stroke-width: 3.125;" width="300" x="90.625" y="12.5"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="240.625" x="120.3125" y="51.2009">Application</text><rect fill="#90EE90" height="7135.3317" style="stroke: #A80036; stroke-width: 3.125;" width="1010.9375" x="920.3125" y="12.5"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="259.375" x="1296.0938" y="51.2009">OTA Library</text><rect fill="#ADD8E6" height="7135.3317" style="stroke: #A80036; stroke-width: 3.125;" width="481.25" x="2089.0625" y="12.5"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="462.5" x="2098.4375" y="51.2009">Connectivity Libraries</text><rect fill="#E9967A" height="7135.3317" style="stroke: #A80036; stroke-width: 3.125;" width="334.375" x="2885.9375" y="12.5"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="303.125" x="2895.3125" y="51.2009">Cloud AWS IoT</text><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="2978.125" y="98.4711">Service</text><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="1001.2222" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="461.8622"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="278.5202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="2049.8306"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="959.8068" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="2685.7864"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="182.0404" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="4128.8193"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="182.0404" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="4449.1501"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="530.4962" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="5221.0617"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="887.9318" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="6112.1185"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="240.625" y="6658.2397"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="182.0404" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="825.943"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="495.726" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="1372.0642"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="203.5202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="2234.6008"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="184.7702" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="2776.8066"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="483.226" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="3645.5933"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="756.2866" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="4631.1905"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1796.875" y="3871.3837"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="367.2058" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1796.875" y="4853.8559"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1796.875" y="6021.0983"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="109.7702" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1796.875" y="6840.2802"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="273.0606" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="461.8622"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="273.0606" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="1099.0036"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="275.7904" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="1867.7902"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="184.7702" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="2685.7864"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="273.0606" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="3127.9922"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="273.0606" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="5478.4973"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="455.101" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="6112.1185"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="411.351" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2421.875" y="4128.8193"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="552.8824"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="1190.0238"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="1867.7902"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="3219.0125"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="138.2904" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="4310.8597"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="5569.5175"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="6385.1791"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="549.2462" style="stroke: #000000; stroke-width: 6.25;" width="3121.875" x="71.875" y="3008.4518"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="1789.1541" style="stroke: #000000; stroke-width: 6.25;" width="3184.375" x="40.625" y="4009.2789"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="232.4356" style="stroke: #000000; stroke-width: 6.25;" width="565.625" x="1675" y="4900.7309"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="508.6212" style="stroke: #000000; stroke-width: 6.25;" width="3121.875" x="71.875" y="5267.9367"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 5.0,5.0;" x1="240.625" x2="240.625" y1="229.8218" y2="7028.1754"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 5.0,5.0;" x1="1070.3125" x2="1070.3125" y1="229.8218" y2="7028.1754"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 5.0,5.0;" x1="1812.5" x2="1812.5" y1="229.8218" y2="7028.1754"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 5.0,5.0;" x1="2228.125" x2="2228.125" y1="229.8218" y2="7028.1754"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 5.0,5.0;" x1="2437.5" x2="2437.5" y1="229.8218" y2="7028.1754"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 5.0,5.0;" x1="3053.125" x2="3053.125" y1="229.8218" y2="7028.1754"/><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="262.5" x="103.125" y="119.5404"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="218.75" x="125" y="182.9865">OTADemo</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="262.5" x="103.125" y="7025.0504"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="218.75" x="125" y="7088.4964">OTADemo</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="265.625" x="932.8125" y="119.5404"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="221.875" x="954.6875" y="182.9865">OTAAgent</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="265.625" x="932.8125" y="7025.0504"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="221.875" x="954.6875" y="7088.4964">OTAAgent</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="200" x="1706.25" y="119.5404"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="156.25" x="1728.125" y="182.9865">OTAPal</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="200" x="1706.25" y="7025.0504"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="156.25" x="1728.125" y="7088.4964">OTAPal</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="171.875" x="2137.5" y="119.5404"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="128.125" x="2159.375" y="182.9865">MQTT</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="171.875" x="2137.5" y="7025.0504"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="128.125" x="2159.375" y="7088.4964">MQTT</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="156.25" x="2353.125" y="119.5404"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="112.5" x="2375" y="182.9865">HTTP</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="156.25" x="2353.125" y="7025.0504"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="112.5" x="2375" y="7088.4964">HTTP</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="206.25" x="2943.75" y="119.5404"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="162.5" x="2965.625" y="182.9865">AWSIoT</text><rect fill="#FEFECE" filter="url(#f1x8a89tlv2yo)" height="94.6564" style="stroke: #A80036; stroke-width: 4.6875;" width="206.25" x="2943.75" y="7025.0504"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacingAndGlyphs" textLength="162.5" x="2965.625" y="7088.4964">AWSIoT</text><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="1001.2222" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="461.8622"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="278.5202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="2049.8306"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="959.8068" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="2685.7864"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="182.0404" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="4128.8193"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="182.0404" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="4449.1501"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="530.4962" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="5221.0617"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="887.9318" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="225" y="6112.1185"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="240.625" y="6658.2397"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="182.0404" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="825.943"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="495.726" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="1372.0642"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="203.5202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="2234.6008"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="184.7702" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="2776.8066"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="483.226" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="3645.5933"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="756.2866" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1056.25" y="4631.1905"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1796.875" y="3871.3837"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="367.2058" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1796.875" y="4853.8559"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1796.875" y="6021.0983"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="109.7702" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="1796.875" y="6840.2802"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="273.0606" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="461.8622"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="273.0606" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="1099.0036"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="275.7904" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="1867.7902"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="184.7702" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="2685.7864"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="273.0606" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="3127.9922"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="273.0606" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="5478.4973"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="455.101" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2214.0625" y="6112.1185"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="411.351" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="2421.875" y="4128.8193"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="552.8824"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="1190.0238"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="1867.7902"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="3219.0125"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="138.2904" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="4310.8597"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="5569.5175"/><rect fill="#FFFFFF" filter="url(#f1x8a89tlv2yo)" height="91.0202" style="stroke: #A80036; stroke-width: 3.125;" width="31.25" x="3037.5" y="6385.1791"/><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="9.375" style="stroke: #EEEEEE; stroke-width: 3.125;" width="3246.875" x="9.375" y="325.3319"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="325.3319" y2="325.3319"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="334.7069" y2="334.7069"/><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="72.2702" style="stroke: #000000; stroke-width: 6.25;" width="318.75" x="1473.4375" y="292.3218"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="262.5" x="1492.1875" y="343.5226">Initialization</text><polygon fill="#A80036" points="2176.5625,449.3622,2207.8125,461.8622,2176.5625,474.3622,2189.0625,461.8622" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="2195.3125" y1="461.8622" y2="461.8622"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="278.125" y="447.0428">1</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="484.375" x="318.75" y="446.9437">Create MQTT connection</text><polygon fill="#A80036" points="3000,540.3824,3031.25,552.8824,3000,565.3824,3012.5,552.8824" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="2245.3125" x2="3018.75" y1="552.8824" y2="552.8824"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="2267.1875" y="538.063">2</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="375" x="2307.8125" y="537.9639">Send data to server</text><polygon fill="#A80036" points="2279.6875,631.4026,2248.4375,643.9026,2279.6875,656.4026,2267.1875,643.9026" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="2260.9375" x2="3050" y1="643.9026" y2="643.9026"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="2298.4375" y="629.0833">3</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="2351.5625" y="628.9841"/><polygon fill="#A80036" points="290.625,722.4228,259.375,734.9228,290.625,747.4228,278.125,734.9228" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="271.875" x2="2226.5625" y1="734.9228" y2="734.9228"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="309.375" y="720.1035">4</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="362.5" y="720.0043"/><polygon fill="#A80036" points="1018.75,813.443,1050,825.943,1018.75,838.443,1031.25,825.943" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="1037.5" y1="825.943" y2="825.943"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="278.125" y="811.1237">5</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="381.25" x="318.75" y="811.0245">Initialize OTAAgent</text><polygon fill="#A80036" points="290.625,904.4632,259.375,916.9632,290.625,929.4632,278.125,916.9632" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="271.875" x2="1053.125" y1="916.9632" y2="916.9632"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="309.375" y="902.1439">6</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="362.5" y="902.0447"/><polygon fill="#A80036" points="290.625,995.4834,259.375,1007.9834,290.625,1020.4834,278.125,1007.9834" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="271.875" x2="1068.75" y1="1007.9834" y2="1007.9834"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="309.375" y="993.1641">7</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="678.125" x="350" y="993.0649">Subscibe to Job notification topics</text><polygon fill="#A80036" points="2176.5625,1086.5036,2207.8125,1099.0036,2176.5625,1111.5036,2189.0625,1099.0036" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="2195.3125" y1="1099.0036" y2="1099.0036"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="278.125" y="1084.1843">8</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="190.625" x="318.75" y="1084.0851">Subscribe</text><polygon fill="#A80036" points="3000,1177.5238,3031.25,1190.0238,3000,1202.5238,3012.5,1190.0238" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="2245.3125" x2="3018.75" y1="1190.0238" y2="1190.0238"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="2267.1875" y="1175.2045">9</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="375" x="2307.8125" y="1175.1053">Send data to server</text><polygon fill="#A80036" points="2279.6875,1268.544,2248.4375,1281.044,2279.6875,1293.544,2267.1875,1281.044" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="2260.9375" x2="3050" y1="1281.044" y2="1281.044"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2298.4375" y="1266.2247">10</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="2379.6875" y="1266.1255"/><polygon fill="#A80036" points="290.625,1359.5642,259.375,1372.0642,290.625,1384.5642,278.125,1372.0642" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="271.875" x2="2226.5625" y1="1372.0642" y2="1372.0642"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="1357.2449">11</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="390.625" y="1357.1457"/><polygon fill="#A80036" points="1018.75,1450.5844,1050,1463.0844,1018.75,1475.5844,1031.25,1463.0844" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="240.625" x2="1037.5" y1="1463.0844" y2="1463.0844"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="262.5" y="1448.2651">12</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="343.75" y="1448.1659"/><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="9.375" style="stroke: #EEEEEE; stroke-width: 3.125;" width="3246.875" x="9.375" y="1552.3445"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="1552.3445" y2="1552.3445"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="1561.7195" y2="1561.7195"/><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="72.2702" style="stroke: #000000; stroke-width: 6.25;" width="296.875" x="1484.375" y="1519.3344"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="240.625" x="1503.125" y="1570.5353">Job Parsing</text><line style="stroke: #A80036; stroke-width: 3.125;" x1="1087.5" x2="1218.75" y1="1736.145" y2="1736.145"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1218.75" x2="1218.75" y1="1736.145" y2="1776.77"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1090.625" x2="1218.75" y1="1776.77" y2="1776.77"/><polygon fill="#A80036" points="1121.875,1764.27,1090.625,1776.77,1121.875,1789.27,1109.375,1776.77" style="stroke: #A80036; stroke-width: 3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1109.375" y="1697.6906">13</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="153.125" x="1178.125" y="1673.9563">Wait for</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="62.5" x="1178.125" y="1721.2265">Job</text><polygon fill="#A80036" points="2279.6875,1855.2902,2248.4375,1867.7902,2279.6875,1880.2902,2267.1875,1867.7902" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="2260.9375" x2="3034.375" y1="1867.7902" y2="1867.7902"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2298.4375" y="1852.9709">14</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="540.625" x="2367.1875" y="1852.8717">Job notification from server</text><polygon fill="#A80036" points="3015.625,1946.3104,3046.875,1958.8104,3015.625,1971.3104,3028.125,1958.8104" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="2245.3125" x2="3034.375" y1="1958.8104" y2="1958.8104"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2267.1875" y="1943.9911">15</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="2348.4375" y="1943.8919"/><polygon fill="#A80036" points="290.625,2037.3306,259.375,2049.8306,290.625,2062.3306,278.125,2049.8306" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="271.875" x2="2210.9375" y1="2049.8306" y2="2049.8306"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="2035.0113">16</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="365.625" x="378.125" y="2034.9121">MQTT Job callback</text><polygon fill="#A80036" points="1018.75,2222.1008,1050,2234.6008,1018.75,2247.1008,1031.25,2234.6008" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="1037.5" y1="2234.6008" y2="2234.6008"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="278.125" y="2219.7815">17</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="471.875" x="346.875" y="2219.6823">Send Job Received event</text><line style="stroke: #A80036; stroke-width: 3.125;" x1="1087.5" x2="1218.75" y1="2434.996" y2="2434.996"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1218.75" x2="1218.75" y1="2434.996" y2="2475.621"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1071.875" x2="1218.75" y1="2475.621" y2="2475.621"/><polygon fill="#A80036" points="1103.125,2463.121,1071.875,2475.621,1103.125,2488.121,1090.625,2475.621" style="stroke: #A80036; stroke-width: 3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1109.375" y="2420.1767">18</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="596.875" x="1178.125" y="2420.0775">Parse Job Document (json) (*2)</text><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="9.375" style="stroke: #EEEEEE; stroke-width: 3.125;" width="3246.875" x="9.375" y="2549.2561"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="2549.2561" y2="2549.2561"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="2558.6311" y2="2558.6311"/><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="72.2702" style="stroke: #000000; stroke-width: 6.25;" width="584.375" x="1340.625" y="2516.246"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="528.125" x="1359.375" y="2567.4469">Connection Management</text><polygon fill="#A80036" points="290.625,2673.2864,259.375,2685.7864,290.625,2698.2864,278.125,2685.7864" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="271.875" x2="2210.9375" y1="2685.7864" y2="2685.7864"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="2670.9671">19</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="531.25" x="378.125" y="2670.8679">MQTT Disconnect Callback</text><polygon fill="#A80036" points="1018.75,2764.3066,1050,2776.8066,1018.75,2789.3066,1031.25,2776.8066" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="1037.5" y1="2776.8066" y2="2776.8066"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="278.125" y="2761.9873">20</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="262.5" x="346.875" y="2761.8881">Suspend OTA</text><polygon fill="#A80036" points="290.625,2949.0768,259.375,2961.5768,290.625,2974.0768,278.125,2961.5768" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="271.875" x2="1068.75" y1="2961.5768" y2="2961.5768"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="2946.7575">21</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="390.625" y="2946.6583"/><path d="M71.875,3008.4518 L303.125,3008.4518 L303.125,3030.3268 L271.875,3061.5768 L71.875,3061.5768 L71.875,3008.4518 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 3.125;"/><rect fill="none" height="549.2462" style="stroke: #000000; stroke-width: 6.25;" width="3121.875" x="71.875" y="3008.4518"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90.625" x="118.75" y="3050.2777">loop</text><text fill="#000000" font-family="sans-serif" font-size="34.375" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="690.625" x="350" y="3047.4487">[till connection succeed or max retries]</text><polygon fill="#A80036" points="2176.5625,3115.4922,2207.8125,3127.9922,2176.5625,3140.4922,2189.0625,3127.9922" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="2195.3125" y1="3127.9922" y2="3127.9922"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="278.125" y="3113.1729">22</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="356.25" x="346.875" y="3113.0737">Re-connect MQTT</text><polygon fill="#A80036" points="3000,3206.5125,3031.25,3219.0125,3000,3231.5125,3012.5,3219.0125" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="2245.3125" x2="3018.75" y1="3219.0125" y2="3219.0125"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2267.1875" y="3204.1931">23</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="375" x="2335.9375" y="3204.0939">Send data to server</text><polygon fill="#A80036" points="2279.6875,3297.5327,2248.4375,3310.0327,2279.6875,3322.5327,2267.1875,3310.0327" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="2260.9375" x2="3050" y1="3310.0327" y2="3310.0327"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2298.4375" y="3295.2133">24</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="2379.6875" y="3295.1141"/><polygon fill="#A80036" points="290.625,3388.5529,259.375,3401.0529,290.625,3413.5529,278.125,3401.0529" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="271.875" x2="2226.5625" y1="3401.0529" y2="3401.0529"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="3386.2335">25</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="162.5" x="378.125" y="3386.1343">Timeout</text><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="387.5" y1="3507.6981" y2="3507.6981"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="387.5" x2="387.5" y1="3507.6981" y2="3548.3231"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="240.625" x2="387.5" y1="3548.3231" y2="3548.3231"/><polygon fill="#A80036" points="271.875,3535.8231,240.625,3548.3231,271.875,3560.8231,259.375,3548.3231" style="stroke: #A80036; stroke-width: 3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="278.125" y="3492.8787">26</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="687.5" x="346.875" y="3492.7795">Exponential Delay( multiplied by 2)</text><polygon fill="#A80036" points="1018.75,3633.0933,1050,3645.5933,1018.75,3658.0933,1031.25,3645.5933" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="240.625" x2="1037.5" y1="3645.5933" y2="3645.5933"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="262.5" y="3630.7739">27</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="378.125" x="331.25" y="3630.6747">Resume OTA Agent</text><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="9.375" style="stroke: #EEEEEE; stroke-width: 3.125;" width="3246.875" x="9.375" y="3734.8534"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="3734.8534" y2="3734.8534"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="3744.2284" y2="3744.2284"/><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="72.2702" style="stroke: #000000; stroke-width: 6.25;" width="350" x="1457.8125" y="3701.8433"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="293.75" x="1476.5625" y="3753.0441">File Download</text><polygon fill="#A80036" points="1759.375,3858.8837,1790.625,3871.3837,1759.375,3883.8837,1771.875,3871.3837" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1087.5" x2="1778.125" y1="3871.3837" y2="3871.3837"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1109.375" y="3856.5643">28</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="478.125" x="1178.125" y="3856.4651">Create File for download</text><polygon fill="#A80036" points="1121.875,3949.9039,1090.625,3962.4039,1121.875,3974.9039,1109.375,3962.4039" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="1103.125" x2="1809.375" y1="3962.4039" y2="3962.4039"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1140.625" y="3947.5845">29</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="1221.875" y="3947.4854"/><path d="M40.625,4009.2789 L271.875,4009.2789 L271.875,4031.1539 L240.625,4062.4039 L40.625,4062.4039 L40.625,4009.2789 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 3.125;"/><rect fill="none" height="1789.1541" style="stroke: #000000; stroke-width: 6.25;" width="3184.375" x="40.625" y="4009.2789"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90.625" x="87.5" y="4051.1047">loop</text><text fill="#000000" font-family="sans-serif" font-size="34.375" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="556.25" x="318.75" y="4048.2758">[Till file download is complete]</text><polygon fill="#A80036" points="290.625,4116.3193,259.375,4128.8193,290.625,4141.3193,278.125,4128.8193" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="271.875" x2="1068.75" y1="4128.8193" y2="4128.8193"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="4113.9999">30</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="381.25" x="378.125" y="4113.9008">Request File blocks</text><polygon fill="#A80036" points="2384.375,4207.3395,2415.625,4219.8395,2384.375,4232.3395,2396.875,4219.8395" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="2403.125" y1="4219.8395" y2="4219.8395"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="278.125" y="4205.0201">31</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="243.75" x="346.875" y="4204.921">GET Request</text><polygon fill="#A80036" points="3000,4298.3597,3031.25,4310.8597,3000,4323.3597,3012.5,4310.8597" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="2453.125" x2="3018.75" y1="4310.8597" y2="4310.8597"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2475" y="4296.0403">32</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="375" x="2543.75" y="4295.9412">Send data to server</text><polygon fill="#A80036" points="2487.5,4436.6501,2456.25,4449.1501,2487.5,4461.6501,2475,4449.1501" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="2468.75" x2="3050" y1="4449.1501" y2="4449.1501"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2506.25" y="4410.6956">33</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="350" x="2575" y="4386.9614">Packet containing</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="206.25" x="2575" y="4434.2316">file blocks</text><polygon fill="#A80036" points="290.625,4527.6703,259.375,4540.1703,290.625,4552.6703,278.125,4540.1703" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="271.875" x2="2434.375" y1="4540.1703" y2="4540.1703"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="4525.351">34</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="303.125" x="378.125" y="4525.2518">HTTP Response</text><polygon fill="#A80036" points="1018.75,4618.6905,1050,4631.1905,1018.75,4643.6905,1031.25,4631.1905" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="240.625" x2="1037.5" y1="4631.1905" y2="4631.1905"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="262.5" y="4616.3712">35</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="346.875" x="331.25" y="4616.272">Process file block</text><line style="stroke: #A80036; stroke-width: 3.125;" x1="1087.5" x2="1218.75" y1="4722.2107" y2="4722.2107"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1218.75" x2="1218.75" y1="4722.2107" y2="4762.8357"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1090.625" x2="1218.75" y1="4762.8357" y2="4762.8357"/><polygon fill="#A80036" points="1121.875,4750.3357,1090.625,4762.8357,1121.875,4775.3357,1109.375,4762.8357" style="stroke: #A80036; stroke-width: 3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1109.375" y="4707.3914">36</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="575" x="1178.125" y="4707.2922">Decode File Blocks (cbor) (*4)</text><polygon fill="#A80036" points="1759.375,4841.3559,1790.625,4853.8559,1759.375,4866.3559,1771.875,4853.8559" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1087.5" x2="1778.125" y1="4853.8559" y2="4853.8559"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1109.375" y="4839.0366">37</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="321.875" x="1178.125" y="4838.9374">Write File Blocks</text><path d="M1675,4900.7309 L1868.75,4900.7309 L1868.75,4922.6059 L1837.5,4953.8559 L1675,4953.8559 L1675,4900.7309 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 3.125;"/><rect fill="none" height="232.4356" style="stroke: #000000; stroke-width: 6.25;" width="565.625" x="1675" y="4900.7309"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53.125" x="1721.875" y="4942.5568">alt</text><text fill="#000000" font-family="sans-serif" font-size="34.375" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="309.375" x="1915.625" y="4939.7278">[If last file block]</text><line style="stroke: #A80036; stroke-width: 3.125;" x1="1828.125" x2="1959.375" y1="5067.5415" y2="5067.5415"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1959.375" x2="1959.375" y1="5067.5415" y2="5108.1665"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1831.25" x2="1959.375" y1="5108.1665" y2="5108.1665"/><polygon fill="#A80036" points="1862.5,5095.6665,1831.25,5108.1665,1862.5,5120.6665,1850,5108.1665" style="stroke: #A80036; stroke-width: 3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1850" y="5029.0871">38</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="237.5" x="1918.75" y="5005.3528">Verify cypto</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="184.375" x="1918.75" y="5052.623">signature</text><polygon fill="#A80036" points="1121.875,5208.5617,1090.625,5221.0617,1121.875,5233.5617,1109.375,5221.0617" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="1103.125" x2="1809.375" y1="5221.0617" y2="5221.0617"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1140.625" y="5206.2424">39</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="1221.875" y="5206.1432"/><path d="M71.875,5267.9367 L265.625,5267.9367 L265.625,5289.8117 L234.375,5321.0617 L71.875,5321.0617 L71.875,5267.9367 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 3.125;"/><rect fill="none" height="508.6212" style="stroke: #000000; stroke-width: 6.25;" width="3121.875" x="71.875" y="5267.9367"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53.125" x="118.75" y="5309.7626">alt</text><text fill="#000000" font-family="sans-serif" font-size="34.375" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="684.375" x="312.5" y="5306.9336">[Every 64(default) file blocks received]</text><polygon fill="#A80036" points="290.625,5374.9771,259.375,5387.4771,290.625,5399.9771,278.125,5387.4771" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="271.875" x2="1068.75" y1="5387.4771" y2="5387.4771"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="5372.6578">40</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="212.5" x="378.125" y="5372.5586">Update Job</text><polygon fill="#A80036" points="2176.5625,5465.9973,2207.8125,5478.4973,2176.5625,5490.9973,2189.0625,5478.4973" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="2195.3125" y1="5478.4973" y2="5478.4973"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="278.125" y="5463.678">41</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="143.75" x="346.875" y="5463.5788">Publish</text><polygon fill="#A80036" points="3000,5557.0175,3031.25,5569.5175,3000,5582.0175,3012.5,5569.5175" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="2245.3125" x2="3018.75" y1="5569.5175" y2="5569.5175"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2267.1875" y="5554.6982">42</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="375" x="2335.9375" y="5554.599">Send data to server</text><polygon fill="#A80036" points="2279.6875,5648.0377,2248.4375,5660.5377,2279.6875,5673.0377,2267.1875,5660.5377" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="2260.9375" x2="3050" y1="5660.5377" y2="5660.5377"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2298.4375" y="5645.7184">43</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="2379.6875" y="5645.6192"/><polygon fill="#A80036" points="275,5739.0579,243.75,5751.5579,275,5764.0579,262.5,5751.5579" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="256.25" x2="2226.5625" y1="5751.5579" y2="5751.5579"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="293.75" y="5736.7386">44</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="375" y="5736.6394"/><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="9.375" style="stroke: #EEEEEE; stroke-width: 3.125;" width="3246.875" x="9.375" y="5884.568"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="5884.568" y2="5884.568"/><line style="stroke: #000000; stroke-width: 3.125;" x1="9.375" x2="3256.25" y1="5893.943" y2="5893.943"/><rect fill="#EEEEEE" filter="url(#f1x8a89tlv2yo)" height="72.2702" style="stroke: #000000; stroke-width: 6.25;" width="415.625" x="1425" y="5851.5579"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="359.375" x="1443.75" y="5902.7588">Activating Image</text><polygon fill="#A80036" points="1759.375,6008.5983,1790.625,6021.0983,1759.375,6033.5983,1771.875,6021.0983" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1071.875" x2="1778.125" y1="6021.0983" y2="6021.0983"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1093.75" y="6006.279">45</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="271.875" x="1162.5" y="6006.1798">Set boot flags</text><polygon fill="#A80036" points="1106.25,6099.6185,1075,6112.1185,1106.25,6124.6185,1093.75,6112.1185" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="1087.5" x2="1809.375" y1="6112.1185" y2="6112.1185"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1125" y="6097.2992">46</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="1206.25" y="6097.2"/><polygon fill="#A80036" points="290.625,6190.6387,259.375,6203.1387,290.625,6215.6387,278.125,6203.1387" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="271.875" x2="1068.75" y1="6203.1387" y2="6203.1387"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="6188.3194">47</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="346.875" x="378.125" y="6188.2202">Update Job status</text><polygon fill="#A80036" points="2176.5625,6281.6589,2207.8125,6294.1589,2176.5625,6306.6589,2189.0625,6294.1589" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="256.25" x2="2195.3125" y1="6294.1589" y2="6294.1589"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="278.125" y="6279.3396">48</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="143.75" x="346.875" y="6279.2404">Publish</text><polygon fill="#A80036" points="3000,6372.6791,3031.25,6385.1791,3000,6397.6791,3012.5,6385.1791" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="2245.3125" x2="3018.75" y1="6385.1791" y2="6385.1791"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2267.1875" y="6370.3598">49</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="375" x="2335.9375" y="6370.2606">Send data to server</text><polygon fill="#A80036" points="2279.6875,6463.6993,2248.4375,6476.1993,2279.6875,6488.6993,2267.1875,6476.1993" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="2260.9375" x2="3050" y1="6476.1993" y2="6476.1993"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="2298.4375" y="6461.38">50</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="2379.6875" y="6461.2808"/><polygon fill="#A80036" points="290.625,6554.7195,259.375,6567.2195,290.625,6579.7195,278.125,6567.2195" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="271.875" x2="2226.5625" y1="6567.2195" y2="6567.2195"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="309.375" y="6552.4002">51</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="390.625" y="6552.301"/><polygon fill="#A80036" points="306.25,6645.7397,275,6658.2397,306.25,6670.7397,293.75,6658.2397" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="287.5" x2="1068.75" y1="6658.2397" y2="6658.2397"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="325" y="6643.4204">52</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="443.75" x="393.75" y="6643.3212">Callback for activation</text><polygon fill="#A80036" points="1034.375,6736.7599,1065.625,6749.2599,1034.375,6761.7599,1046.875,6749.2599" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125; stroke-dasharray: 2.0,2.0;" x1="256.25" x2="1053.125" y1="6749.2599" y2="6749.2599"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="278.125" y="6734.4406">53</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="0" x="359.375" y="6734.3414"/><polygon fill="#A80036" points="1759.375,6827.7802,1790.625,6840.2802,1759.375,6852.7802,1771.875,6840.2802" style="stroke: #A80036; stroke-width: 3.125;"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1071.875" x2="1778.125" y1="6840.2802" y2="6840.2802"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1093.75" y="6825.4608">54</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="290.625" x="1162.5" y="6825.3616">Activate Image</text><line style="stroke: #A80036; stroke-width: 3.125;" x1="1828.125" x2="1959.375" y1="6946.9254" y2="6946.9254"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1959.375" x2="1959.375" y1="6946.9254" y2="6987.5504"/><line style="stroke: #A80036; stroke-width: 3.125;" x1="1812.5" x2="1959.375" y1="6987.5504" y2="6987.5504"/><polygon fill="#A80036" points="1843.75,6975.0504,1812.5,6987.5504,1843.75,7000.0504,1831.25,6987.5504" style="stroke: #A80036; stroke-width: 3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.25" x="1850" y="6932.106">55</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacingAndGlyphs" textLength="106.25" x="1918.75" y="6932.0068">Reset</text><!--MD5=[8031f6889270ffb257e50771111592e2]
@startuml
skinparam dpi 300
skinparam classFontSize 8
skinparam classFontName Helvetica
autonumber

box "Application" #Mistyrose
participant OTADemo
end box
box "OTA Library" #LightGreen
participant OTAAgent
participant OTAPal
end box
box "Connectivity Libraries" #LightBlue
participant MQTT
participant HTTP
end box
box "Cloud AWS IoT \nService" #Darksalmon
participant AWSIoT

== Initialization ==
OTADemo -> MQTT : Create MQTT connection
activate OTADemo
activate MQTT
MQTT -> AWSIoT : Send data to server
activate AWSIoT
MQTT <- - AWSIoT
deactivate AWSIoT
OTADemo <- - MQTT
deactivate MQTT

OTADemo -> OTAAgent :Initialize OTAAgent
activate OTAAgent
OTADemo <- - OTAAgent

OTAAgent -> OTADemo : Subscibe to Job notification topics
deactivate OTAAgent
OTADemo -> MQTT : Subscribe
activate MQTT
MQTT -> AWSIoT : Send data to server
activate AWSIoT
MQTT <- - AWSIoT
deactivate AWSIoT
OTADemo <- - MQTT
deactivate 
activate OTAAgent
OTADemo - -> OTAAgent
deactivate OTADemo

== Job Parsing ==
OTAAgent -> OTAAgent : Wait for \nJob
MQTT <- AWSIoT : Job notification from server
deactivate OTAAgent
activate AWSIoT
activate MQTT
MQTT - -> AWSIoT
deactivate AWSIoT

MQTT -> OTADemo : MQTT Job callback
activate OTADemo
deactivate MQTT
OTADemo -> OTAAgent : Send Job Received event
activate OTAAgent 
deactivate OTADemo
OTAAgent -> OTAAgent : Parse Job Document (json) (*2)
deactivate OTAAgent
== Connection Management ==

MQTT -> OTADemo : MQTT Disconnect Callback

activate MQTT

activate OTADemo
OTADemo -> OTAAgent : Suspend OTA 
activate OTAAgent
deactivate MQTT
OTAAgent - -> OTADemo
deactivate OTAAgent

loop till connection succeed or max retries

OTADemo -> MQTT : Re-connect MQTT
activate MQTT
MQTT -> AWSIoT : Send data to server
activate AWSIoT
MQTT <- - AWSIoT
deactivate AWSIoT
OTADemo <- - MQTT : Timeout
deactivate MQTT

OTADemo -> OTADemo : Exponential Delay( multiplied by 2)
deactivate MQTT
end
OTADemo -> OTAAgent : Resume OTA Agent
deactivate OTADemo
activate OTAAgent

== File Download ==

OTAAgent -> OTAPal : Create File for download
activate OTAPal
OTAAgent <- - OTAPal
deactivate OTAPal
loop Till file download is complete
OTAAgent -> OTADemo : Request File blocks
deactivate OTAAgent
activate OTADemo
activate HTTP
OTADemo -> HTTP : GET Request
HTTP -> AWSIoT : Send data to server
deactivate OTADemo
activate AWSIoT
HTTP <- AWSIoT :  Packet containing\nfile blocks 
deactivate AWSIoT
activate OTADemo
HTTP -> OTADemo : HTTP Response
deactivate HTTP
OTADemo -> OTAAgent : Process file block
deactivate MQTT
deactivate OTADemo
activate OTAAgent

OTAAgent -> OTAAgent : Decode File Blocks (cbor) (*4)
OTAAgent -> OTAPal : Write File Blocks
activate OTAPal

alt If last file block
OTAPal -> OTAPal : Verify cypto\nsignature
end
OTAAgent <- - OTAPal 
deactivate OTAPal


alt Every 64(default) file blocks received
activate OTADemo
OTAAgent -> OTADemo : Update Job 
deactivate OTAAgent
OTADemo -> MQTT : Publish

activate MQTT
MQTT -> AWSIoT : Send data to server
activate AWSIoT
MQTT <- - AWSIoT
deactivate AWSIoT
MQTT - -> OTADemo
deactivate MQTT
deactivate OTADemo
end
end
activate OTAAgent
== Activating Image ==

OTAAgent -> OTAPal : Set boot flags
activate OTAPal
OTAAgent <- - OTAPal
deactivate OTAPal
deactivate OTAAgent
activate OTADemo
activate MQTT
OTAAgent -> OTADemo : Update Job status
OTADemo -> MQTT : Publish

MQTT -> AWSIoT : Send data to server
activate AWSIoT
MQTT <- - AWSIoT
deactivate AWSIoT
MQTT - -> OTADemo
deactivate MQTT

OTAAgent -> OTADemo : Callback for activation
activate OTADemo
OTADemo - -> OTAAgent
deactivate OTADemo

OTAAgent -> OTAPal : Activate Image
deactivate OTAAgent
activate OTAPal
OTAPal -> OTAPal :Reset 
deactivate OTAPal
deactivate OTAAgent
@enduml

PlantUML version 1.2020.15(Sun Jun 28 11:39:45 UTC 2020)
(GPLV2 source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>