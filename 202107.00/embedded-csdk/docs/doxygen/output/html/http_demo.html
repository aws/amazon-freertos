<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWS IoT Device SDK C: coreHTTP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="foobar.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Device SDK C
   &#160;<span id="projectnumber">202012.00</span>
   </div>
   <div id="projectbrief">SDK for connecting to AWS IoT from a device using embedded C.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('http_demo.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">coreHTTP </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>These demos demonstrate usage of the coreHTTP library.</p>
<h1><a class="anchor" id="http_demo_plaintext"></a>
HTTP Plaintext Demo</h1>
<p>A demo of the coreHTTP library that establishes a plaintext TCP connection with a server, sends HTTP requests, then logs their responses.</p>
<p>A POSIX socket-based transport interface implementation is used to establish a plaintext connection over port 80 to an HTTP server. If a connection failure occurs, then the connection establishment is retried with exponential and jitter backoff. Once a connection is established, HTTP requests are sent for the following HTTP methods: <code>GET</code>, <code>HEAD</code>, <code>PUT</code>, and <code>POST</code>. The respective responses from each of these requests are logged. </p>
<div class="caption" style="text-align:center"> HTTP Plaintext Demo Workflow — Note that these steps are repeated indefinitely </div> <div class="image">
<img src="http_demo_plaintext.png" alt="" width="100%"/>
</div>
<h1><a class="anchor" id="http_demo_basic_tls"></a>
HTTP Basic TLS Demo</h1>
<p>A demo of the coreHTTP library that establishes a TLS connection with server-only authentication, sends HTTP requests, then logs their responses.</p>
<p>An OpenSSL-based transport interface implementation is used to establish an encrypted TLS connection over port 443 to an HTTP server. Only the server's certificate is verified using its respective root CA certificate. If a connection failure occurs, then the connection establishment is retried with exponential and jitter backoff. Once a connection is established, HTTP requests are sent for the following HTTP methods: <code>GET</code>, <code>HEAD</code>, <code>PUT</code>, and <code>POST</code>. The respective responses from each of these requests are logged. </p>
<div class="caption" style="text-align:center"> HTTP Basic TLS Demo Workflow — Note that these steps are repeated indefinitely </div> <div class="image">
<img src="http_demo_basic_tls.png" alt="" width="100%"/>
</div>
<h1><a class="anchor" id="http_demo_mutual_auth"></a>
HTTP Mutual Auth Demo</h1>
<p>A demo of the coreHTTP library that establishes a TLS connection with both server and client authentication, sends HTTP requests, then logs their responses.</p>
<p>An OpenSSL-based transport interface implementation is used to establish an encrypted TLS connection, with both server and client authentication, over port 443 to AWS IoT Core. Because port 443 is used, the ALPN protocol name must be set to <code>x-amzn-http-ca</code>. If a connection failure occurs, then the connection establishment is retried with exponential and jitter backoff. </p>
<p>After the TLS session is established, a single HTTP POST request is sent that publishes a message to a topic named <code>topic</code> in AWS IoT Core with <code>qos=1</code>. This means that any subscribers to this topic are guaranteed to receive this message at least once. </p>
<div class="caption" style="text-align:center"> HTTP Mutual Auth Demo Workflow — Note that these steps are repeated indefinitely </div> <div class="image">
<img src="http_demo_mutual_auth.png" alt="" width="100%"/>
</div>
<h1><a class="anchor" id="http_demo_s3_upload"></a>
HTTP S3 Upload Demo</h1>
<p>A demo of the coreHTTP library that utilizes user-defined pre-signed PUT and GET URLs to upload a file to the designated S3 object and then verify that the sizes of the local and uploaded files are equivalent.</p>
<p>An OpenSSL-based transport interface implementation is used to establish an encrypted TLS connection over port 443 to S3. The host address is extracted from the pre-signed PUT URL using the third-party http-parser library. Only the server's certificate is verified using its respective root CA certificate. If a connection failure occurs, then the connection establishment is retried for limited attempts with exponential and jitter backoff. </p>
<p>Once a connection is established, the PUT URL is parsed again to obtain its path string, after which an HTTP PUT request is sent to upload a file to the S3 object. Following the upload, the GET URL is also parsed for its path string, and an HTTP GET request is sent to obtain and parse the content-range header returned from the server, containing the size of the uploaded file. This size is compared against the size of the local file uploaded by the client, to verify their equivalence. </p>
<div class="caption" style="text-align:center"> HTTP S3 Upload Demo Workflow </div> <div class="image">
<img src="http_demo_s3_upload.png" alt="" width="100%"/>
</div>
<h1><a class="anchor" id="http_demo_s3_download"></a>
HTTP S3 Download Demo</h1>
<p>A demo of the coreHTTP library that utilizes a user-defined pre-signed GET URL to download a file in chunks from the designated S3 object, using range requests.</p>
<p>An OpenSSL-based transport interface implementation is used to establish an encrypted TLS connection over port 443 to S3. The host address is extracted from the pre-signed GET URL using the third-party http-parser library. Only the server's certificate is verified using its respective root CA certificate. If a connection failure occurs, then the connection establishment is retried for limited attempts with exponential and jitter backoff. </p>
<p>Once a connection is established, the GET URL is parsed again to obtain its path string, after which an HTTP GET request is sent to obtain and parse the content-range header returned from the server, containing the size of the uploaded file. Then, using range headers, the application loops until the entire file is downloaded, requesting a range of bytes (determined by the user buffer length) on each iteration. </p>
<div class="caption" style="text-align:center"> HTTP S3 Download Demo Workflow </div> <div class="image">
<img src="http_demo_s3_download.png" alt="" width="100%"/>
</div>
<h1><a class="anchor" id="http_demo_s3_download_multithreaded"></a>
HTTP Multithreaded S3 Download Demo</h1>
<p>A demo of the coreHTTP library that establishes a TLS connection with S3, and downloads a file in parts using range requests and a pre-signed URL.</p>
<p>An OpenSSL-based transport interface implementation is used to establish an encrypted TLS connection over port 443 to S3. The host address is extracted from the pre-signed GET URL using the third-party http-parser library. Only the server's certificate is verified using its respective root CA certificate. If a connection failure occurs, then the connection establishment is retried with exponential and jitter backoff. </p>
<p>Once a connection is established, an HTTP thread is started which makes HTTP requests over the TLS connection. In a loop, the main thread enqueues range requests for the S3 file on the request queue and dequeues responses from the response queue as they are ready. The responses from each of the requests are logged. The loop continues until the entire file has been requested and received. The HTTP thread services requests from the request queue and writes the responses to the response queue. </p>
<div class="caption" style="text-align:center"> HTTP Multithreaded S3 Download Workflow — Note that this diagram shows an example where the file is downloaded in three ranges. As it is multithreaded, these steps may not occur in the same order. </div> <div class="image">
<img src="http_demo_s3_download_multithreaded.png" alt="" width="100%"/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
