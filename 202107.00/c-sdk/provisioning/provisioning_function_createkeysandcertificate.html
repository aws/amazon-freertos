<!-- This file provides the custom header for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.14"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>
        Fleet Provisioning: AwsIotProvisioning_CreateKeysAndCertificate
    </title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="foobar.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
    <tbody>
        <tr style="height: 56px;">
            <td id="projectalign" style="padding-left: 0.5em;">
                <div id="projectname">
                    <span id="csdkprefix">AWS IoT Device SDK C:</span>
                    Fleet Provisioning
                </div>
                <div id="projectbrief">
                    AWS IoT Fleet Provisioning
                </div>
            </td>
        </tr>
        <tr>
            <td id="returntomain">
                <a href="../main/index.html">Return to main page &uarr;</a>
            </td>
        </tr>
    </tbody>
    </table>
    </div>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('provisioning_function_createkeysandcertificate.html','');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">AwsIotProvisioning_CreateKeysAndCertificate </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Requests a new public-private key pair and certificate for the device from AWS IoT Core and invokes the provided user-callback with the response from the server.</p>
<div class="fragment"><div class="line"><a class="code" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a> <a class="code" href="aws__iot__provisioning_8h.html#a477d75f9877e508cbb4621f16d2824e5">AwsIotProvisioning_CreateKeysAndCertificate</a>( <a class="codeRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> connection,</div><div class="line">                                                                       uint32_t flags,</div><div class="line">                                                                       uint32_t timeoutMs,</div><div class="line">                                                                       <span class="keyword">const</span> <a class="code" href="structAwsIotProvisioningCreateKeysAndCertificateCallbackInfo__t.html">AwsIotProvisioningCreateKeysAndCertificateCallbackInfo_t</a> * pResponseCallback );</div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>It is advised to use a shared MQTT connection to AWS IoT Core across all API functions.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function is NOT thread-safe. Concurrent calls to the library API functions can result in undefined behavior. Device provisioning with this library REQUIRES calling the API functions of this library sequentially.</dd>
<dd>
Do not overwrite the existing Provisioning claim credentials with the new credentials provided by the server, at least until the device has been provisioned with a new certificate using the <a class="el" href="provisioning_function_registerthing.html">AwsIotProvisioning_RegisterThing</a> function. It is also recommended to always retain the Provisioning claim credentials, if your product use-case supports re-provisioning of the device.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>We provide a security recommendation for protecting the identity, received from the server through this API function, for your IoT device. For the threat of an unauthorized reuse of the private key, that is received in the server response, in order to clone the device, an effective way to mitigate that is to audit, in the cloud, the use of each device private key. For example, if a device private key is reused, your cloud app (through Fleet Provisioning Hooks) could log an audit event for operator follow-up, and/or initiate a workflow for revoking the previous certificate(s) issued to that key.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">connection</td><td>The MQTT connection handle to the user AWS IoT account, which will be used for communicating with the server for creating new device credentials. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>The flags for configuring the behavior of the API. See the options available in the <a class="el" href="aws__iot__provisioning__types_8h.html" title="Types of the Provisioning library. ">aws_iot_provisioning_types.h</a> file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeoutMs</td><td>The timeout (in milliseconds) for a response from the server. If there is a timeout, this function returns <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286adfca211ed382bdf9a40027542cfbdf73" title="An Provisioning operation timed out. ">AWS_IOT_PROVISIONING_TIMEOUT</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pResponseCallback</td><td>The user-defined callback that will be invoked with the response from the server, whether new credentials for the device in case of success, OR error response in case of server rejection of the credentials generation request. The callback should be defined appropriately for storing the credentials provided by the server on the device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function will return <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286aacaff2379e5d99e6d3473dd7e925e92e" title="Provisioning operation completed successfully. ">AWS_IOT_PROVISIONING_SUCCESS</a> upon success; otherwise, <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a368b9308243e8a58f3a0e4858e9c028c" title="An API function was called before AwsIotProvisioning_Init. ">AWS_IOT_PROVISIONING_NOT_INITIALIZED</a>, if the API is called without initializing the Provisioning library (i.e. with a prior call to <a class="el" href="aws__iot__provisioning__api_8c.html#a8a023ae7f0da10863d08a68fb99240c7">AwsIotProvisioning_Init</a> function.) <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a6f2fc76f7591d110ce72e3eb763fc79a" title="At least one parameter is invalid. ">AWS_IOT_PROVISIONING_BAD_PARAMETER</a>, if one or more input parameters are invalid. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286acaf1465543d3cccdfe6931e87125431b" title="Provisioning operation failed because of memory allocation failure. ">AWS_IOT_PROVISIONING_NO_MEMORY</a>, if there is insufficient memory for allocation in internal operations. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286ab58d8cdd1d4df72341bb362b6162d8db" title="Generic code for any MQTT operation error encountered during an Provisioning operation. ">AWS_IOT_PROVISIONING_MQTT_ERROR</a>, for errors from the MQTT stack. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286adfca211ed382bdf9a40027542cfbdf73" title="An Provisioning operation timed out. ">AWS_IOT_PROVISIONING_TIMEOUT</a>, if there is a timeout in waiting for the server response for the request to generate new credentials for the device. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a0401e3acda6ef516c0a9d164c99ef1c0" title="An Provisioning operation request is rejected by the server. ">AWS_IOT_PROVISIONING_SERVER_REFUSED</a>, if the server rejects the request for generating device credentials. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a7de92c1361bb086538d3824f7046d3b1" title="Provisioning response received from the network is malformed, corrupt or incomplete. ">AWS_IOT_PROVISIONING_BAD_RESPONSE</a>, if the response from the server cannot be successfully parsed or comprehended. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286ad1c1dfa35d658e3a8af4973890d76d12" title="Provisioning operation failed due to internal error. ">AWS_IOT_PROVISIONING_INTERNAL_FAILURE</a>, if any there are operation failures internal to the library. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- This file provides the custom footer for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      Generated by
      <a href="http://www.doxygen.org/index.html">
      <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14
    </li>
    <li class="footer">
      Last updated Thu Apr 30 2020
    </li>
    <li class="footer" style="float:left">
        SDK version 4.0.0b1
    </li>
  </ul>
</div>
</body>
</html>
