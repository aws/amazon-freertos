<!-- This file provides the custom header for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.14"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>
        Fleet Provisioning: aws_iot_provisioning.h File Reference
    </title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="foobar.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
    <tbody>
        <tr style="height: 56px;">
            <td id="projectalign" style="padding-left: 0.5em;">
                <div id="projectname">
                    <span id="csdkprefix">AWS IoT Device SDK C:</span>
                    Fleet Provisioning
                </div>
                <div id="projectbrief">
                    AWS IoT Fleet Provisioning
                </div>
            </td>
        </tr>
        <tr>
            <td id="returntomain">
                <a href="../main/index.html">Return to main page &uarr;</a>
            </td>
        </tr>
    </tbody>
    </table>
    </div>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('aws__iot__provisioning_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">aws_iot_provisioning.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>User-facing functions of the Provisioning library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;iot_config.h&quot;</code><br />
<code>#include &quot;<a class="el" href="aws__iot__provisioning__types_8h_source.html">types/aws_iot_provisioning_types.h</a>&quot;</code><br />
<code>#include &quot;<a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/iot__mqtt__types_8h.html">types/iot_mqtt_types.h</a>&quot;</code><br />
</div>
<p><a href="aws__iot__provisioning_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a648e6444c6993a44f5e09099bc5d5bf6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aws__iot__provisioning_8h.html#a648e6444c6993a44f5e09099bc5d5bf6">AwsIotProvisioning_Init</a> (uint32_t mqttTimeout)</td></tr>
<tr class="memdesc:a648e6444c6993a44f5e09099bc5d5bf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">One-time initialization function for the Provisioning library.  <a href="#a648e6444c6993a44f5e09099bc5d5bf6">More...</a><br /></td></tr>
<tr class="separator:a648e6444c6993a44f5e09099bc5d5bf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477d75f9877e508cbb4621f16d2824e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aws__iot__provisioning_8h.html#a477d75f9877e508cbb4621f16d2824e5">AwsIotProvisioning_CreateKeysAndCertificate</a> (<a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> connection, uint32_t flags, uint32_t timeoutMs, const <a class="el" href="structAwsIotProvisioningCreateKeysAndCertificateCallbackInfo__t.html">AwsIotProvisioningCreateKeysAndCertificateCallbackInfo_t</a> *pResponseCallback)</td></tr>
<tr class="memdesc:a477d75f9877e508cbb4621f16d2824e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Requests a new public-private key pair and certificate for the device from AWS IoT Core and invokes the provided user-callback with the response from the server.  <a href="#a477d75f9877e508cbb4621f16d2824e5">More...</a><br /></td></tr>
<tr class="separator:a477d75f9877e508cbb4621f16d2824e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75740c2d786e253eaa3935cf3cb10382"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aws__iot__provisioning_8h.html#a75740c2d786e253eaa3935cf3cb10382">AwsIotProvisioning_CreateCertificateFromCsr</a> (<a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> connection, <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/group__mqtt__datatypes__enums.html#ga974a9cdcc8e835aab6f1bf6d90365db6">IotMqttQos_t</a> operationQos, const char *pCertificateSigningRequest, size_t csrLength, uint32_t timeoutMs, const <a class="el" href="structAwsIotProvisioningCreateCertFromCsrCallbackInfo__t.html">AwsIotProvisioningCreateCertFromCsrCallbackInfo_t</a> *pResponseCallback)</td></tr>
<tr class="memdesc:a75740c2d786e253eaa3935cf3cb10382"><td class="mdescLeft">&#160;</td><td class="mdescRight">Requests the AWS IoT Core service for a certificate by sending a Certificate-Signing Request, and invokes the provided user-defined response handler with the response it receives from the server.  <a href="#a75740c2d786e253eaa3935cf3cb10382">More...</a><br /></td></tr>
<tr class="separator:a75740c2d786e253eaa3935cf3cb10382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8653949372231c89b5f25014891a115"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aws__iot__provisioning_8h.html#aa8653949372231c89b5f25014891a115">AwsIotProvisioning_RegisterThing</a> (<a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> connection, const <a class="el" href="structAwsIotProvisioningRegisterThingRequestInfo__t.html">AwsIotProvisioningRegisterThingRequestInfo_t</a> *pProvisioningDataInfo, uint32_t timeoutMs, const <a class="el" href="structAwsIotProvisioningRegisterThingCallbackInfo__t.html">AwsIotProvisioningRegisterThingCallbackInfo_t</a> *pResponseCallback)</td></tr>
<tr class="memdesc:aa8653949372231c89b5f25014891a115"><td class="mdescLeft">&#160;</td><td class="mdescRight">Requests the AWS IoT Core service to register the device, and invokes the user-defined callback with the response it receives from the server.  <a href="#aa8653949372231c89b5f25014891a115">More...</a><br /></td></tr>
<tr class="separator:aa8653949372231c89b5f25014891a115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12f0035e34733d7f250215a700231980"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aws__iot__provisioning_8h.html#a12f0035e34733d7f250215a700231980">AwsIotProvisioning_Cleanup</a> (void)</td></tr>
<tr class="memdesc:a12f0035e34733d7f250215a700231980"><td class="mdescLeft">&#160;</td><td class="mdescRight">One-time deinitialization function for the Provisioning library.  <a href="#a12f0035e34733d7f250215a700231980">More...</a><br /></td></tr>
<tr class="separator:a12f0035e34733d7f250215a700231980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad43a817fba7840796b95d07f27c4cd5f"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aws__iot__provisioning_8h.html#ad43a817fba7840796b95d07f27c4cd5f">AwsIotProvisioning_strerror</a> (<a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a> status)</td></tr>
<tr class="memdesc:ad43a817fba7840796b95d07f27c4cd5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a string that describes an <a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286" title="Return codes of Provisioning functions. ">AwsIotProvisioningError_t</a>.  <a href="#ad43a817fba7840796b95d07f27c4cd5f">More...</a><br /></td></tr>
<tr class="separator:ad43a817fba7840796b95d07f27c4cd5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>User-facing functions of the Provisioning library. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a648e6444c6993a44f5e09099bc5d5bf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a648e6444c6993a44f5e09099bc5d5bf6">&#9670;&nbsp;</a></span>AwsIotProvisioning_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a> AwsIotProvisioning_Init </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>mqttTimeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>One-time initialization function for the Provisioning library. </p>
<p>This function performs internal setup of the Provisioning library. <b>It must be called once before calling any other Fleet Provisioning function.</b></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqttTimeout</td><td>The amount of time (in milliseconds) that the Provisioning library will wait for MQTT operations. Optional; set this to <code>0</code> to use <a class="el" href="provisioning_config.html#AWS_IOT_PROVISIONING_DEFAULT_MQTT_TIMEOUT_MS">AWS_IOT_PROVISIONING_DEFAULT_MQTT_TIMEOUT_MS</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>One of the following:<ul>
<li><a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286aacaff2379e5d99e6d3473dd7e925e92e" title="Provisioning operation completed successfully. ">AWS_IOT_PROVISIONING_SUCCESS</a></li>
<li><a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286adb52dcc341b963f3c004de5d8c9ab1df" title="Library initialization failure. ">AWS_IOT_PROVISIONING_INIT_FAILED</a></li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No thread-safety guarantees are provided for this function.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="provisioning_function_cleanup.html">AwsIotProvisioning_Cleanup</a> </dd></dl>

</div>
</div>
<a id="a477d75f9877e508cbb4621f16d2824e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a477d75f9877e508cbb4621f16d2824e5">&#9670;&nbsp;</a></span>AwsIotProvisioning_CreateKeysAndCertificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a> AwsIotProvisioning_CreateKeysAndCertificate </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeoutMs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structAwsIotProvisioningCreateKeysAndCertificateCallbackInfo__t.html">AwsIotProvisioningCreateKeysAndCertificateCallbackInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pResponseCallback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Requests a new public-private key pair and certificate for the device from AWS IoT Core and invokes the provided user-callback with the response from the server. </p>
<dl class="section note"><dt>Note</dt><dd>It is advised to use a shared MQTT connection to AWS IoT Core across all API functions.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function is NOT thread-safe. Concurrent calls to the library API functions can result in undefined behavior. Device provisioning with this library REQUIRES calling the API functions of this library sequentially.</dd>
<dd>
Do not overwrite the existing Provisioning claim credentials with the new credentials provided by the server, at least until the device has been provisioned with a new certificate using the <a class="el" href="provisioning_function_registerthing.html">AwsIotProvisioning_RegisterThing</a> function. It is also recommended to always retain the Provisioning claim credentials, if your product use-case supports re-provisioning of the device.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>We provide a security recommendation for protecting the identity, received from the server through this API function, for your IoT device. For the threat of an unauthorized reuse of the private key, that is received in the server response, in order to clone the device, an effective way to mitigate that is to audit, in the cloud, the use of each device private key. For example, if a device private key is reused, your cloud app (through Fleet Provisioning Hooks) could log an audit event for operator follow-up, and/or initiate a workflow for revoking the previous certificate(s) issued to that key.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">connection</td><td>The MQTT connection handle to the user AWS IoT account, which will be used for communicating with the server for creating new device credentials. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>The flags for configuring the behavior of the API. See the options available in the <a class="el" href="aws__iot__provisioning__types_8h.html" title="Types of the Provisioning library. ">aws_iot_provisioning_types.h</a> file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeoutMs</td><td>The timeout (in milliseconds) for a response from the server. If there is a timeout, this function returns <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286adfca211ed382bdf9a40027542cfbdf73" title="An Provisioning operation timed out. ">AWS_IOT_PROVISIONING_TIMEOUT</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pResponseCallback</td><td>The user-defined callback that will be invoked with the response from the server, whether new credentials for the device in case of success, OR error response in case of server rejection of the credentials generation request. The callback should be defined appropriately for storing the credentials provided by the server on the device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function will return <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286aacaff2379e5d99e6d3473dd7e925e92e" title="Provisioning operation completed successfully. ">AWS_IOT_PROVISIONING_SUCCESS</a> upon success; otherwise, <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a368b9308243e8a58f3a0e4858e9c028c" title="An API function was called before AwsIotProvisioning_Init. ">AWS_IOT_PROVISIONING_NOT_INITIALIZED</a>, if the API is called without initializing the Provisioning library (i.e. with a prior call to <a class="el" href="aws__iot__provisioning__api_8c.html#a8a023ae7f0da10863d08a68fb99240c7">AwsIotProvisioning_Init</a> function.) <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a6f2fc76f7591d110ce72e3eb763fc79a" title="At least one parameter is invalid. ">AWS_IOT_PROVISIONING_BAD_PARAMETER</a>, if one or more input parameters are invalid. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286acaf1465543d3cccdfe6931e87125431b" title="Provisioning operation failed because of memory allocation failure. ">AWS_IOT_PROVISIONING_NO_MEMORY</a>, if there is insufficient memory for allocation in internal operations. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286ab58d8cdd1d4df72341bb362b6162d8db" title="Generic code for any MQTT operation error encountered during an Provisioning operation. ">AWS_IOT_PROVISIONING_MQTT_ERROR</a>, for errors from the MQTT stack. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286adfca211ed382bdf9a40027542cfbdf73" title="An Provisioning operation timed out. ">AWS_IOT_PROVISIONING_TIMEOUT</a>, if there is a timeout in waiting for the server response for the request to generate new credentials for the device. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a0401e3acda6ef516c0a9d164c99ef1c0" title="An Provisioning operation request is rejected by the server. ">AWS_IOT_PROVISIONING_SERVER_REFUSED</a>, if the server rejects the request for generating device credentials. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a7de92c1361bb086538d3824f7046d3b1" title="Provisioning response received from the network is malformed, corrupt or incomplete. ">AWS_IOT_PROVISIONING_BAD_RESPONSE</a>, if the response from the server cannot be successfully parsed or comprehended. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286ad1c1dfa35d658e3a8af4973890d76d12" title="Provisioning operation failed due to internal error. ">AWS_IOT_PROVISIONING_INTERNAL_FAILURE</a>, if any there are operation failures internal to the library. </dd></dl>

</div>
</div>
<a id="a75740c2d786e253eaa3935cf3cb10382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75740c2d786e253eaa3935cf3cb10382">&#9670;&nbsp;</a></span>AwsIotProvisioning_CreateCertificateFromCsr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a> AwsIotProvisioning_CreateCertificateFromCsr </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/group__mqtt__datatypes__enums.html#ga974a9cdcc8e835aab6f1bf6d90365db6">IotMqttQos_t</a>&#160;</td>
          <td class="paramname"><em>operationQos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pCertificateSigningRequest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>csrLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeoutMs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structAwsIotProvisioningCreateCertFromCsrCallbackInfo__t.html">AwsIotProvisioningCreateCertFromCsrCallbackInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pResponseCallback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Requests the AWS IoT Core service for a certificate by sending a Certificate-Signing Request, and invokes the provided user-defined response handler with the response it receives from the server. </p>
<dl class="section note"><dt>Note</dt><dd>It is advised to use a shared MQTT connection to AWS IoT Core across all API functions.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function is NOT thread-safe. Concurrent calls to the library API functions can result in undefined behavior. Device provisioning with this library REQUIRES calling the API functions of this library sequentially.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Depending on the threat model of your IoT device, there are considerations for protecting its identity. One threat is theft of the private key that the application uses to sign the <code>pCertificateSigningRequest</code> input to this function. An effective way to mitigate that threat is to store all device private keys in a secure element. Another threat is the unauthorized reuse of the device private key, and/or of the contents of <code>pCertificateSigningRequest</code>, in order to clone the device. An effective way to mitigate that threat is to audit, in the cloud, the use of each device private key. For example, if a device private key is reused, your cloud app (through Fleet Provisioning Hooks) could log an audit event for operator follow-up, and/or initiate a workflow for revoking the previous certificate(s) issued to that key.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Do not overwrite the existing Provisioning claim credentials with the new credentials provided by the server, at least until the device has been provisioned with a new certificate using the <a class="el" href="provisioning_function_registerthing.html">AwsIotProvisioning_RegisterThing</a> function. It is also recommended to always retain the Provisioning claim credentials, if your product use-case supports re-provisioning of the device.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">connection</td><td>The MQTT connection handle that will be used to communicate with AWS IoT Core for the Certificate-Signing Request. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">operationQos</td><td>The Quality of Service (QoS) level for the MQTT publish/subscribe communication with the server. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCertificateSigningRequest</td><td>The PEM encoded string for the Certificate-Signing Request. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">csrLength</td><td>The length of the Certificate-Signing Request string. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeoutMs</td><td>The timeout (in milliseconds) for a response from the server. If there is a timeout, this function returns <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286adfca211ed382bdf9a40027542cfbdf73" title="An Provisioning operation timed out. ">AWS_IOT_PROVISIONING_TIMEOUT</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pResponseCallback</td><td>The user-defined callback that will be invoked with the server's response to the CSR request. The server can respond either with the new certificate information (in case of request acceptance) OR with error (in case of request rejection).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The callback is expected to store/retain the new certificate information from the server response, which will be required for registering the device with <a class="el" href="provisioning_function_registerthing.html">AwsIotProvisioning_RegisterThing</a> function.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>This function will return <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286aacaff2379e5d99e6d3473dd7e925e92e" title="Provisioning operation completed successfully. ">AWS_IOT_PROVISIONING_SUCCESS</a> upon success; otherwise, <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a368b9308243e8a58f3a0e4858e9c028c" title="An API function was called before AwsIotProvisioning_Init. ">AWS_IOT_PROVISIONING_NOT_INITIALIZED</a>, if the API is called without initializing the Provisioning library (i.e. with a prior call to <a class="el" href="aws__iot__provisioning__api_8c.html#a8a023ae7f0da10863d08a68fb99240c7">AwsIotProvisioning_Init</a> function.) <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a6f2fc76f7591d110ce72e3eb763fc79a" title="At least one parameter is invalid. ">AWS_IOT_PROVISIONING_BAD_PARAMETER</a>, if one or more input parameters are invalid. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286acaf1465543d3cccdfe6931e87125431b" title="Provisioning operation failed because of memory allocation failure. ">AWS_IOT_PROVISIONING_NO_MEMORY</a>, if there is insufficient memory for allocation in internal operations. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286ab58d8cdd1d4df72341bb362b6162d8db" title="Generic code for any MQTT operation error encountered during an Provisioning operation. ">AWS_IOT_PROVISIONING_MQTT_ERROR</a>, for errors from the MQTT stack. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286adfca211ed382bdf9a40027542cfbdf73" title="An Provisioning operation timed out. ">AWS_IOT_PROVISIONING_TIMEOUT</a>, if there is a timeout in waiting for the server response for the request to generate new credentials for the device. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a0401e3acda6ef516c0a9d164c99ef1c0" title="An Provisioning operation request is rejected by the server. ">AWS_IOT_PROVISIONING_SERVER_REFUSED</a>, if the server rejects the request for generating device credentials. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a7de92c1361bb086538d3824f7046d3b1" title="Provisioning response received from the network is malformed, corrupt or incomplete. ">AWS_IOT_PROVISIONING_BAD_RESPONSE</a>, if the response from the server cannot be successfully parsed or comprehended. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286ad1c1dfa35d658e3a8af4973890d76d12" title="Provisioning operation failed due to internal error. ">AWS_IOT_PROVISIONING_INTERNAL_FAILURE</a>, if any there are operation failures internal to the library. </dd></dl>

</div>
</div>
<a id="aa8653949372231c89b5f25014891a115"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8653949372231c89b5f25014891a115">&#9670;&nbsp;</a></span>AwsIotProvisioning_RegisterThing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a> AwsIotProvisioning_RegisterThing </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structAwsIotProvisioningRegisterThingRequestInfo__t.html">AwsIotProvisioningRegisterThingRequestInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pProvisioningDataInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeoutMs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structAwsIotProvisioningRegisterThingCallbackInfo__t.html">AwsIotProvisioningRegisterThingCallbackInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pResponseCallback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Requests the AWS IoT Core service to register the device, and invokes the user-defined callback with the response it receives from the server. </p>
<p>For registering the device, the service is expected to provide the new certificate, and optionally set up the Thing, Attributes and other cloud settings based on the fleet provisioning template and device context information that are passed to the API.</p>
<dl class="section note"><dt>Note</dt><dd>It is advised to use a shared MQTT connection to AWS IoT Core across all API functions.</dd></dl>
<p>Also, the AWS IoT account being connected to for registering the device SHOULD have a fleet provisioning template created, whose template name should be passed to this API for requesting device registration.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function is NOT thread-safe. Concurrent calls to the library API functions can result in undefined behavior. Device provisioning with this library REQUIRES calling the API functions of this library sequentially.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>In case of success response, the server may send device-specific configuration data, which will be provided as a list of key-value pairs in the callback.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">connection</td><td>The MQTT connection handle to the user AWS IoT account that will be used for registering the device. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pProvisioningDataInfo</td><td>The data (including the certificate) that needs to be sent to the server for registering the device. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeoutMs</td><td>The timeout (in milliseconds) for a response from the server. If there is a timeout, this function returns <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286adfca211ed382bdf9a40027542cfbdf73" title="An Provisioning operation timed out. ">AWS_IOT_PROVISIONING_TIMEOUT</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pResponseCallback</td><td>The user-defined functor that will be called with the response received from the server, whether post-provisioning data in case of success OR error message in case of server rejection of registration request.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function will return <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286aacaff2379e5d99e6d3473dd7e925e92e" title="Provisioning operation completed successfully. ">AWS_IOT_PROVISIONING_SUCCESS</a> upon success; otherwise, <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a368b9308243e8a58f3a0e4858e9c028c" title="An API function was called before AwsIotProvisioning_Init. ">AWS_IOT_PROVISIONING_NOT_INITIALIZED</a>, if the API is called without initializing the Provisioning library (i.e. with a prior call to <a class="el" href="aws__iot__provisioning__api_8c.html#a8a023ae7f0da10863d08a68fb99240c7">AwsIotProvisioning_Init</a> function.) <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a6f2fc76f7591d110ce72e3eb763fc79a" title="At least one parameter is invalid. ">AWS_IOT_PROVISIONING_BAD_PARAMETER</a>, if one or more input parameters are invalid. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286acaf1465543d3cccdfe6931e87125431b" title="Provisioning operation failed because of memory allocation failure. ">AWS_IOT_PROVISIONING_NO_MEMORY</a>, if there is insufficient memory for allocation in internal operations. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286ab58d8cdd1d4df72341bb362b6162d8db" title="Generic code for any MQTT operation error encountered during an Provisioning operation. ">AWS_IOT_PROVISIONING_MQTT_ERROR</a>, for errors from the MQTT stack. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286adfca211ed382bdf9a40027542cfbdf73" title="An Provisioning operation timed out. ">AWS_IOT_PROVISIONING_TIMEOUT</a>, if there is a timeout in waiting for the server response for the request to register the device. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a0401e3acda6ef516c0a9d164c99ef1c0" title="An Provisioning operation request is rejected by the server. ">AWS_IOT_PROVISIONING_SERVER_REFUSED</a>, if the server rejects the request for register the device. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286a7de92c1361bb086538d3824f7046d3b1" title="Provisioning response received from the network is malformed, corrupt or incomplete. ">AWS_IOT_PROVISIONING_BAD_RESPONSE</a>, if the response from the server cannot be successfully parsed or comprehended. <a class="el" href="group__provisioning__datatypes__enums.html#gga34944f1945811535c174feaa27be2286ad1c1dfa35d658e3a8af4973890d76d12" title="Provisioning operation failed due to internal error. ">AWS_IOT_PROVISIONING_INTERNAL_FAILURE</a>, if any there are operation failures internal to the library. </dd></dl>

</div>
</div>
<a id="a12f0035e34733d7f250215a700231980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12f0035e34733d7f250215a700231980">&#9670;&nbsp;</a></span>AwsIotProvisioning_Cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AwsIotProvisioning_Cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>One-time deinitialization function for the Provisioning library. </p>
<p>This function frees resources taken in <a class="el" href="provisioning_function_init.html">AwsIotProvisioning_Init</a>. It should be called to clean up the Provisioning library. After this function returns, <a class="el" href="provisioning_function_init.html">AwsIotProvisioning_Init</a> must be called again before calling any other Provisioning function.</p>
<dl class="section warning"><dt>Warning</dt><dd>No thread-safety guarantees are provided for this function.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="provisioning_function_init.html">AwsIotProvisioning_Init</a> </dd></dl>

</div>
</div>
<a id="ad43a817fba7840796b95d07f27c4cd5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad43a817fba7840796b95d07f27c4cd5f">&#9670;&nbsp;</a></span>AwsIotProvisioning_strerror()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* AwsIotProvisioning_strerror </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286">AwsIotProvisioningError_t</a>&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a string that describes an <a class="el" href="group__provisioning__datatypes__enums.html#ga34944f1945811535c174feaa27be2286" title="Return codes of Provisioning functions. ">AwsIotProvisioningError_t</a>. </p>
<p>Like POSIX's <code>strerror</code>, this function returns a string describing a return code. In this case, the return code is a Provisioning library error code, <code>status</code>.</p>
<p>The string returned by this function <b>MUST</b> be treated as read-only: any attempt to modify its contents may result in a crash. Therefore, this function is limited to usage in logging.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">status</td><td>The status to describe.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A read-only string that describes <code>status</code>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The string returned by this function must never be modified. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- This file provides the custom footer for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      Generated by
      <a href="http://www.doxygen.org/index.html">
      <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14
    </li>
    <li class="footer">
      Last updated Thu Apr 30 2020
    </li>
    <li class="footer" style="float:left">
        SDK version 4.0.0b1
    </li>
  </ul>
</div>
</body>
</html>
