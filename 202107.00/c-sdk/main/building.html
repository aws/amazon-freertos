<!-- This file provides the custom header for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.14"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>
        Main: Building the SDK
    </title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="foobar.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
    <tbody>
        <tr style="height: 56px;">
            <td id="projectalign" style="padding-left: 0.5em;">
                <div id="projectname">
                    <span id="csdkprefix">AWS IoT Device SDK C:</span>
                    Main
                </div>
            </td>
        </tr>
        <tr>
            <td id="returntomain">
                <a href="../main/index.html">Return to main page &uarr;</a>
            </td>
        </tr>
    </tbody>
    </table>
    </div>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('building.html','');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Building the SDK </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Guide for building the SDK.</p>
<p>This SDK builds with <a href="https://cmake.org/">CMake</a>, a cross-platform build tool.</p>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>CMake version 3.5.0 or later and a C99 compiler.</li>
</ul>
</dd>
<dd>
<ul>
<li>A supported operating system. The ports provided with this repo are expected to work with all recent versions of the following operating systems, although we cannot guarantee the behavior on all systems. For reference, the version used by this repo's Travis CI builds are listed in parentheses.<ul>
<li>Linux system with POSIX thread and timer APIs. (CI tests on Ubuntu 16.04).<br />
 On Linux systems, the OpenSSL network implementation may be used instead of the default network implementation based on mbed TLS. This requires the installation of OpenSSL development libraries and header files, version 1.0.2g or later. The OpenSSL development libraries are usually called something like <code>libssl-dev</code> or <code>openssl-devel</code> when installed through a package manager.</li>
</ul>
</li>
</ul>
</dd></dl>
<p>This SDK uses third-party libraries as Git submodules in the <code>third_party</code> directory. If the source code was downloaded via <code>git clone</code>, nothing further needs to be done. The CMake build system can automatically clone submodules in this case. However, for any other download, the submodules must be downloaded and placed in their respective <code>third_party</code> directory.</p><ul>
<li><a href="https://github.com/ARMmbed/mbedtls/tree/mbedtls-2.17">mbed TLS</a> → <code>third_party/mbedtls/mbedtls</code></li>
<li><a href="https://github.com/intel/tinycbor">tinyCBOR</a> → <code>third_party/tinycbor/tinycbor</code></li>
</ul>
<p>In addition, credentials and Things for AWS IoT must be provisioned before running the demos. See <a href="https://docs.aws.amazon.com/iot/latest/developerguide/iot-gs.html">this page</a> for a tutorial on setting up AWS IoT.</p>
<h1><a class="anchor" id="building_configuration"></a>
Build system configuration</h1>
<p>Configuration of the CMake build system.</p>
<p>The following options may be passed to the CMake build system to modify the build. Options are passed with <code>-D</code> on the command line, or selected through <a href="https://cmake.org/cmake/help/v3.0/manual/cmake-gui.1.html">CMake GUI</a>. If an option is not set, the default value will be used.</p><ul>
<li><a href="https://cmake.org/cmake/help/latest/variable/BUILD_SHARED_LIBS.html">BUILD_SHARED_LIBS</a> <br />
 <em>Default:</em> <code>ON</code> <br />
 Set this to <code>ON</code> to build all libraries as shared libraries. When <code>OFF</code>, libraries build as static libraries.</li>
<li><b><code>IOT_ATOMIC_USE_PORT</code></b> <br />
 <em>Default:</em> <code>OFF</code> <br />
 Set this to <code>ON</code> to use a custom atomic port. When <code>OFF</code>, the build system will choose an atomic port. This option also sets the preprocessor setting <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/platform_config.html#IOT_ATOMIC_USE_PORT">IOT_ATOMIC_USE_PORT</a>.</li>
<li><b><code>IOT_BUILD_CLONE_SUBMODULES</code></b> <br />
 <em>Default:</em> <code>OFF</code> <br />
 Set this to <code>ON</code> to automatically clone any required Git submodules. When <code>OFF</code>, submodules must be manually cloned.</li>
<li><b><code>IOT_BUILD_TESTS</code></b> <br />
 <em>Default:</em> <code>OFF</code> <br />
 Set this to <code>ON</code> to build both demo and test executables. When <code>OFF</code>, only demo executables are built. If enabled, both demos and tests will use the settings defined in <code>tests/iot_config.h</code>.</li>
<li><b><code>IOT_NETWORK_USE_OPENSSL</code> [Linux only]</b> <br />
 <em>Default:</em> <code>OFF</code> <br />
 Set this to <code>ON</code> to use a network implementation based on OpenSSL instead of the default mbed TLS network implementation. If this is set to <code>ON</code>, OpenSSL development libraries and headers must be installed.</li>
</ul>
<h1><a class="anchor" id="building_demo"></a>
Building the demo applications</h1>
<p>How to build the demo applications.</p>
<p>Before building the demos, all desired configuration settings should be defined. Configuration settings include global <a class="el" href="global_library_config.html">library</a> and <a class="el" href="global_demos_config.html">demo</a> settings, as well as settings for specific libraries and demos. Settings for demo applications should be placed in <code>demos/iot_config.h</code>. Any undefined settings will use a default value when possible.</p>
<h2><a class="anchor" id="building_demo_commmandline"></a>
Command-line build</h2>
<p>How to build the demo applications on the command-line.</p>
<p>In-source CMake builds are not allowed. A build directory should be created under the SDK root directory. Since CMake is cross-platform, build steps will vary depending on host OS. On Linux, the demo applications are built as follows: </p><div class="fragment"><div class="line"># Create build directory and change to build directory.</div><div class="line">mkdir build</div><div class="line">cd build</div><div class="line"></div><div class="line"># Configure build using CMake.</div><div class="line">cmake ..</div><div class="line"></div><div class="line"># Build the demo applications.</div><div class="line">make</div></div><!-- fragment --><p>Demo application executables will be placed in a <code>output/bin</code> directory of the CMake build directory, i.e. <code>build/output/bin</code> in the example above. The executables will be named <code>aws_iot_demo_library</code> or <code>iot_demo_library</code>, depending on whether the demo is specific to AWS IoT. For example, the MQTT demo application, which may be used with any MQTT server, will be named <code>iot_demo_mqtt</code>. The Thing Shadow demo, which is specific to AWS IoT, will be named <code>aws_iot_demo_shadow</code>.</p>
<p>Configuration settings may also be set using CMake by setting <code>CMAKE_C_FLAGS</code>. However, placing configuration settings in <code>demos/iot_demo_config.h</code> is recommended over setting them using CMake. </p><div class="fragment"><div class="line"># Example: Set IOT_STATIC_MEMORY_ONLY using CMake</div><div class="line">cmake .. -DCMAKE_C_FLAGS=-DIOT_STATIC_MEMORY_ONLY=1</div></div><!-- fragment --><p>By default, CMake may build in <code>Release</code> configuration. To enable debugging symbols, set <code>CMAKE_BUILD_TYPE</code> to <code>Debug</code>. </p><div class="fragment"><div class="line">cmake .. -DCMAKE_BUILD_TYPE=Debug</div></div><!-- fragment --><p>Delete the build directory to remove all demo application executables and build files.</p>
<h2><a class="anchor" id="building_demo_gui"></a>
CMake GUI build</h2>
<p>How to build the demo applications with CMake GUI.</p>
<p>Alternatively, CMake GUI may be used instead of the command line. Specify the SDK's root directory in <b>Where is the source code</b> and a build directory in <b>Where to build the binaries</b>. Click <b>Configure</b>, then <b>Generate</b>. You may modify <a class="el" href="building.html#building_configuration">Build system configuration</a> in the CMake GUI window.</p>
<h1><a class="anchor" id="demo_commandlineoptions"></a>
Demo command line options</h1>
<p>Command line options of the demo applications.</p>
<p>Demo applications accept the following command line options.</p>
<h2><a class="anchor" id="demo_optionn"></a>
-n</h2>
<p>Disable AWS IoT MQTT mode.</p>
<p>By default, the demo applications expect to run with an AWS IoT MQTT server. Passing this option disables <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/mqtt.tag:../mqtt/" href="../mqtt/structIotMqttConnectInfo__t.html#a25de63bc6ac4d21ca2a53e7df823b713">AWS IoT MQTT mode</a> and treats the remote MQTT server as a fully-compliant MQTT server. This option should not have an argument.</p>
<p>Because Thing Shadows are specific to AWS IoT, this option is ignored by the <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/shadow.tag:../shadow/" href="../shadow/shadow_demo.html">Shadow demo</a>.</p>
<h2><a class="anchor" id="demo_optionsu"></a>
-s and -u</h2>
<p>Secured or unsecured demo connection, respectively.</p>
<p>Neither <code>-s</code> nor <code>-u</code> should have an argument, and only one of the two should be used at a time.</p>
<p>See <a class="el" href="global_demos_config.html#IOT_DEMO_SECURED_CONNECTION">IOT_DEMO_SECURED_CONNECTION</a> for the compile-time default setting of this option.</p>
<p>Because Thing Shadows are specific to AWS IoT (which requires secured connections), this option is ignored by the <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/shadow.tag:../shadow/" href="../shadow/shadow_demo.html">Shadow demo</a>.</p>
<h2><a class="anchor" id="demo_optionh"></a>
-h host</h2>
<p>Remote host for demo application.</p>
<p>Must be followed by a host name.</p>
<p>See <a class="el" href="global_demos_config.html#IOT_DEMO_SERVER">IOT_DEMO_SERVER</a> for the compile-time default setting of this option.</p>
<h2><a class="anchor" id="demo_optionp"></a>
-p port</h2>
<p>Remote port for demo application.</p>
<p>Must be followed by a port in the range of <code>[1,65535]</code>.</p>
<p>See <a class="el" href="global_demos_config.html#IOT_DEMO_PORT">IOT_DEMO_PORT</a> for the compile-time default setting of this option.</p>
<h2><a class="anchor" id="demo_optionr"></a>
-r rootCA, -c clientCert, -k privateKey</h2>
<p>Paths to trusted server root certificate, client certificate, and client certificate private key, respectively.</p>
<p>Must be followed by a filesystem path to the respective PEM-encoded credential.</p>
<p>See <a class="el" href="global_demos_config.html#IOT_DEMO_ROOT_CA">IOT_DEMO_ROOT_CA</a>, <a class="el" href="global_demos_config.html#IOT_DEMO_CLIENT_CERT">IOT_DEMO_CLIENT_CERT</a>, and <a class="el" href="global_demos_config.html#IOT_DEMO_PRIVATE_KEY">IOT_DEMO_PRIVATE_KEY</a> for the compile-time default settings of these options.</p>
<h2><a class="anchor" id="demo_optioni"></a>
-i identifier</h2>
<p>MQTT client identifier <em>OR</em> Thing Name.</p>
<p>Must be followed by a string representing either an MQTT client identifier (MQTT demo only) or a Thing Name (all other demos). Because AWS IoT recommends that MQTT client identifier and Thing Name match, demos will use the Thing Name as the MQTT client identifier when possible.</p>
<p>See <a class="el" href="global_demos_config.html#IOT_DEMO_IDENTIFIER">IOT_DEMO_IDENTIFIER</a> for the compile-time default settings of this option.</p>
<h1><a class="anchor" id="building_tests"></a>
Building and running the tests</h1>
<p>How to build and run the SDK tests.</p>
<p>Like the demo applications, the tests also build with CMake. <a class="el" href="global_tests_config.html">Global test configuration settings</a>, as well as specific library test settings, should be defined in <code>tests/iot_config.h</code>. They are built by passing the option <code>IOT_BUILD_TESTS=1</code> to CMake. Note that enabling this option means that <b>both</b> demos and tests will use the settings defined in <code>tests/iot_config.h</code>. If distinct configurations for demos and tests are desired, they can be built in separate build directories.</p>
<div class="fragment"><div class="line"># Create build directory and change to build directory.</div><div class="line">mkdir build</div><div class="line">cd build</div><div class="line"></div><div class="line"># Configure build using CMake.</div><div class="line">cmake .. -DIOT_BUILD_TESTS=1</div><div class="line"></div><div class="line"># Build both the demos and tests.</div><div class="line">make</div></div><!-- fragment --><p>The <code>IOT_BUILD_TESTS</code> option can also be set by a checkbox in CMake GUI.</p>
<p>Test executables will be placed in a <code>output/bin</code> directory of the CMake build directory (i.e. <code>build/output/bin</code>) alongside the demo applications. They will be named <code>aws_iot_tests_library</code> or <code>iot_tests_library</code>, depending on whether the tests are specific to AWS IoT. For example, the MQTT tests application, which may be used with any MQTT server, will be named <code>iot_tests_mqtt</code>. The Thing Shadow tests, which are specific to AWS IoT, will be named <code>aws_iot_tests_shadow</code>.</p>
<p>By default, running a test executable with no command line arguments will only run the basic unit tests and system tests. This run is expected to take up to a few minutes per library test. The command line option <code>-l</code> may be passed to a test executable to enable long-running tests (such as stress tests) which may run for several hours. The command line option <code>-n</code> may be passed to the test executable to disable tests that require network connectivity. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- This file provides the custom footer for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      Generated by
      <a href="http://www.doxygen.org/index.html">
      <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14
    </li>
    <li class="footer">
      Last updated Thu Apr 30 2020
    </li>
    <li class="footer" style="float:left">
        SDK version 4.0.0b1
    </li>
  </ul>
</div>
</body>
</html>
