<!-- This file provides the custom header for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.14"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>
        Main: Porting Guide
    </title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="foobar.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
    <tbody>
        <tr style="height: 56px;">
            <td id="projectalign" style="padding-left: 0.5em;">
                <div id="projectname">
                    <span id="csdkprefix">AWS IoT Device SDK C:</span>
                    Main
                </div>
            </td>
        </tr>
        <tr>
            <td id="returntomain">
                <a href="../main/index.html">Return to main page &uarr;</a>
            </td>
        </tr>
    </tbody>
    </table>
    </div>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('guide_developer_porting.html','');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Porting Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Guide for porting this SDK to a new platform.</p>
<p>This SDK has three components that must be ported to a new system:</p><ol type="1">
<li><a class="el" href="guide_developer_porting.html#guide_developer_porting_build">The build system</a></li>
<li><a class="el" href="guide_developer_porting.html#guide_developer_config">The config header</a></li>
<li><a class="el" href="guide_developer_porting.html#guide_developer_porting_platform">The platform layer</a></li>
</ol>
<h1><a class="anchor" id="guide_developer_porting_build"></a>
Porting the build system</h1>
<p>Guide for porting the SDK's build system.</p>
<p>The CMake-based build system present in <a href="https://github.com/aws/aws-iot-device-sdk-embedded-C">the SDK's GitHub repo</a> targets desktop systems and builds libraries into shared or static libraries. The build selects the <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/group__platform__datatypes__handles.html">types of the platform layer</a> based on the detected host OS and automatically configures the platform layer. See <a class="el" href="building.html">Building the SDK</a> for more information on the build system.</p>
<p>In general, this SDK should build with C compilers in C99 mode. Currently, we do not guarantee builds with a C++ compiler. Compilers that provide intrinsics for atomic operations are recommended; see <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/platform_atomic.html">Atomics</a> for more information.</p>
<h2><a class="anchor" id="guide_developer_porting_directory_layout"></a>
Directory layout</h2>
<p>The following directories contain the SDK's source code and are relevant for porting.</p>
<p>Of the directories listed below, only <b style="color:#ff0000"><code>ports/</code></b> should be modified during porting. Empty templates of a new port are placed in <code>ports/template</code>. Some directories present in the GitHub repo (such as <code>cbmc</code>, <code>doc</code>, and <code>scripts</code>) are not relevant for porting and therefore not listed.</p>
<p>As relative paths from the SDK's root directory:</p><ul>
<li><code>demos/</code> <br />
 SDK sample applications. These files do not need to be ported, but are useful as a starting point.<ul>
<li><code>app/</code> <br />
 Contains demo applications for various systems, most importantly the <code>main()</code> functions.</li>
<li><code>include/</code> <br />
 Headers only needed to build the demos. These do not need to be ported.</li>
<li><code>src/</code> <br />
 Platform-independent demo sources. These do not need to be ported.</li>
<li><code>iot_config.h</code> <br />
 The config header for the demo applications. Useful as an example.</li>
</ul>
</li>
<li><code>libraries/</code> <br />
 Platform-independent SDK files. This directory (and all its subdirectories) should be copied and not modified.<ul>
<li><code>aws/</code> <br />
 Client libraries for AWS IoT services. Individual library headers, source files, and tests are contained in directories matching the library name. All source files in the same directory should be built into a shared or static library.<ul>
<li><code>defender/</code> <br />
 Defender library headers, source files and tests.<ul>
<li><code>include</code> <br />
 Defender library header files.</li>
<li><code>src</code> <br />
 Defender library source files.</li>
<li><code>test</code> <br />
 Defender library tests.</li>
</ul>
</li>
<li><code>common, jobs, shadow, ...</code> <br />
 Other libraries have the same directory structure as the Defender library described above.</li>
</ul>
</li>
<li><b><code>platform/</code> <br />
 Interface of the platform layer, to be implemented in the <code>ports/</code> directory. </b><ul>
<li><code>types/</code> <br />
 Platform types header.</li>
</ul>
</li>
<li><code>standard</code> <br />
 Libraries which are not specific to AWS IoT services. Headers, source files, and tests are contained in directories matching the library name. All source files in the same directory should be built into a shared or static library.<ul>
<li><code>common, mqtt, serializer, ...</code> <br />
 These libraries have the same directory structure as the Defender library described above.</li>
</ul>
</li>
</ul>
</li>
<li><b style="color:#ff0000"><code>ports/</code> <br />
 This directory contains the desktop OS ports. Each port implements the functions of the platform layer interface for a specific desktop OS. </b><ul>
<li><code>common</code> <br />
 Port files that are not specific to a single port. These headers are used across all of the desktop OS ports.<ul>
<li><code>include/</code> <br />
 Port headers that are not specific to a single port, such as the atomic and network headers.<ul>
<li><b style="color:#ff0000"><code>atomic/</code> <br />
 Implementations of atomic operations. See <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/platform_atomic.html">Atomics</a> for how to create a new port. New atomic ports should be placed here. </b></li>
</ul>
</li>
<li><code>src/</code> <br />
 Port sources that are not specific to a single port, such as the network implementations.</li>
</ul>
</li>
<li><b style="color:#ff0000"><code>template</code> <br />
 Empty port sources containing stubbed-out functions. The files in this directory may be used as a starting point for a new port.</b></li>
<li><b style="color:#ff0000"><code>posix, ...</code> <br />
 Port sources and headers for a single implementation. The directory is named after the target OS.</b></li>
</ul>
</li>
<li><code>tests/</code> <br />
 SDK test config file and test runner source. Individual library tests are in each library directory. When building tests, <a class="el" href="global_tests_config.html#IOT_BUILD_TESTS">IOT_BUILD_TESTS</a> should be set to <code>1</code> globally.</li>
<li><code>third_party/</code> <br />
 Third-party library code. This directory (and all its subdirectories) should be copied and not modified.<ul>
<li><code>mbedtls/</code> <br />
 <a href="https://github.com/ARMmbed/mbedtls/tree/mbedtls-2.17">mbed TLS</a>, consumed as a Git submodule.</li>
<li><code>tinycbor/</code> <br />
 <a href="https://github.com/intel/tinycbor">Intel's TinyCBOR</a>, consumed as a Git submodule.</li>
<li><code>unity/</code> <br />
 <a href="https://github.com/ThrowTheSwitch/Unity">Unity test framework</a>. Modifications were made to make its <code>malloc</code> overrides thread-safe.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="guide_developer_porting_include_paths"></a>
Include paths</h2>
<p>The following paths should be passed as include paths to the compiler when building this SDK.</p>
<p>SDK include paths that are always required:</p><ul>
<li>The path of the <a class="el" href="global_config.html">config file</a>, <code>iot_config.h</code>. For example:<ul>
<li>In the SDK demos, <code>iot_config.h</code> is in <code>demos/</code>.</li>
<li>In the SDK tests, <code>iot_config.h</code> is in <code>tests/</code>.</li>
</ul>
</li>
<li>The path of the port types file. For example, <code>ports/posix/include</code> when using the POSIX port.</li>
<li><code>libraries/platform/</code></li>
</ul>
<p>Each library has its headers in a different <code>include</code> directory. Library include directories are in <code>libraries/aws</code> for AWS IoT client libraries, and <code>libraries/standard</code> for other libraries. For example, the MQTT library's include directory is <code>libraries/standard/mqtt/include/</code> and the AWS IoT Shadow library's include directory is <code>libraries/aws/shadow/include/</code>. Each library's include directory must be added to the include path if that library is being used.</p>
<p>Third-party submodule include paths:</p><ul>
<li>TinyCBOR: <code>third_party/tinycbor/tinycbor/src</code> <br />
 Required when building the serializer library and for the Defender tests.</li>
<li>mbed TLS: <code>third_party/mbedtls</code> and <code>third_party/mbedtls/mbedtls/include</code> <br />
 Required when building <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/platform_network.html">Networking</a> with the mbed TLS implementation.</li>
</ul>
<p>Additional include paths required to build the demos:</p><ul>
<li><code>demos/include</code></li>
</ul>
<p>Additional include paths required to build the tests:</p><ul>
<li><code>third_party/unity/unity</code></li>
<li><code>third_party/unity/unity/fixture</code></li>
<li><code>libraries/standard/mqtt/test/access</code> (when building the MQTT or Shadow tests)</li>
<li><code>libraries/standard/mqtt/test/mock</code> (when building tests that use the MQTT mocks, such as Shadow or Jobs)</li>
</ul>
<p>In addition to the tests include paths, <a class="el" href="global_tests_config.html#IOT_BUILD_TESTS">IOT_BUILD_TESTS</a> should be set to <code>1</code> globally when building tests.</p>
<h1><a class="anchor" id="guide_developer_config"></a>
Config header</h1>
<p>Settings that must be set in the config header, iot_config.h</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="global_config.html">Global configuration</a><br />
 In addition, each library has its own configuration settings.</dd></dl>
<p>At the very least, the config header must contain the following defines:</p><ul>
<li>Memory allocation functions must be set in the config header. See <a class="el" href="global_library_config.html#Iot_DefaultMalloc">IotDefault_Malloc and Iot_DefaultFree</a> for more details.</li>
<li>Assert functions must be set if asserts are enabled for a library. See <a class="el" href="global_library_config.html#Iot_DefaultAssert">Iot_DefaultAssert</a> for more details.</li>
</ul>
<p>The platform types must also be set. See <a class="el" href="guide_developer_porting.html#guide_developer_porting_platform">Porting the platform layer</a> for more details.</p>
<h1><a class="anchor" id="guide_developer_porting_platform"></a>
Porting the platform layer</h1>
<p>Guide for porting the SDK's <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/index.html#platform">platform layer</a>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/index.html#platform">Platform layer</a></dd></dl>
<h2><a class="anchor" id="guide_developer_porting_platform_types"></a>
Platform types</h2>
<p><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/group__platform__datatypes__handles.html">Types</a> that must be set in the platform layer.</p>
<dl class="section see"><dt>See also</dt><dd><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/group__platform__datatypes__handles.html">Platform types</a> for a list of all types that must be set. <br />
 <code>ports/posix/include/iot_platform_types_posix.h</code> for an example of setting the types on POSIX systems.</dd></dl>
<p>The platform types should be set in the <a class="el" href="global_config.html">config file</a>, <code>iot_config.h</code>, or in another header included by the config file. As an example, the header <code>iot_platform_types_posix.h</code> sets the platform types to the matching POSIX system types. This header is then included in <code>iot_config.h</code> by the provided CMake build system.</p>
<dl class="section attention"><dt>Attention</dt><dd>Any type configuration headers included by the config file must never include other SDK files. Since this file will be included by every SDK source file, take care not to include too many unnecessary symbols.</dd></dl>
<h2><a class="anchor" id="guide_developer_porting_platform_functions"></a>
Platform functions</h2>
<p><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/platform_functions.html">Functions</a> that must be implemented for the platform layer.</p>
<dl class="section see"><dt>See also</dt><dd><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/platform_functions.html">Platform functions</a> for a list of all functions that must be implemented. <br />
 <code>libraries/platform</code> for the interfaces of the platform functions. <br />
 <code>ports/posix/src</code> for examples of functions implemented for POSIX systems. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- This file provides the custom footer for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      Generated by
      <a href="http://www.doxygen.org/index.html">
      <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14
    </li>
    <li class="footer">
      Last updated Thu Apr 30 2020
    </li>
    <li class="footer" style="float:left">
        SDK version 4.0.0b1
    </li>
  </ul>
</div>
</body>
</html>
