<!-- This file provides the custom header for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.14"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>
        MQTT: iot_mqtt.h File Reference
    </title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="foobar.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
    <tbody>
        <tr style="height: 56px;">
            <td id="projectalign" style="padding-left: 0.5em;">
                <div id="projectname">
                    <span id="csdkprefix">AWS IoT Device SDK C:</span>
                    MQTT
                </div>
                <div id="projectbrief">
                    MQTT 3.1.1 client library
                </div>
            </td>
        </tr>
        <tr>
            <td id="returntomain">
                <a href="../main/index.html">Return to main page &uarr;</a>
            </td>
        </tr>
    </tbody>
    </table>
    </div>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('iot__mqtt_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">iot_mqtt.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>User-facing functions of the MQTT 3.1.1 library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;iot_config.h&quot;</code><br />
<code>#include &quot;<a class="el" href="iot__mqtt__types_8h_source.html">types/iot_mqtt_types.h</a>&quot;</code><br />
</div>
<p><a href="iot__mqtt_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad3c7dfde82e2bd71c2da9f2752d0249c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#ad3c7dfde82e2bd71c2da9f2752d0249c">IotMqtt_Init</a> (void)</td></tr>
<tr class="memdesc:ad3c7dfde82e2bd71c2da9f2752d0249c"><td class="mdescLeft">&#160;</td><td class="mdescRight">One-time initialization function for the MQTT library.  <a href="#ad3c7dfde82e2bd71c2da9f2752d0249c">More...</a><br /></td></tr>
<tr class="separator:ad3c7dfde82e2bd71c2da9f2752d0249c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab65639f005efb68e4208130a3eca6335"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#ab65639f005efb68e4208130a3eca6335">IotMqtt_Cleanup</a> (void)</td></tr>
<tr class="memdesc:ab65639f005efb68e4208130a3eca6335"><td class="mdescLeft">&#160;</td><td class="mdescRight">One-time deinitialization function for the MQTT library.  <a href="#ab65639f005efb68e4208130a3eca6335">More...</a><br /></td></tr>
<tr class="separator:ab65639f005efb68e4208130a3eca6335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf338710da654265faaf2f28c3daff4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#abbf338710da654265faaf2f28c3daff4">IotMqtt_ReceiveCallback</a> (<a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/group__platform__datatypes__handles.html#ga54c6cf6afbe4cd161ba88432555a97e7">IotNetworkConnection_t</a> pNetworkConnection, void *pReceiveContext)</td></tr>
<tr class="memdesc:abbf338710da654265faaf2f28c3daff4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Network receive callback for the MQTT library.  <a href="#abbf338710da654265faaf2f28c3daff4">More...</a><br /></td></tr>
<tr class="separator:abbf338710da654265faaf2f28c3daff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9491d1d41dd327e3e1020a5ae40e099e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#a9491d1d41dd327e3e1020a5ae40e099e">IotMqtt_Connect</a> (const <a class="el" href="structIotMqttNetworkInfo__t.html">IotMqttNetworkInfo_t</a> *pNetworkInfo, const <a class="el" href="structIotMqttConnectInfo__t.html">IotMqttConnectInfo_t</a> *pConnectInfo, uint32_t timeoutMs, <a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> *const pMqttConnection)</td></tr>
<tr class="memdesc:a9491d1d41dd327e3e1020a5ae40e099e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish a new MQTT connection.  <a href="#a9491d1d41dd327e3e1020a5ae40e099e">More...</a><br /></td></tr>
<tr class="separator:a9491d1d41dd327e3e1020a5ae40e099e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14aedb6fbf3e907b3146124ae0b9611"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#ac14aedb6fbf3e907b3146124ae0b9611">IotMqtt_Disconnect</a> (<a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection, uint32_t flags)</td></tr>
<tr class="memdesc:ac14aedb6fbf3e907b3146124ae0b9611"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes an MQTT connection and frees resources.  <a href="#ac14aedb6fbf3e907b3146124ae0b9611">More...</a><br /></td></tr>
<tr class="separator:ac14aedb6fbf3e907b3146124ae0b9611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a140c39dd6f8942ff46f043b4598feb32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#a140c39dd6f8942ff46f043b4598feb32">IotMqtt_SubscribeAsync</a> (<a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection, const <a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *pSubscriptionList, size_t subscriptionCount, uint32_t flags, const <a class="el" href="structIotMqttCallbackInfo__t.html">IotMqttCallbackInfo_t</a> *pCallbackInfo, <a class="el" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> *const pSubscribeOperation)</td></tr>
<tr class="memdesc:a140c39dd6f8942ff46f043b4598feb32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subscribes to the given array of topic filters and optionally receive an asynchronous notification when the subscribe completes.  <a href="#a140c39dd6f8942ff46f043b4598feb32">More...</a><br /></td></tr>
<tr class="separator:a140c39dd6f8942ff46f043b4598feb32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5507a5db80d43743d06617ebd893cdde"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#a5507a5db80d43743d06617ebd893cdde">IotMqtt_SubscribeSync</a> (<a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection, const <a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *pSubscriptionList, size_t subscriptionCount, uint32_t flags, uint32_t timeoutMs)</td></tr>
<tr class="memdesc:a5507a5db80d43743d06617ebd893cdde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subscribes to the given array of topic filters with a timeout.  <a href="#a5507a5db80d43743d06617ebd893cdde">More...</a><br /></td></tr>
<tr class="separator:a5507a5db80d43743d06617ebd893cdde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f6448383fb48b07aa6701487c8003b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#a24f6448383fb48b07aa6701487c8003b">IotMqtt_UnsubscribeAsync</a> (<a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection, const <a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *pSubscriptionList, size_t subscriptionCount, uint32_t flags, const <a class="el" href="structIotMqttCallbackInfo__t.html">IotMqttCallbackInfo_t</a> *pCallbackInfo, <a class="el" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> *const pUnsubscribeOperation)</td></tr>
<tr class="memdesc:a24f6448383fb48b07aa6701487c8003b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribes from the given array of topic filters and optionally receive an asynchronous notification when the unsubscribe completes.  <a href="#a24f6448383fb48b07aa6701487c8003b">More...</a><br /></td></tr>
<tr class="separator:a24f6448383fb48b07aa6701487c8003b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63e3dc7db0b8d4821bc61f96b6553718"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#a63e3dc7db0b8d4821bc61f96b6553718">IotMqtt_UnsubscribeSync</a> (<a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection, const <a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *pSubscriptionList, size_t subscriptionCount, uint32_t flags, uint32_t timeoutMs)</td></tr>
<tr class="memdesc:a63e3dc7db0b8d4821bc61f96b6553718"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribes from a given array of topic filters with a timeout.  <a href="#a63e3dc7db0b8d4821bc61f96b6553718">More...</a><br /></td></tr>
<tr class="separator:a63e3dc7db0b8d4821bc61f96b6553718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d07c1be4d8ca6da404c47f4672b475c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#a2d07c1be4d8ca6da404c47f4672b475c">IotMqtt_PublishAsync</a> (<a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection, const <a class="el" href="structIotMqttPublishInfo__t.html">IotMqttPublishInfo_t</a> *pPublishInfo, uint32_t flags, const <a class="el" href="structIotMqttCallbackInfo__t.html">IotMqttCallbackInfo_t</a> *pCallbackInfo, <a class="el" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> *const pPublishOperation)</td></tr>
<tr class="memdesc:a2d07c1be4d8ca6da404c47f4672b475c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publishes a message to the given topic name and optionally receive an asynchronous notification when the publish completes.  <a href="#a2d07c1be4d8ca6da404c47f4672b475c">More...</a><br /></td></tr>
<tr class="separator:a2d07c1be4d8ca6da404c47f4672b475c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a617641771838799e714f485a7c11d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#a73a617641771838799e714f485a7c11d">IotMqtt_PublishSync</a> (<a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection, const <a class="el" href="structIotMqttPublishInfo__t.html">IotMqttPublishInfo_t</a> *pPublishInfo, uint32_t flags, uint32_t timeoutMs)</td></tr>
<tr class="memdesc:a73a617641771838799e714f485a7c11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish a message to the given topic name with a timeout.  <a href="#a73a617641771838799e714f485a7c11d">More...</a><br /></td></tr>
<tr class="separator:a73a617641771838799e714f485a7c11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b27dc0cc346492f576c9d68aa808bfe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#a1b27dc0cc346492f576c9d68aa808bfe">IotMqtt_Wait</a> (<a class="el" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> operation, uint32_t timeoutMs)</td></tr>
<tr class="memdesc:a1b27dc0cc346492f576c9d68aa808bfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for an operation to complete.  <a href="#a1b27dc0cc346492f576c9d68aa808bfe">More...</a><br /></td></tr>
<tr class="separator:a1b27dc0cc346492f576c9d68aa808bfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2b733bd799bc2889729165bef0bcf38"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#ad2b733bd799bc2889729165bef0bcf38">IotMqtt_strerror</a> (<a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> status)</td></tr>
<tr class="memdesc:ad2b733bd799bc2889729165bef0bcf38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a string that describes an <a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346" title="Return codes of MQTT functions. ">IotMqttError_t</a>.  <a href="#ad2b733bd799bc2889729165bef0bcf38">More...</a><br /></td></tr>
<tr class="separator:ad2b733bd799bc2889729165bef0bcf38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab66798b7c762e80a756d2b11bcdcf9a7"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#ab66798b7c762e80a756d2b11bcdcf9a7">IotMqtt_OperationType</a> (<a class="el" href="group__mqtt__datatypes__enums.html#gae36a9b2f35ff8b92f02b4c9b4351c7e5">IotMqttOperationType_t</a> operation)</td></tr>
<tr class="memdesc:ab66798b7c762e80a756d2b11bcdcf9a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a string that describes an <a class="el" href="group__mqtt__datatypes__enums.html#gae36a9b2f35ff8b92f02b4c9b4351c7e5" title="Types of MQTT operations. ">IotMqttOperationType_t</a>.  <a href="#ab66798b7c762e80a756d2b11bcdcf9a7">More...</a><br /></td></tr>
<tr class="separator:ab66798b7c762e80a756d2b11bcdcf9a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00dee190d6294e472ffd695509ee14b6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iot__mqtt_8h.html#a00dee190d6294e472ffd695509ee14b6">IotMqtt_IsSubscribed</a> (<a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection, const char *pTopicFilter, uint16_t topicFilterLength, <a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *const pCurrentSubscription)</td></tr>
<tr class="memdesc:a00dee190d6294e472ffd695509ee14b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if an MQTT connection has a subscription for a topic filter.  <a href="#a00dee190d6294e472ffd695509ee14b6">More...</a><br /></td></tr>
<tr class="separator:a00dee190d6294e472ffd695509ee14b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>User-facing functions of the MQTT 3.1.1 library. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad3c7dfde82e2bd71c2da9f2752d0249c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3c7dfde82e2bd71c2da9f2752d0249c">&#9670;&nbsp;</a></span>IotMqtt_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> IotMqtt_Init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>One-time initialization function for the MQTT library. </p>
<p>This function performs setup of the MQTT library. <b>It must be called once (and only once) before calling any other MQTT function.</b> Calling this function more than once without first calling <a class="el" href="mqtt_function_cleanup.html">IotMqtt_Cleanup</a> may result in a crash.</p>
<dl class="section return"><dt>Returns</dt><dd>One of the following:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1" title="MQTT operation completed successfully. ">IOT_MQTT_SUCCESS</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a995647b885d06fbc38a16f8568a7838c" title="An API function was called before IotMqtt_Init. ">IOT_MQTT_NOT_INITIALIZED</a></li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No thread-safety guarantees are provided for this function.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mqtt_function_cleanup.html">IotMqtt_Cleanup</a> </dd></dl>

</div>
</div>
<a id="ab65639f005efb68e4208130a3eca6335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab65639f005efb68e4208130a3eca6335">&#9670;&nbsp;</a></span>IotMqtt_Cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IotMqtt_Cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>One-time deinitialization function for the MQTT library. </p>
<p>This function frees resources taken in <a class="el" href="mqtt_function_init.html">IotMqtt_Init</a>. It should be called after <a class="el" href="mqtt_function_disconnect.html">closing all MQTT connections</a> to clean up the MQTT library. After this function returns, <a class="el" href="mqtt_function_init.html">IotMqtt_Init</a> must be called again before calling any other MQTT function.</p>
<dl class="section warning"><dt>Warning</dt><dd>No thread-safety guarantees are provided for this function. Do not call this function if any MQTT connections are open!</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mqtt_function_init.html">IotMqtt_Init</a> </dd></dl>

</div>
</div>
<a id="abbf338710da654265faaf2f28c3daff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbf338710da654265faaf2f28c3daff4">&#9670;&nbsp;</a></span>IotMqtt_ReceiveCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IotMqtt_ReceiveCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/group__platform__datatypes__handles.html#ga54c6cf6afbe4cd161ba88432555a97e7">IotNetworkConnection_t</a>&#160;</td>
          <td class="paramname"><em>pNetworkConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pReceiveContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Network receive callback for the MQTT library. </p>
<p>This function should be called by the system whenever data is available for the MQTT library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pNetworkConnection</td><td>The network connection associated with the MQTT connection, passed by the network stack. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pReceiveContext</td><td>A pointer to the MQTT connection handle for which the packet was received. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9491d1d41dd327e3e1020a5ae40e099e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9491d1d41dd327e3e1020a5ae40e099e">&#9670;&nbsp;</a></span>IotMqtt_Connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> IotMqtt_Connect </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structIotMqttNetworkInfo__t.html">IotMqttNetworkInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pNetworkInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttConnectInfo__t.html">IotMqttConnectInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pConnectInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeoutMs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> *const&#160;</td>
          <td class="paramname"><em>pMqttConnection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish a new MQTT connection. </p>
<p>This function opens a connection between a new MQTT client and an MQTT server (also called a <em>broker</em>). MQTT connections are established on top of transport layer protocols (such as TCP/IP), and optionally, application layer security protocols (such as TLS). The MQTT packet that establishes a connection is called the MQTT CONNECT packet. After <a class="el" href="mqtt_function_init.html">IotMqtt_Init</a>, this function must be called before any other MQTT library function.</p>
<p>If <a class="el" href="structIotMqttConnectInfo__t.html#a7c1ee639c15085caa74f16aacf5d6c8c">pConnectInfo-&gt;cleanSession</a> is <code>true</code>, this function establishes a clean MQTT session. Subscriptions and unacknowledged PUBLISH messages will be discarded when the connection is closed.</p>
<p>If <a class="el" href="structIotMqttConnectInfo__t.html#a7c1ee639c15085caa74f16aacf5d6c8c">pConnectInfo-&gt;cleanSession</a> is <code>false</code>, this function establishes (or re-establishes) a persistent MQTT session. The parameters <a class="el" href="structIotMqttConnectInfo__t.html#af8b19dd2558ca1dcda19b4e0e75e477e">pConnectInfo-&gt;pPreviousSubscriptions</a> and <a class="el" href="structIotMqttConnectInfo__t.html#a295eddcf48256963cca1b13cf2abf2c7">pConnectInfo-&gt;previousSubscriptionCount</a> may be used to restore subscriptions present in a re-established persistent session. Any restored subscriptions <b>MUST</b> have been present in the persistent session; <b>this function does not send an MQTT SUBSCRIBE packet!</b></p>
<p><a class="el" href="structIotMqttConnectInfo__t.html#af8b19dd2558ca1dcda19b4e0e75e477e">pConnectInfo-&gt;pPreviousSubscriptions</a> and <a class="el" href="structIotMqttConnectInfo__t.html#a295eddcf48256963cca1b13cf2abf2c7">pConnectInfo-&gt;previousSubscriptionCount</a> can also be used to pass a list of subscriptions to be stored locally without a SUBSCRIBE packet being sent to the broker. These subscriptions are useful to invoke application level callbacks for messages received on unsolicited topics from the broker.</p>
<p>This MQTT library is network agnostic, meaning it has no knowledge of the underlying network protocol carrying the MQTT packets. It interacts with the network through a network abstraction layer, allowing it to be used with many different network stacks. The network abstraction layer is established per-connection, allowing every <a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7" title="Opaque handle of an MQTT connection. ">IotMqttConnection_t</a> to use a different network stack. The parameter <code>pNetworkInterface</code> sets up the network abstraction layer for an MQTT connection; see the documentation on <a class="el" href="structIotMqttNetworkInfo__t.html" title="MQTT network connection details. ">IotMqttNetworkInfo_t</a> for details on its members.</p>
<p>The <code>pConnectInfo</code> parameter provides the contents of the MQTT CONNECT packet. Most members <a class="el" href="structIotMqttConnectInfo__t.html">are defined by the MQTT spec.</a>. The <a class="el" href="structIotMqttConnectInfo__t.html#af6b8c985f015bb8d85a60e08dda36c11">pConnectInfo-&gt;pWillInfo</a> member provides information on a Last Will and Testament (LWT) message to be published if the MQTT connection is closed without <a class="el" href="mqtt_function_disconnect.html">sending a DISCONNECT packet</a>. Unlike other PUBLISH messages, a LWT message payload is limited to 65535 bytes in length. Additionally, the retry <a class="el" href="structIotMqttPublishInfo__t.html#aba435c0af41d6146bafa04d56cce3c80">interval</a> and <a class="el" href="structIotMqttPublishInfo__t.html#a9da2582d17581ae022f8061cdaecf62b">limit</a> members of <a class="el" href="structIotMqttPublishInfo__t.html" title="Information on a PUBLISH message. ">IotMqttPublishInfo_t</a> are ignored for LWT messages. The LWT message is optional; <code>pWillInfo</code> may be NULL.</p>
<p>MQTT keep-alive is configured by <a class="el" href="structIotMqttConnectInfo__t.html#accfc0aa36662cbe90c92eaf65ca67242">IotMqttConnectInfo_t::keepAliveSeconds</a>. Keep-alive is used to detect half-open or otherwise unusable network connections. An MQTT client will send periodic ping requests (PINGREQ) to the server if the connection is idle. The MQTT server must respond to ping requests with a ping response (PINGRESP). The standard does not specify how long the server has to respond to a ping request, noting only a "reasonable amount of time". In this library, the amount of time a server has to respond to a ping request is set with <a class="el" href="mqtt_config.html#IOT_MQTT_RESPONSE_WAIT_MS">IOT_MQTT_RESPONSE_WAIT_MS</a>.</p>
<p>Unlike <a class="el" href="mqtt_function_publishasync.html">IotMqtt_PublishAsync</a>, <a class="el" href="mqtt_function_subscribeasync.html">IotMqtt_SubscribeAsync</a>, and <a class="el" href="mqtt_function_unsubscribeasync.html">IotMqtt_UnsubscribeAsync</a>, this function is always blocking. Additionally, because the MQTT connection acknowledgement packet (CONNACK packet) does not contain any information on <em>which</em> CONNECT packet it acknowledges, only one CONNECT operation may be in progress at any time. This means that parallel threads making calls to <a class="el" href="mqtt_function_connect.html">IotMqtt_Connect</a> will be serialized to send their CONNECT packets one-by-one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pNetworkInfo</td><td>Information on the transport-layer network connection to use with the MQTT connection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pConnectInfo</td><td>MQTT connection setup parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeoutMs</td><td>If the MQTT server does not accept the connection within this timeout in milliseconds, this function returns <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ad82bd763f70681413ad415be410f71cd" title="A blocking MQTT operation timed out. ">IOT_MQTT_TIMEOUT</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pMqttConnection</td><td>Set to a newly-initialized MQTT connection handle if this function succeeds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>One of the following:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1" title="MQTT operation completed successfully. ">IOT_MQTT_SUCCESS</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a995647b885d06fbc38a16f8568a7838c" title="An API function was called before IotMqtt_Init. ">IOT_MQTT_NOT_INITIALIZED</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ae6682170afde44d00fdbc271427d9a42" title="At least one parameter is invalid. ">IOT_MQTT_BAD_PARAMETER</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ab481ade10eabf458213959b070386463" title="MQTT operation failed because of memory allocation failure. ">IOT_MQTT_NO_MEMORY</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aab444b9564a475ec08fd132c9802bfbf" title="MQTT operation failed because the network was unusable. ">IOT_MQTT_NETWORK_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a6190b9ffdd1f746fba080ea93e18deb5" title="MQTT operation could not be scheduled, i.e. enqueued for sending. ">IOT_MQTT_SCHEDULING_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aeb00267bdcea595c7a80adf0ce480693" title="MQTT response packet received from the network is malformed. ">IOT_MQTT_BAD_RESPONSE</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ad82bd763f70681413ad415be410f71cd" title="A blocking MQTT operation timed out. ">IOT_MQTT_TIMEOUT</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346abd1e37172ef79cc536d2215fb0fcf1de" title="A CONNECT or at least one subscription was refused by the server. ">IOT_MQTT_SERVER_REFUSED</a></li>
</ul>
</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Callback function to receive messages from the broker on an unsolicited topic.</span></div><div class="line"><span class="keywordtype">void</span> unsolicitedMessageCallback( <span class="keywordtype">void</span> * pArgument, <a class="code" href="structIotMqttCallbackParam__t.html">IotMqttCallbackParam_t</a> * pPublish );</div><div class="line"></div><div class="line"><span class="comment">// Parameters to MQTT connect.</span></div><div class="line"><a class="code" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection = <a class="code" href="iot__mqtt__types_8h.html#a0d1074df195de1389d14228a4e814d06">IOT_MQTT_CONNECTION_INITIALIZER</a>;</div><div class="line"><a class="code" href="structIotMqttNetworkInfo__t.html">IotMqttNetworkInfo_t</a> networkInfo = <a class="code" href="iot__mqtt__types_8h.html#a95c43f792fefa1b157626b3863e134d3">IOT_MQTT_NETWORK_INFO_INITIALIZER</a>;</div><div class="line"><a class="code" href="structIotMqttConnectInfo__t.html">IotMqttConnectInfo_t</a> connectInfo = <a class="code" href="iot__mqtt__types_8h.html#ac85620aac6913efc9e6742a4aa76c69c">IOT_MQTT_CONNECT_INFO_INITIALIZER</a>;</div><div class="line"><a class="code" href="structIotMqttPublishInfo__t.html">IotMqttPublishInfo_t</a> willInfo = <a class="code" href="iot__mqtt__types_8h.html#a2a183f34dae37e042f00b63cf8a22564">IOT_MQTT_PUBLISH_INFO_INITIALIZER</a>;</div><div class="line"></div><div class="line"><span class="comment">// A local subscription to receive messages from the broker on an unsolicited topic.</span></div><div class="line"><a class="code" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> subscription = <a class="code" href="iot__mqtt__types_8h.html#a48ae008ec0ee92719366e2804a1e922f">IOT_MQTT_SUBSCRIPTION_INITIALIZER</a>;</div><div class="line"></div><div class="line"><span class="comment">// Example network abstraction types.</span></div><div class="line"><a class="codeRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/group__platform__datatypes__handles.html#ga1d14065e75d926b25e7f9e66f3b932af">IotNetworkServerInfo_t</a> serverInfo = { ... };</div><div class="line"><a class="codeRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/group__platform__datatypes__handles.html#gae77b3fea8710d8f972f7848dbd20e8e0">IotNetworkCredentials_t</a> credentialInfo = { ... };</div><div class="line"><a class="codeRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/structIotNetworkInterface__t.html">IotNetworkInterface_t</a> networkInterface = { ... };</div><div class="line"></div><div class="line"><span class="comment">// Example using a generic network implementation.</span></div><div class="line">networkInfo.<a class="code" href="structIotMqttNetworkInfo__t.html#a93287a7d47f84bc160bf3dcddb338fde">createNetworkConnection</a> = <span class="keyword">true</span>;</div><div class="line">networkInfo.<a class="code" href="structIotMqttNetworkInfo__t.html#a5489253fc2f6024f13460187fc809910">u</a>.setup.pNetworkServerInfo = &amp;serverInfo;</div><div class="line">networkInfo.<a class="code" href="structIotMqttNetworkInfo__t.html#a5489253fc2f6024f13460187fc809910">u</a>.setup.pNetworkCredentialInfo = &amp;credentialInfo;</div><div class="line">networkInfo.<a class="code" href="structIotMqttNetworkInfo__t.html#ade7f3b72fa18293d1f2fbcfadfcbbf37">pNetworkInterface</a> = &amp;networkInterface;</div><div class="line"></div><div class="line"><span class="comment">// Set the members of the connection info (password and username not used).</span></div><div class="line">connectInfo.<a class="code" href="structIotMqttConnectInfo__t.html#a7c1ee639c15085caa74f16aacf5d6c8c">cleanSession</a> = <span class="keyword">true</span>;</div><div class="line">connectInfo.<a class="code" href="structIotMqttConnectInfo__t.html#accfc0aa36662cbe90c92eaf65ca67242">keepAliveSeconds</a> = 30;</div><div class="line">connectInfo.<a class="code" href="structIotMqttConnectInfo__t.html#a3f560e3658cc6aa0aaa3c3ddd1383137">pClientIdentifier</a> = <span class="stringliteral">&quot;uniqueclientidentifier&quot;</span>;</div><div class="line">connectInfo.<a class="code" href="structIotMqttConnectInfo__t.html#a1e16cc20774bc1e17031c5a04340c9b0">clientIdentifierLength</a> = 22;</div><div class="line"></div><div class="line"><span class="comment">// Set the members of the will info (retain and retry not used).</span></div><div class="line">willInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a483e9224f18a5d0cca607ca5dee5bad4">qos</a> = <a class="code" href="group__mqtt__datatypes__enums.html#gga974a9cdcc8e835aab6f1bf6d90365db6a7e8be13a11f451e3837a3f86175e9f86">IOT_MQTT_QOS_1</a>;</div><div class="line">willInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a7242bf67c6a74d6659e6ae78d3008c52">pTopicName</a> = <span class="stringliteral">&quot;will/topic/name&quot;</span>;</div><div class="line">willInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a93b0c97558bd24ba6324c228ec84e684">topicNameLength</a> = ( uint16_t ) strlen( willInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a7242bf67c6a74d6659e6ae78d3008c52">pTopicName</a> );</div><div class="line">willInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a5b4df4baeab5357db34df56d979ef044">pPayload</a> = <span class="stringliteral">&quot;MQTT client unexpectedly disconnected.&quot;</span>;</div><div class="line">willInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a5c223cae824741c2c8cb3bc27102ec79">payloadLength</a> = strlen( willInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a5b4df4baeab5357db34df56d979ef044">pPayload</a> );</div><div class="line"></div><div class="line"><span class="comment">// Set the pointer to the will info.</span></div><div class="line">connectInfo.<a class="code" href="structIotMqttConnectInfo__t.html#af6b8c985f015bb8d85a60e08dda36c11">pWillInfo</a> = &amp;willInfo;</div><div class="line"></div><div class="line"><span class="comment">// [Optional] Set a local subscription to receive the broker messages on an unsolicited topic.</span></div><div class="line">subscription.<a class="code" href="structIotMqttSubscription__t.html#ac69481fe2236fecc936aa41ee47e50a5">qos</a> = <a class="code" href="group__mqtt__datatypes__enums.html#gga974a9cdcc8e835aab6f1bf6d90365db6a81c90cd35b94c7dca50242808b05e7eb">IOT_MQTT_QOS_0</a>;</div><div class="line">subscription.<a class="code" href="structIotMqttSubscription__t.html#af8eecdfcec488790e377b1025ba0e42a">pTopicFilter</a> = <span class="stringliteral">&quot;some/unsolicited/topic&quot;</span>;</div><div class="line">subscription.topicLength = ( uint16_t ) strlen( subscription.<a class="code" href="structIotMqttSubscription__t.html#af8eecdfcec488790e377b1025ba0e42a">pTopicFilter</a> );</div><div class="line">subscription.<a class="code" href="structIotMqttSubscription__t.html#a8a45a7c71a222d5eeac809d6a8028448">callback</a>.<a class="code" href="structIotMqttCallbackInfo__t.html#a8ad8cdffb834fd2282b787d3ba9adc98">function</a> = unsolicitedMessageCallback;</div><div class="line">connectInfo.<a class="code" href="structIotMqttConnectInfo__t.html#af8b19dd2558ca1dcda19b4e0e75e477e">pPreviousSubscriptions</a> = &amp;subscription;</div><div class="line">connectInfo.<a class="code" href="structIotMqttConnectInfo__t.html#a295eddcf48256963cca1b13cf2abf2c7">previousSubscriptionCount</a> = 1;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// Call CONNECT with a 5 second block time. Should return</span></div><div class="line"><span class="comment">// IOT_MQTT_SUCCESS when successful.</span></div><div class="line"><a class="code" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> result = <a class="code" href="iot__mqtt_8h.html#a9491d1d41dd327e3e1020a5ae40e099e">IotMqtt_Connect</a>( &amp;networkInfo,</div><div class="line">                                         &amp;connectInfo,</div><div class="line">                                         5000,</div><div class="line">                                         &amp;mqttConnection );</div><div class="line"></div><div class="line"><span class="keywordflow">if</span>( result == <a class="code" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1">IOT_MQTT_SUCCESS</a> )</div><div class="line">{</div><div class="line">    <span class="comment">// Do something with the MQTT connection...</span></div><div class="line"></div><div class="line">    <span class="comment">// Clean up and close the MQTT connection once it&#39;s no longer needed.</span></div><div class="line">    <a class="code" href="iot__mqtt_8h.html#ac14aedb6fbf3e907b3146124ae0b9611">IotMqtt_Disconnect</a>( mqttConnection, 0 );</div><div class="line">}</div></div><!-- fragment --> 
</div>
</div>
<a id="ac14aedb6fbf3e907b3146124ae0b9611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac14aedb6fbf3e907b3146124ae0b9611">&#9670;&nbsp;</a></span>IotMqtt_Disconnect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IotMqtt_Disconnect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>mqttConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes an MQTT connection and frees resources. </p>
<p>This function closes an MQTT connection and should only be called once the MQTT connection is no longer needed. Its exact behavior depends on the <code>flags</code> parameter.</p>
<p>Normally, <code>flags</code> should be <code>0</code>. This gracefully shuts down an MQTT connection by sending an MQTT DISCONNECT packet. Any <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/structIotNetworkInterface__t.html#a49317773c425bee478288f0031623417">network close function</a> provided <a class="el" href="mqtt_function_connect.html">when the connection was established</a> will also be called. Note that because the MQTT server will not acknowledge a DISCONNECT packet, the client has no way of knowing if the server received the DISCONNECT packet. In the case where the DISCONNECT packet is lost in transport, any Last Will and Testament (LWT) message established with the connection may be published. However, if the DISCONNECT reaches the MQTT server, the LWT message will be discarded and not published.</p>
<p>Should the underlying network connection become unusable, this function should be called with <code>flags</code> set to <a class="el" href="iot__mqtt__types_8h.html#a821c60fc92e849e3d6c4258360047f93" title="Causes IotMqtt_Disconnect to only free memory and not send an MQTT DISCONNECT packet. ">IOT_MQTT_FLAG_CLEANUP_ONLY</a>. In this case, no DISCONNECT packet will be sent, though the <a class="elRef" doxygen="/home/ubuntu/Repos/aws-iot-device-sdk-embedded-C/doc/tag/platform.tag:../platform/" href="../platform/structIotNetworkInterface__t.html#a49317773c425bee478288f0031623417">network close function</a> will still be called. This function will only free the resources used by the MQTT connection; it still must be called even if the network is offline to avoid leaking resources.</p>
<p><a class="el" href="mqtt_function_disconnect.html">IotMqtt_Disconnect</a> modifies <code>mqttConnection</code>, so it shouldn't be used after calling this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqttConnection</td><td>The MQTT connection to close and clean up. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Flags which modify the behavior of this function. See <a class="el" href="mqtt_constants.html#mqtt_constants_flags">MQTT Function Flags</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a140c39dd6f8942ff46f043b4598feb32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a140c39dd6f8942ff46f043b4598feb32">&#9670;&nbsp;</a></span>IotMqtt_SubscribeAsync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> IotMqtt_SubscribeAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>mqttConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *&#160;</td>
          <td class="paramname"><em>pSubscriptionList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>subscriptionCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttCallbackInfo__t.html">IotMqttCallbackInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCallbackInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> *const&#160;</td>
          <td class="paramname"><em>pSubscribeOperation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subscribes to the given array of topic filters and optionally receive an asynchronous notification when the subscribe completes. </p>
<p>This function sends an MQTT SUBSCRIBE packet to the server. A SUBSCRIBE packet notifies the server to send any matching PUBLISH messages to this client. A single SUBSCRIBE packet may carry more than one topic filter, hence the parameters to this function include an array of <a class="el" href="structIotMqttSubscription__t.html">subscriptions</a>.</p>
<p>An MQTT subscription has two pieces:</p><ol type="1">
<li>The subscription topic filter registered with the MQTT server. The MQTT SUBSCRIBE packet sent from this client to server notifies the server to send messages matching the given topic filters to this client.</li>
<li>The <a class="el" href="structIotMqttCallbackInfo__t.html#a8ad8cdffb834fd2282b787d3ba9adc98">callback function</a> that this client will invoke when an incoming message is received. The callback function notifies applications of an incoming PUBLISH message.</li>
</ol>
<p>The helper function <a class="el" href="mqtt_function_issubscribed.html">IotMqtt_IsSubscribed</a> can be used to check if a <a class="el" href="structIotMqttCallbackInfo__t.html#a8ad8cdffb834fd2282b787d3ba9adc98">callback function</a> is registered for a particular topic filter.</p>
<p>To modify an already-registered subscription callback, call this function with a new <code>pSubscriptionList</code>. Any topic filters in <code>pSubscriptionList</code> that already have a registered callback will be replaced with the new values in <code>pSubscriptionList</code>.</p>
<dl class="section attention"><dt>Attention</dt><dd>QoS 2 subscriptions are currently unsupported. Only 0 or 1 are valid for subscription QoS.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqttConnection</td><td>The MQTT connection to use for the subscription. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSubscriptionList</td><td>Pointer to the first element in the array of subscriptions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subscriptionCount</td><td>The number of elements in pSubscriptionList. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Flags which modify the behavior of this function. See <a class="el" href="mqtt_constants.html#mqtt_constants_flags">MQTT Function Flags</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCallbackInfo</td><td>Asynchronous notification of this function's completion (<code>NULL</code> to disable). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pSubscribeOperation</td><td>Set to a handle by which this operation may be referenced after this function returns. This reference is invalidated once the subscription operation completes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function will return <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ade50c4de21a5a5efef69d4c5124f1d9a" title="MQTT operation queued, awaiting result. ">IOT_MQTT_STATUS_PENDING</a> upon success. </dd>
<dd>
Upon completion of the subscription (either through an <a class="el" href="structIotMqttCallbackInfo__t.html" title="MQTT callback function and context. ">IotMqttCallbackInfo_t</a> or <a class="el" href="mqtt_function_wait.html">IotMqtt_Wait</a>), the status will be one of:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1" title="MQTT operation completed successfully. ">IOT_MQTT_SUCCESS</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aab444b9564a475ec08fd132c9802bfbf" title="MQTT operation failed because the network was unusable. ">IOT_MQTT_NETWORK_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a6190b9ffdd1f746fba080ea93e18deb5" title="MQTT operation could not be scheduled, i.e. enqueued for sending. ">IOT_MQTT_SCHEDULING_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aeb00267bdcea595c7a80adf0ce480693" title="MQTT response packet received from the network is malformed. ">IOT_MQTT_BAD_RESPONSE</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346abd1e37172ef79cc536d2215fb0fcf1de" title="A CONNECT or at least one subscription was refused by the server. ">IOT_MQTT_SERVER_REFUSED</a> </li>
</ul>
</dd>
<dd>
If this function fails before queuing a subscribe operation, it will return one of:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a995647b885d06fbc38a16f8568a7838c" title="An API function was called before IotMqtt_Init. ">IOT_MQTT_NOT_INITIALIZED</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ae6682170afde44d00fdbc271427d9a42" title="At least one parameter is invalid. ">IOT_MQTT_BAD_PARAMETER</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ab481ade10eabf458213959b070386463" title="MQTT operation failed because of memory allocation failure. ">IOT_MQTT_NO_MEMORY</a></li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mqtt_function_subscribesync.html">IotMqtt_SubscribeSync</a> for a blocking variant of this function. </dd>
<dd>
<a class="el" href="mqtt_function_unsubscribeasync.html">IotMqtt_UnsubscribeAsync</a> for the function that removes subscriptions.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#define NUMBER_OF_SUBSCRIPTIONS ...</span></div><div class="line"></div><div class="line"><span class="comment">// Subscription callback function.</span></div><div class="line"><span class="keywordtype">void</span> subscriptionCallback( <span class="keywordtype">void</span> * pArgument, <a class="code" href="structIotMqttCallbackParam__t.html">IotMqttCallbackParam_t</a> * pPublish );</div><div class="line"></div><div class="line"><span class="comment">// An initialized and connected MQTT connection.</span></div><div class="line"><a class="code" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection;</div><div class="line"></div><div class="line"><span class="comment">// Subscription information.</span></div><div class="line">pSubscriptions[ NUMBER_OF_SUBSCRIPTIONS ] = { <a class="code" href="iot__mqtt__types_8h.html#a48ae008ec0ee92719366e2804a1e922f">IOT_MQTT_SUBSCRIPTION_INITIALIZER</a> };</div><div class="line"><a class="code" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> lastOperation = <a class="code" href="iot__mqtt__types_8h.html#a3d0b09a3f85b525bdc7d3e3a352c9596">IOT_MQTT_OPERATION_INITIALIZER</a>;</div><div class="line"></div><div class="line"><span class="comment">// Set the subscription information.</span></div><div class="line"><span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; NUMBER_OF_SUBSCRIPTIONS; i++ )</div><div class="line">{</div><div class="line">    pSubscriptions[ i ].qos = <a class="code" href="group__mqtt__datatypes__enums.html#gga974a9cdcc8e835aab6f1bf6d90365db6a7e8be13a11f451e3837a3f86175e9f86">IOT_MQTT_QOS_1</a>;</div><div class="line">    pSubscriptions[ i ].pTopicFilter = <span class="stringliteral">&quot;some/topic/filter&quot;</span>;</div><div class="line">    pSubscriptions[ i ].topicLength = ( uint16_t ) strlen( pSubscriptions[ i ].pTopicFilter );</div><div class="line">    pSubscriptions[ i ].callback.function = subscriptionCallback;</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> result = <a class="code" href="iot__mqtt_8h.html#a140c39dd6f8942ff46f043b4598feb32">IotMqtt_SubscribeAsync</a>( mqttConnection,</div><div class="line">                                                pSubscriptions,</div><div class="line">                                                NUMBER_OF_SUBSCRIPTIONS,</div><div class="line">                                                <a class="code" href="iot__mqtt__types_8h.html#ab496d15856f22cda8d874894149dad5c">IOT_MQTT_FLAG_WAITABLE</a>,</div><div class="line">                                                NULL,</div><div class="line">                                                &amp;lastOperation );</div><div class="line"></div><div class="line"><span class="comment">// Subscribe returns IOT_MQTT_STATUS_PENDING when successful. Wait up to</span></div><div class="line"><span class="comment">// 5 seconds for the operation to complete.</span></div><div class="line"><span class="keywordflow">if</span>( result == <a class="code" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ade50c4de21a5a5efef69d4c5124f1d9a">IOT_MQTT_STATUS_PENDING</a> )</div><div class="line">{</div><div class="line">    result = <a class="code" href="iot__mqtt_8h.html#a1b27dc0cc346492f576c9d68aa808bfe">IotMqtt_Wait</a>( subscriptionRef, 5000 );</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Check that the subscriptions were successful.</span></div><div class="line"><span class="keywordflow">if</span>( result == <a class="code" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1">IOT_MQTT_SUCCESS</a> )</div><div class="line">{</div><div class="line">    <span class="comment">// Wait for messages on the subscription topic filters...</span></div><div class="line"></div><div class="line">    <span class="comment">// Unsubscribe once the subscriptions are no longer needed.</span></div><div class="line">    result = <a class="code" href="iot__mqtt_8h.html#a24f6448383fb48b07aa6701487c8003b">IotMqtt_UnsubscribeAsync</a>( mqttConnection,</div><div class="line">                                       pSubscriptions,</div><div class="line">                                       NUMBER_OF_SUBSCRIPTIONS,</div><div class="line">                                       <a class="code" href="iot__mqtt__types_8h.html#ab496d15856f22cda8d874894149dad5c">IOT_MQTT_FLAG_WAITABLE</a>,</div><div class="line">                                       NULL,</div><div class="line">                                       &amp;lastOperation );</div><div class="line"></div><div class="line">    <span class="comment">// UNSUBSCRIBE returns IOT_MQTT_STATUS_PENDING when successful.</span></div><div class="line">    <span class="comment">// Wait up to 5 seconds for the operation to complete.</span></div><div class="line">    <span class="keywordflow">if</span>( result == <a class="code" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ade50c4de21a5a5efef69d4c5124f1d9a">IOT_MQTT_STATUS_PENDING</a> )</div><div class="line">    {</div><div class="line">        result = <a class="code" href="iot__mqtt_8h.html#a1b27dc0cc346492f576c9d68aa808bfe">IotMqtt_Wait</a>( lastOperation, 5000 );</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="comment">// Check which subscriptions were rejected by the server.</span></div><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span>( result == <a class="code" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346abd1e37172ef79cc536d2215fb0fcf1de">IOT_MQTT_SERVER_REFUSED</a> )</div><div class="line">{</div><div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; NUMBER_OF_SUBSCRIPTIONS; i++ )</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span>( <a class="code" href="iot__mqtt_8h.html#a00dee190d6294e472ffd695509ee14b6">IotMqtt_IsSubscribed</a>( mqttConnection,</div><div class="line">                                  pSubscriptions[ i ].pTopicFilter,</div><div class="line">                                  pSubscriptions[ i ].topicFilterLength,</div><div class="line">                                  NULL ) == <span class="keyword">false</span> )</div><div class="line">        {</div><div class="line">            <span class="comment">// This subscription was rejected.</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> 
</div>
</div>
<a id="a5507a5db80d43743d06617ebd893cdde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5507a5db80d43743d06617ebd893cdde">&#9670;&nbsp;</a></span>IotMqtt_SubscribeSync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> IotMqtt_SubscribeSync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>mqttConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *&#160;</td>
          <td class="paramname"><em>pSubscriptionList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>subscriptionCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeoutMs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subscribes to the given array of topic filters with a timeout. </p>
<p>This function sends an MQTT SUBSCRIBE packet to the server, then waits for a server response to the packet. Internally, this function is a call to <a class="el" href="mqtt_function_subscribeasync.html">IotMqtt_SubscribeAsync</a> followed by <a class="el" href="mqtt_function_wait.html">IotMqtt_Wait</a>. See <a class="el" href="mqtt_function_subscribeasync.html">IotMqtt_SubscribeAsync</a> for more information about the MQTT SUBSCRIBE operation.</p>
<dl class="section attention"><dt>Attention</dt><dd>QoS 2 subscriptions are currently unsupported. Only 0 or 1 are valid for subscription QoS.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqttConnection</td><td>The MQTT connection to use for the subscription. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSubscriptionList</td><td>Pointer to the first element in the array of subscriptions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subscriptionCount</td><td>The number of elements in pSubscriptionList. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Flags which modify the behavior of this function. See <a class="el" href="mqtt_constants.html#mqtt_constants_flags">MQTT Function Flags</a>. Currently, flags are ignored by this function; this parameter is for future-compatibility. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeoutMs</td><td>If the MQTT server does not acknowledge the subscriptions within this timeout in milliseconds, this function returns <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ad82bd763f70681413ad415be410f71cd" title="A blocking MQTT operation timed out. ">IOT_MQTT_TIMEOUT</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>One of the following:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1" title="MQTT operation completed successfully. ">IOT_MQTT_SUCCESS</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a995647b885d06fbc38a16f8568a7838c" title="An API function was called before IotMqtt_Init. ">IOT_MQTT_NOT_INITIALIZED</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ae6682170afde44d00fdbc271427d9a42" title="At least one parameter is invalid. ">IOT_MQTT_BAD_PARAMETER</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ab481ade10eabf458213959b070386463" title="MQTT operation failed because of memory allocation failure. ">IOT_MQTT_NO_MEMORY</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aab444b9564a475ec08fd132c9802bfbf" title="MQTT operation failed because the network was unusable. ">IOT_MQTT_NETWORK_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a6190b9ffdd1f746fba080ea93e18deb5" title="MQTT operation could not be scheduled, i.e. enqueued for sending. ">IOT_MQTT_SCHEDULING_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aeb00267bdcea595c7a80adf0ce480693" title="MQTT response packet received from the network is malformed. ">IOT_MQTT_BAD_RESPONSE</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ad82bd763f70681413ad415be410f71cd" title="A blocking MQTT operation timed out. ">IOT_MQTT_TIMEOUT</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346abd1e37172ef79cc536d2215fb0fcf1de" title="A CONNECT or at least one subscription was refused by the server. ">IOT_MQTT_SERVER_REFUSED</a> </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a24f6448383fb48b07aa6701487c8003b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24f6448383fb48b07aa6701487c8003b">&#9670;&nbsp;</a></span>IotMqtt_UnsubscribeAsync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> IotMqtt_UnsubscribeAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>mqttConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *&#160;</td>
          <td class="paramname"><em>pSubscriptionList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>subscriptionCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttCallbackInfo__t.html">IotMqttCallbackInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCallbackInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> *const&#160;</td>
          <td class="paramname"><em>pUnsubscribeOperation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribes from the given array of topic filters and optionally receive an asynchronous notification when the unsubscribe completes. </p>
<p>This function sends an MQTT UNSUBSCRIBE packet to the server. An UNSUBSCRIBE packet removes registered topic filters from the server. After unsubscribing, the server will no longer send messages on these topic filters to the client.</p>
<p>Corresponding <a class="el" href="structIotMqttCallbackInfo__t.html#a8ad8cdffb834fd2282b787d3ba9adc98">subscription callback functions</a> are also removed from the MQTT connection. These subscription callback functions will be removed even if the MQTT UNSUBSCRIBE packet fails to send.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqttConnection</td><td>The MQTT connection used for the subscription. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSubscriptionList</td><td>Pointer to the first element in the array of subscriptions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subscriptionCount</td><td>The number of elements in pSubscriptionList. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Flags which modify the behavior of this function. See <a class="el" href="mqtt_constants.html#mqtt_constants_flags">MQTT Function Flags</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCallbackInfo</td><td>Asynchronous notification of this function's completion (<code>NULL</code> to disable). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pUnsubscribeOperation</td><td>Set to a handle by which this operation may be referenced after this function returns. This reference is invalidated once the unsubscribe operation completes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function will return <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ade50c4de21a5a5efef69d4c5124f1d9a" title="MQTT operation queued, awaiting result. ">IOT_MQTT_STATUS_PENDING</a> upon success. </dd>
<dd>
Upon completion of the unsubscribe (either through an <a class="el" href="structIotMqttCallbackInfo__t.html" title="MQTT callback function and context. ">IotMqttCallbackInfo_t</a> or <a class="el" href="mqtt_function_wait.html">IotMqtt_Wait</a>), the status will be one of:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1" title="MQTT operation completed successfully. ">IOT_MQTT_SUCCESS</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aab444b9564a475ec08fd132c9802bfbf" title="MQTT operation failed because the network was unusable. ">IOT_MQTT_NETWORK_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a6190b9ffdd1f746fba080ea93e18deb5" title="MQTT operation could not be scheduled, i.e. enqueued for sending. ">IOT_MQTT_SCHEDULING_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aeb00267bdcea595c7a80adf0ce480693" title="MQTT response packet received from the network is malformed. ">IOT_MQTT_BAD_RESPONSE</a> </li>
</ul>
</dd>
<dd>
If this function fails before queuing an unsubscribe operation, it will return one of:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a995647b885d06fbc38a16f8568a7838c" title="An API function was called before IotMqtt_Init. ">IOT_MQTT_NOT_INITIALIZED</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ae6682170afde44d00fdbc271427d9a42" title="At least one parameter is invalid. ">IOT_MQTT_BAD_PARAMETER</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ab481ade10eabf458213959b070386463" title="MQTT operation failed because of memory allocation failure. ">IOT_MQTT_NO_MEMORY</a></li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mqtt_function_unsubscribesync.html">IotMqtt_UnsubscribeSync</a> for a blocking variant of this function. </dd>
<dd>
<a class="el" href="mqtt_function_subscribeasync.html">IotMqtt_SubscribeAsync</a> for the function that adds subscriptions. </dd></dl>

</div>
</div>
<a id="a63e3dc7db0b8d4821bc61f96b6553718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63e3dc7db0b8d4821bc61f96b6553718">&#9670;&nbsp;</a></span>IotMqtt_UnsubscribeSync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> IotMqtt_UnsubscribeSync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>mqttConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *&#160;</td>
          <td class="paramname"><em>pSubscriptionList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>subscriptionCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeoutMs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribes from a given array of topic filters with a timeout. </p>
<p>This function sends an MQTT UNSUBSCRIBE packet to the server, then waits for a server response to the packet. Internally, this function is a call to <a class="el" href="mqtt_function_unsubscribeasync.html">IotMqtt_UnsubscribeAsync</a> followed by <a class="el" href="mqtt_function_wait.html">IotMqtt_Wait</a>. See <a class="el" href="mqtt_function_unsubscribeasync.html">IotMqtt_UnsubscribeAsync</a> for more information about the MQTT UNSUBSCRIBE operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqttConnection</td><td>The MQTT connection used for the subscription. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSubscriptionList</td><td>Pointer to the first element in the array of subscriptions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subscriptionCount</td><td>The number of elements in pSubscriptionList. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Flags which modify the behavior of this function. See <a class="el" href="mqtt_constants.html#mqtt_constants_flags">MQTT Function Flags</a>. Flags are currently ignored but reserved for future use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeoutMs</td><td>If the MQTT server does not acknowledge the UNSUBSCRIBE within this timeout in milliseconds, this function returns <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ad82bd763f70681413ad415be410f71cd" title="A blocking MQTT operation timed out. ">IOT_MQTT_TIMEOUT</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>One of the following:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1" title="MQTT operation completed successfully. ">IOT_MQTT_SUCCESS</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a995647b885d06fbc38a16f8568a7838c" title="An API function was called before IotMqtt_Init. ">IOT_MQTT_NOT_INITIALIZED</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ae6682170afde44d00fdbc271427d9a42" title="At least one parameter is invalid. ">IOT_MQTT_BAD_PARAMETER</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ab481ade10eabf458213959b070386463" title="MQTT operation failed because of memory allocation failure. ">IOT_MQTT_NO_MEMORY</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aab444b9564a475ec08fd132c9802bfbf" title="MQTT operation failed because the network was unusable. ">IOT_MQTT_NETWORK_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a6190b9ffdd1f746fba080ea93e18deb5" title="MQTT operation could not be scheduled, i.e. enqueued for sending. ">IOT_MQTT_SCHEDULING_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aeb00267bdcea595c7a80adf0ce480693" title="MQTT response packet received from the network is malformed. ">IOT_MQTT_BAD_RESPONSE</a> </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a2d07c1be4d8ca6da404c47f4672b475c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d07c1be4d8ca6da404c47f4672b475c">&#9670;&nbsp;</a></span>IotMqtt_PublishAsync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> IotMqtt_PublishAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>mqttConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttPublishInfo__t.html">IotMqttPublishInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pPublishInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttCallbackInfo__t.html">IotMqttCallbackInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pCallbackInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> *const&#160;</td>
          <td class="paramname"><em>pPublishOperation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publishes a message to the given topic name and optionally receive an asynchronous notification when the publish completes. </p>
<p>This function sends an MQTT PUBLISH packet to the server. A PUBLISH packet contains a payload and a topic name. Any clients with a subscription on a topic filter matching the PUBLISH topic name will receive a copy of the PUBLISH packet from the server.</p>
<p>If a PUBLISH packet fails to reach the server and it is not a QoS 0 message, it will be retransmitted. See <a class="el" href="structIotMqttPublishInfo__t.html" title="Information on a PUBLISH message. ">IotMqttPublishInfo_t</a> for a description of the retransmission strategy.</p>
<dl class="section attention"><dt>Attention</dt><dd>QoS 2 messages are currently unsupported. Only 0 or 1 are valid for message QoS.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqttConnection</td><td>The MQTT connection to use for the publish. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pPublishInfo</td><td>MQTT publish parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Flags which modify the behavior of this function. See <a class="el" href="mqtt_constants.html#mqtt_constants_flags">MQTT Function Flags</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCallbackInfo</td><td>Asynchronous notification of this function's completion (<code>NULL</code> to disable). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPublishOperation</td><td>Set to a handle by which this operation may be referenced after this function returns. This reference is invalidated once the publish operation completes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function will return <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ade50c4de21a5a5efef69d4c5124f1d9a" title="MQTT operation queued, awaiting result. ">IOT_MQTT_STATUS_PENDING</a> upon success for QoS 1 publishes. For a QoS 0 publish it returns <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1" title="MQTT operation completed successfully. ">IOT_MQTT_SUCCESS</a> upon success. </dd>
<dd>
Upon completion of a QoS 1 publish (either through an <a class="el" href="structIotMqttCallbackInfo__t.html" title="MQTT callback function and context. ">IotMqttCallbackInfo_t</a> or <a class="el" href="mqtt_function_wait.html">IotMqtt_Wait</a>), the status will be one of:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1" title="MQTT operation completed successfully. ">IOT_MQTT_SUCCESS</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aab444b9564a475ec08fd132c9802bfbf" title="MQTT operation failed because the network was unusable. ">IOT_MQTT_NETWORK_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a6190b9ffdd1f746fba080ea93e18deb5" title="MQTT operation could not be scheduled, i.e. enqueued for sending. ">IOT_MQTT_SCHEDULING_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aeb00267bdcea595c7a80adf0ce480693" title="MQTT response packet received from the network is malformed. ">IOT_MQTT_BAD_RESPONSE</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ac0e19a8341e126615b8147e3e5c2eefa" title="A QoS 1 PUBLISH received no response and the retry limit was reached. ">IOT_MQTT_RETRY_NO_RESPONSE</a> (if <a class="el" href="structIotMqttPublishInfo__t.html#aba435c0af41d6146bafa04d56cce3c80">pPublishInfo-&gt;retryMs</a> and <a class="el" href="structIotMqttPublishInfo__t.html#a9da2582d17581ae022f8061cdaecf62b">pPublishInfo-&gt;retryLimit</a> were set). </li>
</ul>
</dd>
<dd>
If this function fails before queuing an publish operation (regardless of QoS), it will return one of:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a995647b885d06fbc38a16f8568a7838c" title="An API function was called before IotMqtt_Init. ">IOT_MQTT_NOT_INITIALIZED</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ae6682170afde44d00fdbc271427d9a42" title="At least one parameter is invalid. ">IOT_MQTT_BAD_PARAMETER</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ab481ade10eabf458213959b070386463" title="MQTT operation failed because of memory allocation failure. ">IOT_MQTT_NO_MEMORY</a></li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The parameters <code>pCallbackInfo</code> and <code>pPublishOperation</code> should only be used for QoS 1 publishes. For QoS 0, they should both be <code>NULL</code>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mqtt_function_publishsync.html">IotMqtt_PublishSync</a> for a blocking variant of this function.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// An initialized and connected MQTT connection.</span></div><div class="line"><a class="code" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a> mqttConnection;</div><div class="line"></div><div class="line"><span class="comment">// Publish information.</span></div><div class="line"><a class="code" href="structIotMqttPublishInfo__t.html">IotMqttPublishInfo_t</a> publishInfo = <a class="code" href="iot__mqtt__types_8h.html#a2a183f34dae37e042f00b63cf8a22564">IOT_MQTT_PUBLISH_INFO_INITIALIZER</a>;</div><div class="line"></div><div class="line"><span class="comment">// Set the publish information. QoS 0 example (retain not used):</span></div><div class="line">publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a483e9224f18a5d0cca607ca5dee5bad4">qos</a> = <a class="code" href="group__mqtt__datatypes__enums.html#gga974a9cdcc8e835aab6f1bf6d90365db6a81c90cd35b94c7dca50242808b05e7eb">IOT_MQTT_QOS_0</a>;</div><div class="line">publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a7242bf67c6a74d6659e6ae78d3008c52">pTopicName</a> = <span class="stringliteral">&quot;some/topic/name&quot;</span>;</div><div class="line">publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a93b0c97558bd24ba6324c228ec84e684">topicNameLength</a> = ( uint16_t ) strlen( publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a7242bf67c6a74d6659e6ae78d3008c52">pTopicName</a> );</div><div class="line">publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a5b4df4baeab5357db34df56d979ef044">pPayload</a> = <span class="stringliteral">&quot;payload&quot;</span>;</div><div class="line">publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a5c223cae824741c2c8cb3bc27102ec79">payloadLength</a> = strlen( publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a5b4df4baeab5357db34df56d979ef044">pPayload</a> );</div><div class="line"></div><div class="line"><span class="comment">// QoS 0 publish should return IOT_MQTT_SUCCESS upon success.</span></div><div class="line"><a class="code" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> qos0Result = <a class="code" href="iot__mqtt_8h.html#a2d07c1be4d8ca6da404c47f4672b475c">IotMqtt_PublishAsync</a>( mqttConnection,</div><div class="line">                                                  &amp;publishInfo,</div><div class="line">                                                  0,</div><div class="line">                                                  NULL,</div><div class="line">                                                  NULL );</div><div class="line"></div><div class="line"><span class="comment">// QoS 1 with retry example (using same topic name and payload as QoS 0 example):</span></div><div class="line"><a class="code" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> qos1Operation = <a class="code" href="iot__mqtt__types_8h.html#a3d0b09a3f85b525bdc7d3e3a352c9596">IOT_MQTT_OPERATION_INITIALIZER</a>;</div><div class="line">publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a483e9224f18a5d0cca607ca5dee5bad4">qos</a> = <a class="code" href="group__mqtt__datatypes__enums.html#gga974a9cdcc8e835aab6f1bf6d90365db6a7e8be13a11f451e3837a3f86175e9f86">IOT_MQTT_QOS_1</a>;</div><div class="line">publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#aba435c0af41d6146bafa04d56cce3c80">retryMs</a> = 1000; <span class="comment">// Retry if no response is received in 1 second.</span></div><div class="line">publishInfo.<a class="code" href="structIotMqttPublishInfo__t.html#a9da2582d17581ae022f8061cdaecf62b">retryLimit</a> = 5; <span class="comment">// Retry up to 5 times.</span></div><div class="line"></div><div class="line"><span class="comment">// QoS 1 publish should return IOT_MQTT_STATUS_PENDING upon success.</span></div><div class="line"><a class="code" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> qos1Result = <a class="code" href="iot__mqtt_8h.html#a2d07c1be4d8ca6da404c47f4672b475c">IotMqtt_PublishAsync</a>( mqttConnection,</div><div class="line">                                                  &amp;publishInfo,</div><div class="line">                                                  <a class="code" href="iot__mqtt__types_8h.html#ab496d15856f22cda8d874894149dad5c">IOT_MQTT_FLAG_WAITABLE</a>,</div><div class="line">                                                  NULL,</div><div class="line">                                                  &amp;qos1Operation );</div><div class="line"></div><div class="line"><span class="comment">// Wait up to 5 seconds for the publish to complete.</span></div><div class="line"><span class="keywordflow">if</span>( qos1Result == <a class="code" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ade50c4de21a5a5efef69d4c5124f1d9a">IOT_MQTT_STATUS_PENDING</a> )</div><div class="line">{</div><div class="line">    qos1Result = <a class="code" href="iot__mqtt_8h.html#a1b27dc0cc346492f576c9d68aa808bfe">IotMqtt_Wait</a>( qos1Operation, 5000 );</div><div class="line">}</div></div><!-- fragment --> 
</div>
</div>
<a id="a73a617641771838799e714f485a7c11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a617641771838799e714f485a7c11d">&#9670;&nbsp;</a></span>IotMqtt_PublishSync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> IotMqtt_PublishSync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>mqttConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIotMqttPublishInfo__t.html">IotMqttPublishInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pPublishInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeoutMs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publish a message to the given topic name with a timeout. </p>
<p>This function sends an MQTT PUBLISH packet to the server, then waits for a server response to the packet. Internally, this function is a call to <a class="el" href="mqtt_function_publishasync.html">IotMqtt_PublishAsync</a> followed by <a class="el" href="mqtt_function_wait.html">IotMqtt_Wait</a>. See <a class="el" href="mqtt_function_publishasync.html">IotMqtt_PublishAsync</a> for more information about the MQTT PUBLISH operation.</p>
<dl class="section attention"><dt>Attention</dt><dd>QoS 2 messages are currently unsupported. Only 0 or 1 are valid for message QoS.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqttConnection</td><td>The MQTT connection to use for the publish. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pPublishInfo</td><td>MQTT publish parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Flags which modify the behavior of this function. See <a class="el" href="mqtt_constants.html#mqtt_constants_flags">MQTT Function Flags</a>. Currently, flags are ignored by this function; this parameter is for future-compatibility. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeoutMs</td><td>If the MQTT server does not acknowledge a QoS 1 PUBLISH within this timeout in milliseconds, this function returns <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ad82bd763f70681413ad415be410f71cd" title="A blocking MQTT operation timed out. ">IOT_MQTT_TIMEOUT</a>. This parameter is ignored for QoS 0 PUBLISH messages.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>One of the following:<ul>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a2e6e37bd8e04b70023e4c6a2dc173ce1" title="MQTT operation completed successfully. ">IOT_MQTT_SUCCESS</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a995647b885d06fbc38a16f8568a7838c" title="An API function was called before IotMqtt_Init. ">IOT_MQTT_NOT_INITIALIZED</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ae6682170afde44d00fdbc271427d9a42" title="At least one parameter is invalid. ">IOT_MQTT_BAD_PARAMETER</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ab481ade10eabf458213959b070386463" title="MQTT operation failed because of memory allocation failure. ">IOT_MQTT_NO_MEMORY</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aab444b9564a475ec08fd132c9802bfbf" title="MQTT operation failed because the network was unusable. ">IOT_MQTT_NETWORK_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346a6190b9ffdd1f746fba080ea93e18deb5" title="MQTT operation could not be scheduled, i.e. enqueued for sending. ">IOT_MQTT_SCHEDULING_ERROR</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346aeb00267bdcea595c7a80adf0ce480693" title="MQTT response packet received from the network is malformed. ">IOT_MQTT_BAD_RESPONSE</a></li>
<li><a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ac0e19a8341e126615b8147e3e5c2eefa" title="A QoS 1 PUBLISH received no response and the retry limit was reached. ">IOT_MQTT_RETRY_NO_RESPONSE</a> (if <a class="el" href="structIotMqttPublishInfo__t.html#aba435c0af41d6146bafa04d56cce3c80">pPublishInfo-&gt;retryMs</a> and <a class="el" href="structIotMqttPublishInfo__t.html#a9da2582d17581ae022f8061cdaecf62b">pPublishInfo-&gt;retryLimit</a> were set). </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a1b27dc0cc346492f576c9d68aa808bfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b27dc0cc346492f576c9d68aa808bfe">&#9670;&nbsp;</a></span>IotMqtt_Wait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> IotMqtt_Wait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeoutMs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for an operation to complete. </p>
<p>This function blocks to wait for a <a class="el" href="mqtt_function_subscribeasync.html">subscribe</a>, <a class="el" href="mqtt_function_unsubscribeasync.html">unsubscribe</a>, or <a class="el" href="mqtt_function_publishasync.html">publish</a> to complete. These operations are by default asynchronous; the function calls queue an operation for processing, and a callback is invoked once the operation is complete.</p>
<p>To use this function, the flag <a class="el" href="iot__mqtt__types_8h.html#ab496d15856f22cda8d874894149dad5c" title="Allows the use of IotMqtt_Wait for blocking until completion. ">IOT_MQTT_FLAG_WAITABLE</a> must have been set in the operation's function call. Additionally, this function must always be called with any waitable operation to clean up resources.</p>
<p>Regardless of its return value, this function always clean up resources used by the waitable operation. This means <code>reference</code> is invalidated as soon as this function returns, even if it returns <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ad82bd763f70681413ad415be410f71cd" title="A blocking MQTT operation timed out. ">IOT_MQTT_TIMEOUT</a> or another error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">operation</td><td>Reference to the operation to wait for. The flag <a class="el" href="iot__mqtt__types_8h.html#ab496d15856f22cda8d874894149dad5c" title="Allows the use of IotMqtt_Wait for blocking until completion. ">IOT_MQTT_FLAG_WAITABLE</a> must have been set for this operation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeoutMs</td><td>How many milliseconds to wait before returning <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ad82bd763f70681413ad415be410f71cd" title="A blocking MQTT operation timed out. ">IOT_MQTT_TIMEOUT</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The return value of this function depends on the MQTT operation associated with <code>reference</code>. See <a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346" title="Return codes of MQTT functions. ">IotMqttError_t</a> for possible return values.</dd></dl>
<p><b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Operation reference and timeout.</span></div><div class="line"><a class="code" href="group__mqtt__datatypes__handles.html#ga5bb524e56bd78e95e04d5b2c1aaf560a">IotMqttOperation_t</a> publishOperation = <a class="code" href="iot__mqtt__types_8h.html#a3d0b09a3f85b525bdc7d3e3a352c9596">IOT_MQTT_OPERATION_INITIALIZER</a>;</div><div class="line">uint32_t timeoutMs = 5000; <span class="comment">// 5 seconds</span></div><div class="line"></div><div class="line"><span class="comment">// MQTT operation to wait for.</span></div><div class="line"><a class="code" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a> result = <a class="code" href="iot__mqtt_8h.html#a2d07c1be4d8ca6da404c47f4672b475c">IotMqtt_PublishAsync</a>( mqttConnection,</div><div class="line">                                              &amp;publishInfo,</div><div class="line">                                              <a class="code" href="iot__mqtt__types_8h.html#ab496d15856f22cda8d874894149dad5c">IOT_MQTT_FLAG_WAITABLE</a>,</div><div class="line">                                              NULL,</div><div class="line">                                              &amp;publishOperation );</div><div class="line"></div><div class="line"><span class="comment">// Publish should have returned IOT_MQTT_STATUS_PENDING. The call to wait</span></div><div class="line"><span class="comment">// returns once the result of the publish is available or the timeout expires.</span></div><div class="line"><span class="keywordflow">if</span>( result == <a class="code" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ade50c4de21a5a5efef69d4c5124f1d9a">IOT_MQTT_STATUS_PENDING</a> )</div><div class="line">{</div><div class="line">    result = <a class="code" href="iot__mqtt_8h.html#a1b27dc0cc346492f576c9d68aa808bfe">IotMqtt_Wait</a>( publishOperation, timeoutMs );</div><div class="line"></div><div class="line">    <span class="comment">// After the call to wait, the result of the publish is known</span></div><div class="line">    <span class="comment">// (not IOT_MQTT_STATUS_PENDING).</span></div><div class="line">    assert( result != <a class="code" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346ade50c4de21a5a5efef69d4c5124f1d9a">IOT_MQTT_STATUS_PENDING</a> );</div><div class="line">}</div></div><!-- fragment --> 
</div>
</div>
<a id="ad2b733bd799bc2889729165bef0bcf38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2b733bd799bc2889729165bef0bcf38">&#9670;&nbsp;</a></span>IotMqtt_strerror()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* IotMqtt_strerror </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346">IotMqttError_t</a>&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a string that describes an <a class="el" href="group__mqtt__datatypes__enums.html#ga47b87de32b8c83c88d68e9b9c26d1346" title="Return codes of MQTT functions. ">IotMqttError_t</a>. </p>
<p>Like the POSIX <code>strerror</code>, this function returns a string describing a return code. In this case, the return code is an MQTT library error code, <code>status</code>.</p>
<p>The string returned by this function <b>MUST</b> be treated as read-only: any attempt to modify its contents may result in a crash. Therefore, this function is limited to usage in logging.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">status</td><td>The status to describe.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A read-only string that describes <code>status</code>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The string returned by this function must never be modified. </dd></dl>

</div>
</div>
<a id="ab66798b7c762e80a756d2b11bcdcf9a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab66798b7c762e80a756d2b11bcdcf9a7">&#9670;&nbsp;</a></span>IotMqtt_OperationType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* IotMqtt_OperationType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__enums.html#gae36a9b2f35ff8b92f02b4c9b4351c7e5">IotMqttOperationType_t</a>&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a string that describes an <a class="el" href="group__mqtt__datatypes__enums.html#gae36a9b2f35ff8b92f02b4c9b4351c7e5" title="Types of MQTT operations. ">IotMqttOperationType_t</a>. </p>
<p>This function returns a string describing an MQTT operation type, <code>operation</code>.</p>
<p>The string returned by this function <b>MUST</b> be treated as read-only: any attempt to modify its contents may result in a crash. Therefore, this function is limited to usage in logging.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">operation</td><td>The operation to describe.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A read-only string that describes <code>operation</code>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The string returned by this function must never be modified. </dd></dl>

</div>
</div>
<a id="a00dee190d6294e472ffd695509ee14b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00dee190d6294e472ffd695509ee14b6">&#9670;&nbsp;</a></span>IotMqtt_IsSubscribed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IotMqtt_IsSubscribed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__datatypes__handles.html#ga4780ec2a55c4c322e9f5b7ce9dec3cf7">IotMqttConnection_t</a>&#160;</td>
          <td class="paramname"><em>mqttConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pTopicFilter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>topicFilterLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIotMqttSubscription__t.html">IotMqttSubscription_t</a> *const&#160;</td>
          <td class="paramname"><em>pCurrentSubscription</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if an MQTT connection has a subscription for a topic filter. </p>
<p>This function checks whether an MQTT connection <code>mqttConnection</code> has a subscription callback registered for a topic filter <code>pTopicFilter</code>. If a subscription callback is found, its details are copied into the output parameter <code>pCurrentSubscription</code>. This subscription callback will be invoked for incoming PUBLISH messages on <code>pTopicFilter</code>.</p>
<p><b>The check for a matching subscription is only performed client-side</b>; therefore, this function should not be relied upon for perfect accuracy. For example, this function may return an incorrect result if the MQTT server crashes and drops subscriptions without informing the client.</p>
<p>Note that an MQTT connection's subscriptions might change between the time this function checks the subscription list and its caller tests the return value. This function certainly should not be used concurrently with any pending SUBSCRIBE or UNSUBSCRIBE operations.</p>
<p>One suitable use of this function is to check <em>which</em> subscriptions were rejected if <a class="el" href="mqtt_function_subscribeasync.html">IotMqtt_SubscribeAsync</a> returns <a class="el" href="group__mqtt__datatypes__enums.html#gga47b87de32b8c83c88d68e9b9c26d1346abd1e37172ef79cc536d2215fb0fcf1de" title="A CONNECT or at least one subscription was refused by the server. ">IOT_MQTT_SERVER_REFUSED</a>; that return code only means that <em>at least one</em> subscription was rejected.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqttConnection</td><td>The MQTT connection to check. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pTopicFilter</td><td>The topic filter to check. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topicFilterLength</td><td>Length of <code>pTopicFilter</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pCurrentSubscription</td><td>If a subscription is found, its details are copied here. This output parameter is only valid if this function returns <code>true</code> (<code>NULL</code> to disable).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if a subscription was found; <code>false</code> otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The subscription QoS is not stored by the MQTT library; therefore, <code>pCurrentSubscription-&gt;qos</code> will always be set to <a class="el" href="group__mqtt__datatypes__enums.html#gga974a9cdcc8e835aab6f1bf6d90365db6a81c90cd35b94c7dca50242808b05e7eb">IOT_MQTT_QOS_0</a>. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- This file provides the custom footer for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      Generated by
      <a href="http://www.doxygen.org/index.html">
      <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14
    </li>
    <li class="footer">
      Last updated Thu Apr 30 2020
    </li>
    <li class="footer" style="float:left">
        SDK version 4.0.0b1
    </li>
  </ul>
</div>
</body>
</html>
