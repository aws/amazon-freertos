<!-- This file provides the custom header for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.20"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>
        HTTPS Client: Download Demo Usage Instructions
    </title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="foobar.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
    <tbody>
        <tr style="height: 56px;">
            <td id="projectalign" style="padding-left: 0.5em;">
                <div id="projectname">
                    <span id="afrprefix">FreeRTOS:</span>
                    HTTPS Client
                </div>
                <div id="projectbrief">
                    HTTPS Client v1.0.0 library
                </div>
            </td>
        </tr>
        <tr>
            <td id="returntomain">
                <a href="../main/index.html">Return to main page &uarr;</a>
            </td>
        </tr>
    </tbody>
    </table>
    </div>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<!-- end header part --><!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('https_download_demo_usage.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Download Demo Usage Instructions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ol>
<li>
Ensure that you have permissions in your AWS account to access S3. <br  />
 For information on AWS S3 please see: <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html">https://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html</a> <br  />
  </li>
<li>
In an existing bucket or creating a new bucket upload the following file: <br  />
 <a href="gettysburg.txt">gettysburg.txt</a> <br  />
  </li>
<li>
Install and configured the AWS CLI. <br  />
 For AWS CLI installation information please see: <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html">https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html</a> <br  />
 For AWS CLI configuration information please see: <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html</a> <br  />
  </li>
<li>
<p class="startli">Run <a href="https://github.com/aws/amazon-freertos/tree/master/demos/https/presigned_urls_gen.py">demos/https/presigned_url_gen.py</a> with your s3 <b>bucket-name</b> and s3 object key <b>object-key</b>. </p><div class="fragment"><div class="line">python presigned_url_gen.py --bucket my-bucket --key <span class="keywordtype">object</span>-key</div>
</div><!-- fragment --><p class="interli">Please see <a href="https://github.com/aws/amazon-freertos/tree/master/demos/https/README.md">demos/https/README.md</a> for information on the required Python version and Python package dependencies.</p>
<p class="interli">Example output: <br  />
 </p><div class="fragment"><div class="line"><span class="preprocessor">#define IOT_DEMO_HTTPS_PRESIGNED_GET_URL    https://aws-s3-endpoint/object-key.txt?AWSAccessKeyId=AAAAAAAAAAAAAAAAAAAA&amp;Expires=1560555644&amp;Signature=SomeHash12345UrlABcdEFgfIjK%3D</span></div>
<div class="line"><span class="preprocessor">#define IOT_DEMO_HTTPS_PRESIGNED_PUT_URL    https://aws-s3-endpoint/object-key.txt?AWSAccessKeyId=ABABABABABABABABABAB&amp;Expires=1560555644&amp;Signature=SomeHash12345UrlLMnmOPqrStUvW</span></div>
</div><!-- fragment --><p class="endli">Paste this output to iot_config.h. <br  />
 <br  />
 Note: <br  />
 If your bucket is less than 24 hours old, then you will need to append the region the bucket was created in to the pre-signed URL: <br  />
 </p><div class="fragment"><div class="line">https:<span class="comment">//my-bucket.s3-&lt;region&gt;.amazonaws.com/object-key.txt?AWSAccessKeyId=AAAAAAAAAAAAAAAAAAAA&amp;Expires=1560555644&amp;Signature=SomeHash12345UrlABcdEFgfIjK%3D  </span></div>
</div><!-- fragment --><p> Example: </p><div class="fragment"><div class="line">https:<span class="comment">//my-bucket.s3-us-west-2.amazonaws.com/object-key.txt?AWSAccessKeyId=AAAAAAAAAAAAAAAAAAAA&amp;Expires=1560555644&amp;Signature=SomeHash12345UrlABcdEFgfIjK%3D  </span></div>
</div><!-- fragment --><p> Please see <a href="https://aws.amazon.com/premiumsupport/knowledge-center/s3-http-307-response/">https://aws.amazon.com/premiumsupport/knowledge-center/s3-http-307-response/</a> for more information. <br  />
  </p>
</li>
<li>
Paste your RSA-2048 or ECC-P256 keys into <a href="https://github.com/aws/amazon-freertos/blob/master/demos/include/aws_clientcredential_keys.h">aws_clientcredential_keys.h</a>. This is needed to for the TLS handshake with the AWS S3 HTTP Server. <br  />
  </li>
<li>
Enable the <b>Synchronous download demo</b> by defining CONFIG_HTTPS_SYNC_DOWNLOAD_DEMO_ENABLED in aws_demo_config.h: <div class="fragment"><div class="line"><span class="comment">/* To run a particular demo you need to define one of these.</span></div>
<div class="line"><span class="comment">* Only one demo can be configured at a time</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*          CONFIG_MQTT_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_SHADOW_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_GREENGRASS_DISCOVERY_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_TCP_ECHO_CLIENT_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_DEFENDER_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_POSIX_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_OTA_UPDATE_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_SYNC_DOWNLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_ASYNC_DOWNLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_SYNC_UPLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_ASYNC_UPLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*  These defines are used in iot_demo_runner.h for demo selection */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONFIG_HTTPS_SYNC_DOWNLOAD_DEMO_ENABLED</span></div>
</div><!-- fragment -->  </li>
<li>
See <a class="elRef" href="../main/building.html#building_demo">Building the demo applications</a> for instructions on building the demo. <br  />
 A successful output looks like this: <div class="fragment"><div class="line">10 618 [iot_thread] [INFO ][INIT][618] SDK successfully initialized.</div>
<div class="line">11 618 [iot_thread] [INFO ][DEMO][618] Successfully initialized the demo. Network type <span class="keywordflow">for</span> the demo: 4</div>
<div class="line">12 618 [iot_thread] [INFO ][DEMO][618] HTTPS Client Synchronous S3 download demo <span class="keyword">using</span> pre-<span class="keywordtype">signed</span> URL: https:<span class="comment">//sarem-public.s3.amazonaws.com/gettysburg.txt?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Expires=3600&amp;X-Amz-Credential=AKIAIYLZ53PYH6JY77YQ%2F20190830%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Date=20190830T171845Z&amp;X-Amz-Signature=2b185273a920fe10b0bbf5a391c9af8af7caf0d76170eade4fd99f28d3a68a00</span></div>
<div class="line">13 902 [iot_thread] [INFO ][DEMO][902] Now requesting Range: bytes=0-511.</div>
<div class="line">14 942 [iot_thread] [INFO ][DEMO][942] Response <span class="keywordflow">return</span> code: 206</div>
<div class="line">15 942 [iot_thread] [INFO ][DEMO][942] Response Body:</div>
<div class="line">Four score and seven years ago our fathers brought forth on <span class="keyword">this</span> continent, a <span class="keyword">new</span> nation, conceived in Liberty, and dedicated to the proposition that all men are created equal.</div>
<div class="line"> </div>
<div class="line">Now we are engaged in a great civil war, testing whether that nation, or any nation so conceived and so dedicated, can <span class="keywordtype">long</span> endure. We are met on a great battle-field of that war. We have come to dedicate a portion of that field, as a <span class="keyword">final</span> resting place <span class="keywordflow">for</span> those who here gave their lives that that nation might live. It is altoge</div>
<div class="line">16 942 [iot_thread] [INFO ][DEMO][942] Downloaded 512/1517</div>
<div class="line">17 942 [iot_thread] [INFO ][DEMO][942] Now requesting Range: bytes=512-1023.</div>
<div class="line">18 1003 [iot_thread] [INFO ][DEMO][1003] Response <span class="keywordflow">return</span> code: 206</div>
<div class="line">19 1003 [iot_thread] [INFO ][DEMO][1003] Response Body:</div>
<div class="line">ther fitting and proper that we should <span class="keywordflow">do</span> this.</div>
<div class="line"> </div>
<div class="line">But, in a larger sense, we can not dedicate -- we can not consecrate -- we can not hallow -- <span class="keyword">this</span> ground. The brave men, living and dead, who struggled here, have consecrated it, far above our poor power to add or detract. The world will little note, nor <span class="keywordtype">long</span> remember what we say here, but it can never forget what they did here. It is <span class="keywordflow">for</span> us the living, rather, to be dedicated here to the unfinished work which they who fought here have thus far so nobly adv</div>
<div class="line">20 1003 [iot_thread] [INFO ][DEMO][1003] Downloaded 1024/1517</div>
<div class="line">21 1003 [iot_thread] [INFO ][DEMO][1003] Now requesting Range: bytes=1024-1516.</div>
<div class="line">22 1063 [iot_thread] [INFO ][DEMO][1063] Response <span class="keywordflow">return</span> code: 206</div>
<div class="line">23 1063 [iot_thread] [INFO ][DEMO][1063] Response Body:</div>
<div class="line">anced. It is rather <span class="keywordflow">for</span> us to be here dedicated to the great task remaining before us -- that from these honored dead we take increased devotion to that cause <span class="keywordflow">for</span> which they gave the last full measure of devotion -- that we here highly resolve that these dead shall not have died in vain -- that <span class="keyword">this</span> nation, under God, shall have a <span class="keyword">new</span> birth of freedom -- and that government of the people, by the people, <span class="keywordflow">for</span> the people, shall not perish from the earth.</div>
<div class="line"> </div>
<div class="line">Abraham Lincoln</div>
<div class="line">November 19, 1863</div>
<div class="line">24 1063 [iot_thread] [INFO ][DEMO][1063] Downloaded 1517/1517</div>
<div class="line">25 1102 [iot_thread] [INFO ][DEMO][1102] Demo completed successfully.</div>
<div class="line">26 1105 [iot_thread] [INFO ][INIT][1105] SDK cleanup done.</div>
</div><!-- fragment -->  </li>
<li>
Enable the <b>Asynchronous download demo</b> by defining either CONFIG_HTTPS_ASYNC_DOWNLOAD_DEMO_ENABLED in aws_demo_config.h: <br  />
 <div class="fragment"><div class="line"><span class="comment">/* To run a particular demo you need to define one of these.</span></div>
<div class="line"><span class="comment">* Only one demo can be configured at a time</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*          CONFIG_MQTT_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_SHADOW_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_GREENGRASS_DISCOVERY_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_TCP_ECHO_CLIENT_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_DEFENDER_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_POSIX_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_OTA_UPDATE_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_SYNC_DOWNLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_ASYNC_DOWNLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_SYNC_UPLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_ASYNC_UPLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*  These defines are used in iot_demo_runner.h for demo selection */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONFIG_HTTPS_ASYNC_DOWNLOAD_DEMO_ENABLED</span></div>
</div><!-- fragment -->  </li>
<li>
<p class="startli">See <a class="elRef" href="../main/building.html#building_demo">Building the demo applications</a> for instructions on building the demo. <br  />
 A successful output looks like this:</p>
<div class="fragment"><div class="line">10 632 [iot_thread] [INFO ][INIT][632] SDK successfully initialized.</div>
<div class="line">11 632 [iot_thread] [INFO ][DEMO][632] Successfully initialized the demo. Network type <span class="keywordflow">for</span> the demo: 4</div>
<div class="line">12 632 [iot_thread] [INFO ][DEMO][632] HTTPS Client Asynchronous S3 download demo <span class="keyword">using</span> pre-<span class="keywordtype">signed</span> URL: https:<span class="comment">//sarem-public.s3.amazonaws.com/gettysburg.txt?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Expires=3600&amp;X-Amz-Credential=AKIAIYLZ53PYH6JY77YQ%2F20190830%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Date=20190830T171845Z&amp;X-Amz-Signature=2b185273a920fe10b0bbf5a391c9af8af7caf0d76170eade4fd99f28d3a68a00</span></div>
<div class="line">13 915 [iot_thread] [INFO ][DEMO][915] Inside of the append header callback <span class="keywordflow">for</span> part bytes=0-511</div>
<div class="line">14 954 [NetRecv] [INFO ][DEMO][954] Inside of the read ready callback <span class="keywordflow">for</span> part bytes=0-511 with network <span class="keywordflow">return</span> code: 0</div>
<div class="line">15 954 [NetRecv] [INFO ][DEMO][954] Response <span class="keywordflow">return</span> code: 206 <span class="keywordflow">for</span> bytes=0-511</div>
<div class="line">16 954 [NetRecv] [INFO ][DEMO][954] Response Body <span class="keywordflow">for</span> bytes=0-511:</div>
<div class="line">Four score and seven years ago our fathers brought forth on <span class="keyword">this</span> continent, a <span class="keyword">new</span> nation, conceived in Liberty, and dedicated to the proposition that all men are created equal.</div>
<div class="line"> </div>
<div class="line">Now we are engaged in a great civil war, testing whether that nation, or any nation so conceived and so dedicated, can <span class="keywordtype">long</span> endure. We are met on a great battle-field of that war. We have come to dedicate a portion of that field, as a <span class="keyword">final</span> resting place <span class="keywordflow">for</span> those who here gave their lives that that nation might live. It is altoge</div>
<div class="line">17 954 [iot_thread] [INFO ][DEMO][954] Inside of the append header callback <span class="keywordflow">for</span> part bytes=512-1023</div>
<div class="line">18 954 [NetRecv] [INFO ][DEMO][954] Part bytes=0-511 has been fully processed.</div>
<div class="line">19 954 [NetRecv] [INFO ][DEMO][954] Downloaded: 512/1517</div>
<div class="line">20 1014 [NetRecv] [INFO ][DEMO][1014] Inside of the read ready callback <span class="keywordflow">for</span> part bytes=512-1023 with network <span class="keywordflow">return</span> code: 0</div>
<div class="line">21 1014 [NetRecv] [INFO ][DEMO][1014] Response <span class="keywordflow">return</span> code: 206 <span class="keywordflow">for</span> bytes=512-1023</div>
<div class="line">22 1014 [NetRecv] [INFO ][DEMO][1014] Response Body <span class="keywordflow">for</span> bytes=512-1023:</div>
<div class="line">ther fitting and proper that we should <span class="keywordflow">do</span> this.</div>
<div class="line"> </div>
<div class="line">But, in a larger sense, we can not dedicate -- we can not consecrate -- we can not hallow -- <span class="keyword">this</span> ground. The brave men, living and dead, who struggled here, have consecrated it, far above our poor power to add or detract. The world will little note, nor <span class="keywordtype">long</span> remember what we say here, but it can never forget what they did here. It is <span class="keywordflow">for</span> us the living, rather, to be dedicated here to the unfinished work which they who fought here have thus far so nobly adv</div>
<div class="line">23 1014 [iot_thread] [INFO ][DEMO][1014] Inside of the append header callback <span class="keywordflow">for</span> part bytes=1024-1516</div>
<div class="line">24 1014 [NetRecv] [INFO ][DEMO][1014] Part bytes=512-1023 has been fully processed.</div>
<div class="line">25 1014 [NetRecv] [INFO ][DEMO][1014] Downloaded: 1024/1517</div>
<div class="line">26 1074 [NetRecv] [INFO ][DEMO][1074] Inside of the read ready callback <span class="keywordflow">for</span> part bytes=1024-1516 with network <span class="keywordflow">return</span> code: 0</div>
<div class="line">27 1074 [NetRecv] [INFO ][DEMO][1074] Response <span class="keywordflow">return</span> code: 206 <span class="keywordflow">for</span> bytes=1024-1516</div>
<div class="line">28 1074 [NetRecv] [INFO ][DEMO][1074] Response Body <span class="keywordflow">for</span> bytes=1024-1516:</div>
<div class="line">anced. It is rather <span class="keywordflow">for</span> us to be here dedicated to the great task remaining before us -- that from these honored dead we take increased devotion to that cause <span class="keywordflow">for</span> which they gave the last full measure of devotion -- that we here highly resolve that these dead shall not have died in vain -- that <span class="keyword">this</span> nation, under God, shall have a <span class="keyword">new</span> birth of freedom -- and that government of the people, by the people, <span class="keywordflow">for</span> the people, shall not perish from the earth.</div>
<div class="line"> </div>
<div class="line">Abraham Lincoln</div>
<div class="line">November 19, 1863</div>
<div class="line">29 1074 [NetRecv] [INFO ][DEMO][1074] Part bytes=1024-1516 has been fully processed.</div>
<div class="line">30 1074 [NetRecv] [INFO ][DEMO][1074] Downloaded: 1517/1517</div>
<div class="line">31 1114 [iot_thread] [INFO ][DEMO][1114] Demo completed successfully.</div>
<div class="line">32 1116 [iot_thread] [INFO ][INIT][1116] SDK cleanup done.</div>
</div><!-- fragment --><p class="endli"></p>
</li>
</ol>
<p>Notes: <br  />
 Please note that the buffer for printing may be smaller than 512 characters and the printed received response body may be truncated.<br  />
<br  />
 "[NetRecv] [WARN ][NET][2977] Receive requested 768 bytes, but 400 bytes received instead." is OK because the library requests from the network interface the full size of the header buffer or body buffer.<br  />
<br  />
 S3 will close the connection after 100 requests on the same connection. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- This file provides the custom footer for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      Generated by
      <a href="http://www.doxygen.org/index.html">
      <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20
    </li>
    <li class="footer">
      Last updated Wed Apr 21 2021
    </li>
    <li class="footer" style="float:left">
    </li>
  </ul>
</div>
</body>
</html>