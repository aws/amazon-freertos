<!-- This file provides the custom header for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.20"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>
        HTTPS Client: Upload Demo Usage Instructions
    </title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="foobar.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
    <tbody>
        <tr style="height: 56px;">
            <td id="projectalign" style="padding-left: 0.5em;">
                <div id="projectname">
                    <span id="afrprefix">FreeRTOS:</span>
                    HTTPS Client
                </div>
                <div id="projectbrief">
                    HTTPS Client v1.0.0 library
                </div>
            </td>
        </tr>
        <tr>
            <td id="returntomain">
                <a href="../main/index.html">Return to main page &uarr;</a>
            </td>
        </tr>
    </tbody>
    </table>
    </div>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<!-- end header part --><!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('https_upload_demo_usage.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Upload Demo Usage Instructions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ol>
<li>
Ensure that you have permissions in your AWS account to access S3. <br  />
 For information on AWS S3 please see: <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html">https://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html</a> <br  />
  </li>
<li>
Install and configured the AWS CLI. <br  />
 For AWS CLI installation information please see: <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html">https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html</a> <br  />
 For AWS CLI configuration information please see: <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html</a> <br  />
  </li>
<li>
<p class="startli">Run <a href="https://github.com/aws/amazon-freertos/tree/master/demos/https/presigned_urls_gen.py">demos/https/presigned_url_gen.py</a> with your s3 <b>bucket-name</b> and s3 object key <b>object-key</b>. </p><div class="fragment"><div class="line">python presigned_url_gen.py --bucket my-bucket --key <span class="keywordtype">object</span>-key</div>
</div><!-- fragment --><p class="interli">Please see <a href="https://github.com/aws/amazon-freertos/tree/master/demos/https/README.md">demos/https/README.md</a> for information on the required Python version and Python package dependencies.</p>
<p class="interli">Example output: <br  />
 </p><div class="fragment"><div class="line"><span class="preprocessor">#define IOT_DEMO_HTTPS_PRESIGNED_GET_URL    https://aws-s3-endpoint/object-key.txt?AWSAccessKeyId=AAAAAAAAAAAAAAAAAAAA&amp;Expires=1560555644&amp;Signature=SomeHash12345UrlABcdEFgfIjK%3D</span></div>
<div class="line"><span class="preprocessor">#define IOT_DEMO_HTTPS_PRESIGNED_PUT_URL    https://aws-s3-endpoint/object-key.txt?AWSAccessKeyId=ABABABABABABABABABAB&amp;Expires=1560555644&amp;Signature=SomeHash12345UrlLMnmOPqrStUvW</span></div>
</div><!-- fragment --><p class="endli">Paste this output to iot_config.h. <br  />
 <br  />
 Note: <br  />
 If your bucket is less than 24 hours old, then you will need to append the region the bucket was created in to the pre-signed URL: <br  />
 </p><div class="fragment"><div class="line">https:<span class="comment">//my-bucket.s3-&lt;region&gt;.amazonaws.com/object-key.txt?AWSAccessKeyId=AAAAAAAAAAAAAAAAAAAA&amp;Expires=1560555644&amp;Signature=SomeHash12345UrlABcdEFgfIjK%3D  </span></div>
</div><!-- fragment --><p> Example: </p><div class="fragment"><div class="line">https:<span class="comment">//my-bucket.s3-us-west-2.amazonaws.com/object-key.txt?AWSAccessKeyId=AAAAAAAAAAAAAAAAAAAA&amp;Expires=1560555644&amp;Signature=SomeHash12345UrlABcdEFgfIjK%3D  </span></div>
</div><!-- fragment --><p> Please see <a href="https://aws.amazon.com/premiumsupport/knowledge-center/s3-http-307-response/">https://aws.amazon.com/premiumsupport/knowledge-center/s3-http-307-response/</a> for more information. <br  />
  </p>
</li>
<li>
Paste your RSA-2048 or ECC-P256 keys into <a href="https://github.com/aws/amazon-freertos/blob/master/demos/include/aws_clientcredential_keys.h">aws_clientcredential_keys.h</a>. This is needed to for the TLS handshake with the AWS S3 HTTP Server. <br  />
  </li>
<li>
Enable the <b>Synchronous upload demo</b> by defining CONFIG_HTTPS_SYNC_UPLOAD_DEMO_ENABLED in aws_demo_config.h: <div class="fragment"><div class="line"><span class="comment">/* To run a particular demo you need to define one of these.</span></div>
<div class="line"><span class="comment">* Only one demo can be configured at a time</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*          CONFIG_MQTT_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_SHADOW_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_GREENGRASS_DISCOVERY_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_TCP_ECHO_CLIENT_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_DEFENDER_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_POSIX_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_OTA_UPDATE_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_SYNC_DOWNLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_ASYNC_DOWNLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_SYNC_UPLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_ASYNC_UPLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*  These defines are used in iot_demo_runner.h for demo selection */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONFIG_HTTPS_SYNC_UPLOAD_DEMO_ENABLED</span></div>
</div><!-- fragment -->  </li>
<li>
See <a class="elRef" href="../main/building.html#building_demo">Building the demo applications</a> for instructions on building the demo. <br  />
 A successful output looks like this: <div class="fragment"><div class="line">10 621 [iot_thread] [INFO ][INIT][621] SDK successfully initialized.</div>
<div class="line">11 621 [iot_thread] [INFO ][DEMO][621] Successfully initialized the demo. Network type <span class="keywordflow">for</span> the demo: 4</div>
<div class="line">12 621 [iot_thread] [INFO ][DEMO][621] HTTPS Client Synchronous S3 upload demo <span class="keyword">using</span> pre-<span class="keywordtype">signed</span> URL: https:<span class="comment">//sarem-public.s3.amazonaws.com/helloworld5.txt?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Expires=3600&amp;X-Amz-Credential=AKIAIYLZ53PYH6JY77YQ%2F201908313 971 [iot_thread] [INFO ][DEMO][970] File was successfully uploaded.</span></div>
<div class="line">14 971 [iot_thread] [INFO ][DEMO][971] Now checking sarem-<span class="keyword">public</span>.s3.amazonaws.com <span class="keywordflow">for</span> the file uploaded...</div>
<div class="line">15 1010 [iot_thread] [INFO ][DEMO][1010] Verified file size on S3 is 12. File size specified to upload is 12.</div>
<div class="line">16 1070 [iot_thread] [INFO ][DEMO][1070] Demo completed successfully.</div>
<div class="line">17 1073 [iot_thread] [INFO ][INIT][1073] SDK cleanup done.</div>
</div><!-- fragment -->  </li>
<li>
Enable the <b>Asynchronous upload demo</b> by defining either CONFIG_HTTPS_ASYNC_UPLOAD_DEMO_ENABLED in aws_demo_config.h: <br  />
 <div class="fragment"><div class="line"><span class="comment">/* To run a particular demo you need to define one of these.</span></div>
<div class="line"><span class="comment">* Only one demo can be configured at a time</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*          CONFIG_MQTT_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_SHADOW_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_GREENGRASS_DISCOVERY_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_TCP_ECHO_CLIENT_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_DEFENDER_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_POSIX_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_OTA_UPDATE_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_SYNC_DOWNLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_ASYNC_DOWNLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_SYNC_UPLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*          CONFIG_HTTPS_ASYNC_UPLOAD_DEMO_ENABLED</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*  These defines are used in iot_demo_runner.h for demo selection */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONFIG_HTTPS_ASYNC_UPLOAD_DEMO_ENABLED</span></div>
</div><!-- fragment -->  </li>
<li>
<p class="startli">See <a class="elRef" href="../main/building.html#building_demo">Building the demo applications</a> for instructions on building the demo. <br  />
 A successful output looks like this:</p>
<div class="fragment"><div class="line">10 610 [iot_thread] [INFO ][INIT][610] SDK successfully initialized.</div>
<div class="line">11 610 [iot_thread] [INFO ][DEMO][610] Successfully initialized the demo. Network type <span class="keywordflow">for</span> the demo: 4</div>
<div class="line">12 610 [iot_thread] [INFO ][DEMO][610] HTTPS Client Asynchronous S3 upload demo <span class="keyword">using</span> pre-<span class="keywordtype">signed</span> URL: https:<span class="comment">//sarem-public.s3.amazonaws.com/helloworld5.txt?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Expires=3600&amp;X-Amz-Credential=AKIAIYLZ53PYH6JY77YQ%2F20190813 900 [iot_thread] [INFO ][DEMO][900] Now checking sarem-public.s3.amazonaws.com for the file uploaded...</span></div>
<div class="line">14 940 [iot_thread] [INFO ][DEMO][940] Verified file size on S3 is 12. File size specified to upload is 12.</div>
<div class="line">15 1000 [iot_thread] [INFO ][DEMO][1000] Demo completed successfully.</div>
<div class="line">16 1002 [iot_thread] [INFO ][INIT][1002] SDK cleanup done.</div>
</div><!-- fragment --><p class="endli"></p>
</li>
</ol>
<p>Notes: <br  />
 Please note that the buffer for printing may be smaller than 512 characters and the printed received response body may be truncated.<br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- This file provides the custom footer for Doxygen-generated HTML. Per the
Doxygen documentation, this file may need to be regenerated when Doxygen is
updated. -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      Generated by
      <a href="http://www.doxygen.org/index.html">
      <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20
    </li>
    <li class="footer">
      Last updated Wed Apr 21 2021
    </li>
    <li class="footer" style="float:left">
    </li>
  </ul>
</div>
</body>
</html>